<!doctype html>
<html>
<head>
<title>logging.cpp</title>

<style type="text/css">
body { color:#000000; background-color:#ffffff }
body { font-family:Helvetica, sans-serif; font-size:10pt }
h1 { font-size:14pt }
.FileName { margin-top: 5px; margin-bottom: 5px; display: inline; }
.FileNav { margin-left: 5px; margin-right: 5px; display: inline; }
.FileNav a { text-decoration:none; font-size: larger; }
.divider { margin-top: 30px; margin-bottom: 30px; height: 15px; }
.divider { background-color: gray; }
.code { border-collapse:collapse; width:100%; }
.code { font-family: "Monospace", monospace; font-size:10pt }
.code { line-height: 1.2em }
.comment { color: green; font-style: oblique }
.keyword { color: blue }
.string_literal { color: red }
.directive { color: darkmagenta }

/* Macros and variables could have pop-up notes hidden by default.
  - Macro pop-up:    expansion of the macro
  - Variable pop-up: value (table) of the variable */
.macro_popup, .variable_popup { display: none; }

/* Pop-up appears on mouse-hover event. */
.macro:hover .macro_popup, .variable:hover .variable_popup {
  display: block;
  padding: 2px;
  -webkit-border-radius:5px;
  -webkit-box-shadow:1px 1px 7px #000;
  border-radius:5px;
  box-shadow:1px 1px 7px #000;
  position: absolute;
  top: -1em;
  left:10em;
  z-index: 1
}

.macro_popup {
  border: 2px solid red;
  background-color:#FFF0F0;
  font-weight: normal;
}

.variable_popup {
  border: 2px solid blue;
  background-color:#F0F0FF;
  font-weight: bold;
  font-family: Helvetica, sans-serif;
  font-size: 9pt;
}

/* Pop-up notes needs a relative position as a base where they pops up. */
.macro, .variable {
  background-color: PaleGoldenRod;
  position: relative;
}
.macro { color: DarkMagenta; }

#tooltiphint {
  position: fixed;
  width: 50em;
  margin-left: -25em;
  left: 50%;
  padding: 10px;
  border: 1px solid #b0b0b0;
  border-radius: 2px;
  box-shadow: 1px 1px 7px black;
  background-color: #c0c0c0;
  z-index: 2;
}

.num { width:2.5em; padding-right:2ex; background-color:#eeeeee }
.num { text-align:right; font-size:8pt }
.num { color:#444444 }
.line { padding-left: 1ex; border-left: 3px solid #ccc }
.line { white-space: pre }
.msg { -webkit-box-shadow:1px 1px 7px #000 }
.msg { box-shadow:1px 1px 7px #000 }
.msg { -webkit-border-radius:5px }
.msg { border-radius:5px }
.msg { font-family:Helvetica, sans-serif; font-size:8pt }
.msg { float:left }
.msg { padding:0.25em 1ex 0.25em 1ex }
.msg { margin-top:10px; margin-bottom:10px }
.msg { font-weight:bold }
.msg { max-width:60em; word-wrap: break-word; white-space: pre-wrap }
.msgT { padding:0x; spacing:0x }
.msgEvent { background-color:#fff8b4; color:#000000 }
.msgControl { background-color:#bbbbbb; color:#000000 }
.msgNote { background-color:#ddeeff; color:#000000 }
.mrange { background-color:#dfddf3 }
.mrange { border-bottom:1px solid #6F9DBE }
.PathIndex { font-weight: bold; padding:0px 5px; margin-right:5px; }
.PathIndex { -webkit-border-radius:8px }
.PathIndex { border-radius:8px }
.PathIndexEvent { background-color:#bfba87 }
.PathIndexControl { background-color:#8c8c8c }
.PathIndexPopUp { background-color: #879abc; }
.PathNav a { text-decoration:none; font-size: larger }
.CodeInsertionHint { font-weight: bold; background-color: #10dd10 }
.CodeRemovalHint { background-color:#de1010 }
.CodeRemovalHint { border-bottom:1px solid #6F9DBE }
.selected{ background-color:orange !important; }

table.simpletable {
  padding: 5px;
  font-size:12pt;
  margin:20px;
  border-collapse: collapse; border-spacing: 0px;
}
td.rowname {
  text-align: right;
  vertical-align: top;
  font-weight: bold;
  color:#444444;
  padding-right:2ex;
}

/* Hidden text. */
input.spoilerhider + label {
  cursor: pointer;
  text-decoration: underline;
  display: block;
}
input.spoilerhider {
 display: none;
}
input.spoilerhider ~ .spoiler {
  overflow: hidden;
  margin: 10px auto 0;
  height: 0;
  opacity: 0;
}
input.spoilerhider:checked + label + .spoiler{
  height: auto;
  opacity: 1;
}
</style>
</head>
<body>
<!-- BUGDESC Opened stream never closed. Potential resource leak -->

<!-- BUGTYPE Resource leak -->

<!-- BUGCATEGORY Stream handling error -->

<!-- BUGFILE /home/zhh/projects/bitcoin-0.21.1/src/logging.cpp -->

<!-- FILENAME logging.cpp -->

<!-- FUNCTIONNAME ShrinkDebugFile -->

<!-- ISSUEHASHCONTENTOFLINEINCONTEXT a72cb50fd6f7d269530758b5d86243cc -->

<!-- BUGLINE 322 -->

<!-- BUGCOLUMN 1 -->

<!-- EXCEPTIONAL -->

<!-- BUGPATHLENGTH 34 -->

<!-- BUGMETAEND -->
<!-- REPORTHEADER -->
<h3>Bug Summary [throw at :890:17]</h3>
<table class="simpletable">
<tr><td class="rowname">File:</td><td>/home/zhh/projects/bitcoin-0.21.1/src/logging.cpp</td></tr>
<tr><td class="rowname">Warning:</td><td><a href="#EndPath">line 322, column 1</a><br />Opened stream never closed. Potential resource leak</td></tr>

</table>
<!-- REPORTSUMMARYEXTRA -->
<h3>Annotated Source Code</h3>
<p>Press <a href="#" onclick="toggleHelp(); return false;">'?'</a>
   to see keyboard shortcuts</p>
<input type="checkbox" class="spoilerhider" id="showinvocation" />
<label for="showinvocation" >Show analyzer invocation</label>
<div class="spoiler">clang -cc1 -cc1 -triple x86_64-unknown-linux-gnu -analyze -disable-free -disable-llvm-verifier -discard-value-names -main-file-name logging.cpp -analyzer-store=region -analyzer-opt-analyze-nested-blocks -analyzer-checker=core -analyzer-checker=apiModeling -analyzer-checker=unix -analyzer-checker=deadcode -analyzer-checker=cplusplus -analyzer-checker=security.insecureAPI.UncheckedReturn -analyzer-checker=security.insecureAPI.getpw -analyzer-checker=security.insecureAPI.gets -analyzer-checker=security.insecureAPI.mktemp -analyzer-checker=security.insecureAPI.mkstemp -analyzer-checker=security.insecureAPI.vfork -analyzer-checker=nullability.NullPassedToNonnull -analyzer-checker=nullability.NullReturnedFromNonnull -analyzer-output plist -w -setup-static-analyzer -analyzer-config-compatibility-mode=true -mrelocation-model pic -pic-level 2 -pic-is-pie -mframe-pointer=none -fmath-errno -fno-rounding-math -mconstructor-aliases -munwind-tables -target-cpu x86-64 -tune-cpu generic -fno-split-dwarf-inlining -debug-info-kind=limited -dwarf-version=4 -debugger-tuning=gdb -resource-dir /home/zhh/llvm/build/lib/clang/13.0.0 -D HAVE_CONFIG_H -I . -I ../src/config -U _FORTIFY_SOURCE -D _FORTIFY_SOURCE=2 -I . -I ./secp256k1/include -D BOOST_SP_USE_STD_ATOMIC -D BOOST_AC_USE_STD_ATOMIC -I /usr/local/include -I ./leveldb/include -I ./leveldb/helpers/memenv -I ./univalue/include -D HAVE_BUILD_INFO -D __STDC_FORMAT_MACROS -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/x86_64-linux-gnu/c++/9 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/x86_64-linux-gnu/c++/9 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/backward -internal-isystem /usr/local/include -internal-isystem /home/zhh/llvm/build/lib/clang/13.0.0/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -O2 -Wstack-protector -Wall -Wextra -Wgnu -Wformat -Wformat-security -Wvla -Wshadow-field -Wswitch -Wthread-safety -Wrange-loop-analysis -Wredundant-decls -Wunused-variable -Wdate-time -Wconditional-uninitialized -Wsign-compare -Woverloaded-virtual -Wsuggest-override -Wunreachable-code-loop-increment -Wno-unused-parameter -Wno-self-assign -Wno-unused-local-typedef -Wno-deprecated-register -Wno-implicit-fallthrough -Wno-deprecated-copy -std=c++11 -fdeprecated-macro -fdebug-compilation-dir=/home/zhh/projects/bitcoin-0.21.1/src -ferror-limit 19 -pthread -stack-protector 3 -fstack-clash-protection -fcf-protection=full -fgnuc-version=4.2.1 -fcxx-exceptions -fexceptions -vectorize-loops -vectorize-slp -analyzer-checker=alpha.unix.Stream -analyzer-config cplusplus.Move:WarnOn=All -analyzer-config suppress-null-return-paths=false -analyzer-config suppress-inlined-defensive-checks=false -analyzer-config stable-report-filename=true -analyzer-config max-nodes=1000000 -stats-file=/home/zhh/projects/bitcoin-0.21.1/csa/eh-cross/cache/csa/home/zhh/projects/bitcoin-0.21.1/src/logging.cpp.json -analyzer-output=html -analyzer-purge=none -analyzer-config crosscheck-with-z3=true -analyzer-config experimental-enable-naive-ctu-analysis=true -analyzer-config ctu-dir=/home/zhh/projects/bitcoin-0.21.1/csa/eh-cross/cache -faddrsig -o /home/zhh/projects/bitcoin-0.21.1/csa/eh-cross/reports/20220822-222809 -x c++ logging.cpp
</div>
<div id='tooltiphint' hidden="true">
  <p>Keyboard shortcuts: </p>
  <ul>
    <li>Use 'j/k' keys for keyboard navigation</li>
    <li>Use 'Shift+S' to show/hide relevant lines</li>
    <li>Use '?' to toggle this window</li>
  </ul>
  <a href="#" onclick="toggleHelp(); return false;">Close</a>
</div>
<script type='text/javascript'>
var relevant_lines = {"1": {"14": 1, "15": 1, "31": 1, "32": 1, "225": 1, "226": 1, "227": 1, "228": 1, "229": 1, "232": 1, "235": 1, "239": 1, "240": 1, "241": 1, "242": 1, "244": 1, "283": 1, "284": 1, "286": 1, "288": 1, "291": 1, "294": 1, "296": 1, "301": 1, "304": 1, "305": 1, "306": 1, "322": 1}, "3": {"62": 1, "101": 1, "102": 1, "103": 1, "104": 1, "166": 1, "167": 1, "168": 1, "169": 1, "171": 1, "176": 1}, "1232": {"906": 1, "907": 1, "908": 1, "909": 1, "910": 1}, "2517": {"153": 1}, "2519": {"89": 1}, "2943": {"247": 1, "248": 1, "249": 1, "250": 1, "251": 1, "252": 1, "745": 1, "746": 1, "747": 1, "748": 1, "749": 1, "751": 1, "775": 1, "776": 1, "777": 1, "778": 1, "779": 1}, "7274": {"92": 1, "93": 1, "390": 1, "391": 1}, "7276": {"625": 1, "626": 1, "627": 1, "636": 1, "637": 1, "638": 1, "639": 1, "640": 1, "641": 1, "695": 1, "696": 1, "697": 1, "704": 1, "705": 1, "706": 1, "707": 1, "708": 1, "709": 1, "718": 1, "719": 1, "720": 1, "727": 1, "728": 1, "729": 1, "730": 1, "731": 1, "732": 1}, "7347": {"203": 1, "204": 1, "205": 1, "470": 1, "471": 1, "472": 1, "473": 1, "474": 1, "538": 1, "539": 1}, "7363": {"281": 1, "282": 1, "369": 1, "370": 1, "371": 1, "372": 1, "377": 1, "389": 1, "390": 1, "391": 1, "392": 1, "393": 1, "394": 1, "460": 1, "461": 1, "462": 1, "463": 1}, "10055": {"65": 1, "89": 1, "90": 1, "91": 1, "97": 1, "98": 1, "99": 1, "100": 1, "103": 1, "114": 1, "115": 1, "116": 1, "118": 1, "158": 1, "159": 1, "164": 1, "165": 1}, "10196": {"520": 1}, "111266": {"414": 1, "415": 1}, "111450": {"185": 1, "517": 1, "518": 1, "519": 1, "520": 1, "521": 1, "872": 1, "873": 1, "874": 1, "875": 1, "877": 1, "878": 1, "879": 1, "880": 1, "884": 1, "885": 1, "886": 1, "887": 1, "888": 1, "889": 1, "890": 1, "892": 1, "931": 1, "932": 1, "933": 1, "934": 1, "949": 1, "950": 1, "973": 1, "974": 1, "975": 1, "976": 1, "1008": 1, "1026": 1, "1027": 1, "1028": 1, "1052": 1, "1053": 1, "1054": 1, "1062": 1, "1063": 1, "1064": 1, "1070": 1, "1071": 1, "1072": 1, "1073": 1, "1074": 1}, "111454": {"110": 1, "111": 1, "112": 1, "113": 1, "177": 1, "178": 1, "179": 1, "180": 1, "181": 1, "190": 1, "191": 1, "583": 1, "584": 1, "585": 1, "629": 1, "630": 1, "676": 1, "677": 1, "678": 1}, "111466": {"291": 1}, "111574": {"57": 1, "73": 1, "74": 1}, "111637": {"24": 1, "25": 1, "27": 1}};

var filterCounterexample = function (hide) {
  var tables = document.getElementsByClassName("code");
  for (var t=0; t<tables.length; t++) {
    var table = tables[t];
    var file_id = table.getAttribute("data-fileid");
    var lines_in_fid = relevant_lines[file_id];
    if (!lines_in_fid) {
      lines_in_fid = {};
    }
    var lines = table.getElementsByClassName("codeline");
    for (var i=0; i<lines.length; i++) {
        var el = lines[i];
        var lineNo = el.getAttribute("data-linenumber");
        if (!lines_in_fid[lineNo]) {
          if (hide) {
            el.setAttribute("hidden", "");
          } else {
            el.removeAttribute("hidden");
          }
        }
    }
  }
}

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "S") {
    var checked = document.getElementsByName("showCounterexample")[0].checked;
    filterCounterexample(!checked);
    document.getElementsByName("showCounterexample")[0].checked = !checked;
  } else {
    return;
  }
  event.preventDefault();
}, true);

document.addEventListener("DOMContentLoaded", function() {
    document.querySelector('input[name="showCounterexample"]').onchange=
        function (event) {
      filterCounterexample(this.checked);
    };
});
</script>

<form>
    <input type="checkbox" name="showCounterexample" id="showCounterexample" />
    <label for="showCounterexample">
       Show only relevant lines
    </label>
</form>

<script type='text/javascript'>
var digitMatcher = new RegExp("[0-9]+");

var querySelectorAllArray = function(selector) {
  return Array.prototype.slice.call(
    document.querySelectorAll(selector));
}

document.addEventListener("DOMContentLoaded", function() {
    querySelectorAllArray(".PathNav > a").forEach(
        function(currentValue, currentIndex) {
            var hrefValue = currentValue.getAttribute("href");
            currentValue.onclick = function() {
                scrollTo(document.querySelector(hrefValue));
                return false;
            };
        });
});

var findNum = function() {
    var s = document.querySelector(".selected");
    if (!s || s.id == "EndPath") {
        return 0;
    }
    var out = parseInt(digitMatcher.exec(s.id)[0]);
    return out;
};

var scrollTo = function(el) {
    querySelectorAllArray(".selected").forEach(function(s) {
        s.classList.remove("selected");
    });
    el.classList.add("selected");
    window.scrollBy(0, el.getBoundingClientRect().top -
        (window.innerHeight / 2));
}

var move = function(num, up, numItems) {
  if (num == 1 && up || num == numItems - 1 && !up) {
    return 0;
  } else if (num == 0 && up) {
    return numItems - 1;
  } else if (num == 0 && !up) {
    return 1 % numItems;
  }
  return up ? num - 1 : num + 1;
}

var numToId = function(num) {
  if (num == 0) {
    return document.getElementById("EndPath")
  }
  return document.getElementById("Path" + num);
};

var navigateTo = function(up) {
  var numItems = document.querySelectorAll(
      ".line > .msgEvent, .line > .msgControl").length;
  var currentSelected = findNum();
  var newSelected = move(currentSelected, up, numItems);
  var newEl = numToId(newSelected, numItems);

  // Scroll element into center.
  scrollTo(newEl);
};

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "j") {
    navigateTo(/*up=*/false);
  } else if (event.key == "k") {
    navigateTo(/*up=*/true);
  } else {
    return;
  }
  event.preventDefault();
}, true);
</script>
  
<script type='text/javascript'>

var toggleHelp = function() {
    var hint = document.querySelector("#tooltiphint");
    var attributeName = "hidden";
    if (hint.hasAttribute(attributeName)) {
      hint.removeAttribute(attributeName);
    } else {
      hint.setAttribute("hidden", "true");
    }
};
window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "?") {
    toggleHelp();
  } else {
    return;
  }
  event.preventDefault();
});
</script>
<div id=File1>
<h4 class=FileName>logging.cpp</h4>
<div class=FileNav><a href="#File111637">&#x2192;</a></div></div>
<table class="code" data-fileid="1">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='comment'>// Copyright (c) 2009-2010 Satoshi Nakamoto</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"><span class='comment'>// Copyright (c) 2009-2020 The Bitcoin Core developers</span></td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line"><span class='comment'>// Distributed under the MIT software license, see the accompanying</span></td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"><span class='comment'>// file COPYING or http://www.opensource.org/licenses/mit-license.php.</span></td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line"><span class='directive'>#include &lt;logging.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line"><span class='directive'>#include &lt;util/threadnames.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"><span class='directive'>#include &lt;util/time.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"><span class='directive'>#include &lt;mutex&gt;</span></td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> * <span class='keyword'>const</span> DEFAULT_DEBUGLOGFILE = <span class='string_literal'>"debug.log"</span>;</td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line">BCLog::Logger&amp; LogInstance()</td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line"> <span class='comment'>* NOTE: the logger instances is leaked on exit. This is ugly, but will be</span></td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line"> <span class='comment'>* cleaned up by the OS/libc. Defining a logger as a global object doesn't work</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"> <span class='comment'>* since the order of destruction of static/global objects is undefined.</span></td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"> <span class='comment'>* Consider if the logger gets destroyed, and then some later destructor calls</span></td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"> <span class='comment'>* LogPrintf, maybe indirectly, and you get a core dump at shutdown trying to</span></td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line"> <span class='comment'>* access the logger. When the shutdown sequence is fully audited and tested,</span></td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line"> <span class='comment'>* explicit destruction of these objects can be implemented by changing this</span></td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line"> <span class='comment'>* from a raw pointer to a std::unique_ptr.</span></td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line"> <span class='comment'>* Since the ~Logger() destructor is never called, the Logger class and all</span></td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line"> <span class='comment'>* its subclasses must have implicitly-defined destructors.</span></td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line"> <span class='comment'>* This method of initialization was originally introduced in</span></td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line"> <span class='comment'>* ee3374234c60aba2cc4c5cd5cac1c0aefc2d817c.</span></td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line">    <span class='keyword'>static</span> BCLog::Logger* g_logger{<span class='keyword'>new</span> BCLog::Logger()};</td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line">    <span class='keyword'>return</span> *g_logger;</td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line"><span class='keyword'>bool</span> fLogIPs = DEFAULT_LOGIPS;</td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>int</span> FileWriteStr(<span class='keyword'>const</span> std::string &amp;str, FILE *fp)</td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line">    <span class='keyword'>return</span> fwrite(str.data(), 1, str.size(), fp);</td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line"><span class='keyword'>bool</span> BCLog::Logger::StartLogging()</td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line">    StdLockGuard scoped_lock(m_cs);</td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line">    <span class='macro'>assert(m_buffering)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_buffering) ? void (0) : __assert_fail<br> ("m_buffering", "logging.cpp", 46, __extension__ __PRETTY_FUNCTION__<br>))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line">    <span class='macro'>assert(m_fileout == <span class='keyword'>nullptr</span>)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_fileout == nullptr) ? void (0) :<br> __assert_fail ("m_fileout == nullptr", "logging.cpp", 47, __extension__<br> __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line">    <span class='keyword'>if</span> (m_print_to_file) {</td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line">        <span class='macro'>assert(!m_file_path.empty())<span class='macro_popup'>(static_cast &lt;bool&gt; (!m_file_path.empty()) ? void (0) :<br> __assert_fail ("!m_file_path.empty()", "logging.cpp", 50, __extension__<br> __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line">        m_fileout = fsbridge::fopen(m_file_path, <span class='string_literal'>"a"</span>);</td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line">        <span class='keyword'>if</span> (!m_fileout) {</td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line">            <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line">        setbuf(m_fileout, <span class='keyword'>nullptr</span>); <span class='comment'>// unbuffered</span></td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line">        <span class='comment'>// Add newlines to the logfile to distinguish this execution from the</span></td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line">        <span class='comment'>// last one.</span></td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line">        FileWriteStr(<span class='string_literal'>"\n\n\n\n\n"</span>, m_fileout);</td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line">    <span class='comment'>// dump buffered messages from before we opened the log</span></td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line">    m_buffering = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line">    <span class='keyword'>while</span> (!m_msgs_before_open.empty()) {</td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line">        <span class='keyword'>const</span> std::string&amp; s = m_msgs_before_open.front();</td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line">        <span class='keyword'>if</span> (m_print_to_file) FileWriteStr(s, m_fileout);</td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line">        <span class='keyword'>if</span> (m_print_to_console) fwrite(s.data(), 1, s.size(), <span class='macro'>stdout<span class='macro_popup'>stdout</span></span>);</td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line">        <span class='keyword'>for</span> (<span class='keyword'>const</span> <span class='keyword'>auto</span>&amp; cb : m_print_callbacks) {</td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line">            cb(s);</td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line">        m_msgs_before_open.pop_front();</td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line">    <span class='keyword'>if</span> (m_print_to_console) fflush(<span class='macro'>stdout<span class='macro_popup'>stdout</span></span>);</td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line"><span class='keyword'>void</span> BCLog::Logger::DisconnectTestLogger()</td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line">    StdLockGuard scoped_lock(m_cs);</td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line">    m_buffering = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line">    <span class='keyword'>if</span> (m_fileout != <span class='keyword'>nullptr</span>) fclose(m_fileout);</td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line">    m_fileout = <span class='keyword'>nullptr</span>;</td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line">    m_print_callbacks.clear();</td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line"><span class='keyword'>void</span> BCLog::Logger::EnableCategory(BCLog::LogFlags flag)</td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line">    m_categories |= flag;</td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line"><span class='keyword'>bool</span> BCLog::Logger::EnableCategory(<span class='keyword'>const</span> std::string&amp; str)</td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line">    BCLog::LogFlags flag;</td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line">    <span class='keyword'>if</span> (!GetLogCategory(flag, str)) <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line">    EnableCategory(flag);</td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line"><span class='keyword'>void</span> BCLog::Logger::DisableCategory(BCLog::LogFlags flag)</td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line">    m_categories &amp;= ~flag;</td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line"><span class='keyword'>bool</span> BCLog::Logger::DisableCategory(<span class='keyword'>const</span> std::string&amp; str)</td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line">    BCLog::LogFlags flag;</td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line">    <span class='keyword'>if</span> (!GetLogCategory(flag, str)) <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line">    DisableCategory(flag);</td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line"><span class='keyword'>bool</span> BCLog::Logger::WillLogCategory(BCLog::LogFlags category) <span class='keyword'>const</span></td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line">    <span class='keyword'>return</span> (m_categories.load(std::memory_order_relaxed) &amp; category) != 0;</td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line"><span class='keyword'>bool</span> BCLog::Logger::DefaultShrinkDebugFile() <span class='keyword'>const</span></td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line">    <span class='keyword'>return</span> m_categories == BCLog::NONE;</td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line"><span class='keyword'>struct</span> CLogCategoryDesc</td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line">    BCLog::LogFlags flag;</td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line">    std::string category;</td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line"><span class='keyword'>const</span> CLogCategoryDesc LogCategories[] =</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line">    {BCLog::NONE, <span class='string_literal'>"0"</span>},</td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line">    {BCLog::NONE, <span class='string_literal'>"none"</span>},</td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line">    {BCLog::NET, <span class='string_literal'>"net"</span>},</td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line">    {BCLog::TOR, <span class='string_literal'>"tor"</span>},</td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line">    {BCLog::MEMPOOL, <span class='string_literal'>"mempool"</span>},</td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line">    {BCLog::HTTP, <span class='string_literal'>"http"</span>},</td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line">    {BCLog::BENCH, <span class='string_literal'>"bench"</span>},</td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line">    {BCLog::ZMQ, <span class='string_literal'>"zmq"</span>},</td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line">    {BCLog::WALLETDB, <span class='string_literal'>"walletdb"</span>},</td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line">    {BCLog::RPC, <span class='string_literal'>"rpc"</span>},</td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line">    {BCLog::ESTIMATEFEE, <span class='string_literal'>"estimatefee"</span>},</td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line">    {BCLog::ADDRMAN, <span class='string_literal'>"addrman"</span>},</td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line">    {BCLog::SELECTCOINS, <span class='string_literal'>"selectcoins"</span>},</td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line">    {BCLog::REINDEX, <span class='string_literal'>"reindex"</span>},</td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line">    {BCLog::CMPCTBLOCK, <span class='string_literal'>"cmpctblock"</span>},</td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line">    {BCLog::RAND, <span class='string_literal'>"rand"</span>},</td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line">    {BCLog::PRUNE, <span class='string_literal'>"prune"</span>},</td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line">    {BCLog::PROXY, <span class='string_literal'>"proxy"</span>},</td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line">    {BCLog::MEMPOOLREJ, <span class='string_literal'>"mempoolrej"</span>},</td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line">    {BCLog::LIBEVENT, <span class='string_literal'>"libevent"</span>},</td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line">    {BCLog::COINDB, <span class='string_literal'>"coindb"</span>},</td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line">    {BCLog::QT, <span class='string_literal'>"qt"</span>},</td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line">    {BCLog::LEVELDB, <span class='string_literal'>"leveldb"</span>},</td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line">    {BCLog::VALIDATION, <span class='string_literal'>"validation"</span>},</td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line">    {BCLog::ALL, <span class='string_literal'>"1"</span>},</td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line">    {BCLog::ALL, <span class='string_literal'>"all"</span>},</td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line"><span class='keyword'>bool</span> GetLogCategory(BCLog::LogFlags&amp; flag, <span class='keyword'>const</span> std::string&amp; str)</td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line">    <span class='keyword'>if</span> (str == <span class='string_literal'>""</span>) {</td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line">        flag = BCLog::ALL;</td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line">        <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line">    <span class='keyword'>for</span> (<span class='keyword'>const</span> CLogCategoryDesc&amp; category_desc : LogCategories) {</td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line">        <span class='keyword'>if</span> (category_desc.category == str) {</td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line">            flag = category_desc.flag;</td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line">            <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line">std::vector&lt;LogCategory&gt; BCLog::Logger::LogCategoriesList()</td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line">    std::vector&lt;LogCategory&gt; ret;</td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line">    <span class='keyword'>for</span> (<span class='keyword'>const</span> CLogCategoryDesc&amp; category_desc : LogCategories) {</td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line">        <span class='comment'>// Omit the special cases.</span></td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line">        <span class='keyword'>if</span> (category_desc.flag != BCLog::NONE &amp;&amp; category_desc.flag != BCLog::ALL) {</td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line">            LogCategory catActive;</td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line">            catActive.category = category_desc.category;</td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line">            catActive.active = WillLogCategory(category_desc.flag);</td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line">            ret.push_back(catActive);</td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line">    <span class='keyword'>return</span> ret;</td></tr>
<tr class="codeline" data-linenumber="190"><td class="num" id="LN190">190</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="191"><td class="num" id="LN191">191</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="192"><td class="num" id="LN192">192</td><td class="line">std::string BCLog::Logger::LogTimestampStr(<span class='keyword'>const</span> std::string&amp; str)</td></tr>
<tr class="codeline" data-linenumber="193"><td class="num" id="LN193">193</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="194"><td class="num" id="LN194">194</td><td class="line">    std::string strStamped;</td></tr>
<tr class="codeline" data-linenumber="195"><td class="num" id="LN195">195</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="196"><td class="num" id="LN196">196</td><td class="line">    <span class='keyword'>if</span> (!m_log_timestamps)</td></tr>
<tr class="codeline" data-linenumber="197"><td class="num" id="LN197">197</td><td class="line">        <span class='keyword'>return</span> str;</td></tr>
<tr class="codeline" data-linenumber="198"><td class="num" id="LN198">198</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="199"><td class="num" id="LN199">199</td><td class="line">    <span class='keyword'>if</span> (m_started_new_line) {</td></tr>
<tr class="codeline" data-linenumber="200"><td class="num" id="LN200">200</td><td class="line">        int64_t nTimeMicros = GetTimeMicros();</td></tr>
<tr class="codeline" data-linenumber="201"><td class="num" id="LN201">201</td><td class="line">        strStamped = FormatISO8601DateTime(nTimeMicros/1000000);</td></tr>
<tr class="codeline" data-linenumber="202"><td class="num" id="LN202">202</td><td class="line">        <span class='keyword'>if</span> (m_log_time_micros) {</td></tr>
<tr class="codeline" data-linenumber="203"><td class="num" id="LN203">203</td><td class="line">            strStamped.pop_back();</td></tr>
<tr class="codeline" data-linenumber="204"><td class="num" id="LN204">204</td><td class="line">            strStamped += <span class='macro'>strprintf<span class='macro_popup'>tfm::format</span></span>(<span class='string_literal'>".%06dZ"</span>, nTimeMicros%1000000);</td></tr>
<tr class="codeline" data-linenumber="205"><td class="num" id="LN205">205</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="206"><td class="num" id="LN206">206</td><td class="line">        int64_t mocktime = GetMockTime();</td></tr>
<tr class="codeline" data-linenumber="207"><td class="num" id="LN207">207</td><td class="line">        <span class='keyword'>if</span> (mocktime) {</td></tr>
<tr class="codeline" data-linenumber="208"><td class="num" id="LN208">208</td><td class="line">            strStamped += <span class='string_literal'>" (mocktime: "</span> + FormatISO8601DateTime(mocktime) + <span class='string_literal'>")"</span>;</td></tr>
<tr class="codeline" data-linenumber="209"><td class="num" id="LN209">209</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="210"><td class="num" id="LN210">210</td><td class="line">        strStamped += ' ' + str;</td></tr>
<tr class="codeline" data-linenumber="211"><td class="num" id="LN211">211</td><td class="line">    } <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="212"><td class="num" id="LN212">212</td><td class="line">        strStamped = str;</td></tr>
<tr class="codeline" data-linenumber="213"><td class="num" id="LN213">213</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="214"><td class="num" id="LN214">214</td><td class="line">    <span class='keyword'>return</span> strStamped;</td></tr>
<tr class="codeline" data-linenumber="215"><td class="num" id="LN215">215</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="216"><td class="num" id="LN216">216</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="217"><td class="num" id="LN217">217</td><td class="line"><span class='keyword'>namespace</span> BCLog {</td></tr>
<tr class="codeline" data-linenumber="218"><td class="num" id="LN218">218</td><td class="line">    <span class='comment'>/** Belts and suspenders: make sure outgoing log messages don't contain</span></td></tr>
<tr class="codeline" data-linenumber="219"><td class="num" id="LN219">219</td><td class="line">     <span class='comment'>* potentially suspicious characters, such as terminal control codes.</span></td></tr>
<tr class="codeline" data-linenumber="220"><td class="num" id="LN220">220</td><td class="line">     <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="221"><td class="num" id="LN221">221</td><td class="line">     <span class='comment'>* This escapes control characters except newline ('\n') in C syntax.</span></td></tr>
<tr class="codeline" data-linenumber="222"><td class="num" id="LN222">222</td><td class="line">     <span class='comment'>* It escapes instead of removes them to still allow for troubleshooting</span></td></tr>
<tr class="codeline" data-linenumber="223"><td class="num" id="LN223">223</td><td class="line">     <span class='comment'>* issues where they accidentally end up in strings.</span></td></tr>
<tr class="codeline" data-linenumber="224"><td class="num" id="LN224">224</td><td class="line">     <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="225"><td class="num" id="LN225">225</td><td class="line">    std::string LogEscapeMessage(<span class='keyword'>const</span> std::string&amp; str) {</td></tr>
<tr class="codeline" data-linenumber="226"><td class="num" id="LN226">226</td><td class="line">        std::string ret;</td></tr>
<tr class="codeline" data-linenumber="227"><td class="num" id="LN227">227</td><td class="line">        <span class='keyword'>for</span> (<span class='keyword'>char</span> ch_in : str) {</td></tr>
<tr class="codeline" data-linenumber="228"><td class="num" id="LN228">228</td><td class="line">            uint8_t ch = (uint8_t)ch_in;</td></tr>
<tr class="codeline" data-linenumber="229"><td class="num" id="LN229">229</td><td class="line">            <span class='keyword'>if</span> ((<span class="mrange">ch &gt;= 32</span> || <span class="mrange">ch == '\n') &amp;&amp; ch != '</span>\x7f') {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path13" class="msg msgEvent" style="margin-left:18ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">13</div></td><td><div class="PathNav"><a href="#Path12" title="Previous event (12)">&#x2190;</a></div></td><td>Assuming 'ch' is &lt; 32</td><td><div class="PathNav"><a href="#Path14" title="Next event (14)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path14" class="msg msgEvent" style="margin-left:30ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">14</div></td><td><div class="PathNav"><a href="#Path13" title="Previous event (13)">&#x2190;</a></div></td><td>Assuming the condition is false</td><td><div class="PathNav"><a href="#Path15" title="Next event (15)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="230"><td class="num" id="LN230">230</td><td class="line">                ret += ch_in;</td></tr>
<tr class="codeline" data-linenumber="231"><td class="num" id="LN231">231</td><td class="line">            } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="232"><td class="num" id="LN232">232</td><td class="line">                ret += <span class="mrange"><span class="mrange"><span class='macro'>strprintf<span class='macro_popup'>tfm::format</span></span>(<span class='string_literal'>"\\x%02x"</span>, ch)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path15" class="msg msgEvent" style="margin-left:24ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">15</div></td><td><div class="PathNav"><a href="#Path14" title="Previous event (14)">&#x2190;</a></div></td><td>Calling 'format&lt;unsigned char&gt;'</td><td><div class="PathNav"><a href="#Path16" title="Next event (16)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path27" class="msg msgEvent" style="margin-left:24ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">27</div></td><td><div class="PathNav"><a href="#Path26" title="Previous event (26)">&#x2190;</a></div></td><td>Returning from 'format&lt;unsigned char&gt;'</td><td><div class="PathNav"><a href="#Path28" title="Next event (28)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="233"><td class="num" id="LN233">233</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="234"><td class="num" id="LN234">234</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="235"><td class="num" id="LN235">235</td><td class="line">        <span class='keyword'>return</span> ret;</td></tr>
<tr class="codeline" data-linenumber="236"><td class="num" id="LN236">236</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="237"><td class="num" id="LN237">237</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="238"><td class="num" id="LN238">238</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="239"><td class="num" id="LN239">239</td><td class="line"><span class='keyword'>void</span> BCLog::Logger::LogPrintStr(<span class='keyword'>const</span> std::string&amp; str)</td></tr>
<tr class="codeline" data-linenumber="240"><td class="num" id="LN240">240</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="241"><td class="num" id="LN241">241</td><td class="line">    StdLockGuard scoped_lock(m_cs);</td></tr>
<tr class="codeline" data-linenumber="242"><td class="num" id="LN242">242</td><td class="line">    std::string str_prefixed = <span class="mrange"><span class="mrange">LogEscapeMessage(str)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path12" class="msg msgEvent" style="margin-left:32ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">12</div></td><td><div class="PathNav"><a href="#Path11" title="Previous event (11)">&#x2190;</a></div></td><td>Calling 'LogEscapeMessage'</td><td><div class="PathNav"><a href="#Path13" title="Next event (13)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path28" class="msg msgEvent" style="margin-left:32ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">28</div></td><td><div class="PathNav"><a href="#Path27" title="Previous event (27)">&#x2190;</a></div></td><td>Returning from 'LogEscapeMessage'</td><td><div class="PathNav"><a href="#Path29" title="Next event (29)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="243"><td class="num" id="LN243">243</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="244"><td class="num" id="LN244">244</td><td class="line">    <span class='keyword'>if</span> (m_log_threadnames &amp;&amp; m_started_new_line) {</td></tr>
<tr class="codeline" data-linenumber="245"><td class="num" id="LN245">245</td><td class="line">        str_prefixed.insert(0, <span class='string_literal'>"["</span> + util::ThreadGetInternalName() + <span class='string_literal'>"] "</span>);</td></tr>
<tr class="codeline" data-linenumber="246"><td class="num" id="LN246">246</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="247"><td class="num" id="LN247">247</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="248"><td class="num" id="LN248">248</td><td class="line">    str_prefixed = LogTimestampStr(str_prefixed);</td></tr>
<tr class="codeline" data-linenumber="249"><td class="num" id="LN249">249</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="250"><td class="num" id="LN250">250</td><td class="line">    m_started_new_line = !str.empty() &amp;&amp; str[str.size()-1] == '\n';</td></tr>
<tr class="codeline" data-linenumber="251"><td class="num" id="LN251">251</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="252"><td class="num" id="LN252">252</td><td class="line">    <span class='keyword'>if</span> (m_buffering) {</td></tr>
<tr class="codeline" data-linenumber="253"><td class="num" id="LN253">253</td><td class="line">        <span class='comment'>// buffer if we haven't started logging yet</span></td></tr>
<tr class="codeline" data-linenumber="254"><td class="num" id="LN254">254</td><td class="line">        m_msgs_before_open.push_back(str_prefixed);</td></tr>
<tr class="codeline" data-linenumber="255"><td class="num" id="LN255">255</td><td class="line">        <span class='keyword'>return</span>;</td></tr>
<tr class="codeline" data-linenumber="256"><td class="num" id="LN256">256</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="257"><td class="num" id="LN257">257</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="258"><td class="num" id="LN258">258</td><td class="line">    <span class='keyword'>if</span> (m_print_to_console) {</td></tr>
<tr class="codeline" data-linenumber="259"><td class="num" id="LN259">259</td><td class="line">        <span class='comment'>// print to console</span></td></tr>
<tr class="codeline" data-linenumber="260"><td class="num" id="LN260">260</td><td class="line">        fwrite(str_prefixed.data(), 1, str_prefixed.size(), <span class='macro'>stdout<span class='macro_popup'>stdout</span></span>);</td></tr>
<tr class="codeline" data-linenumber="261"><td class="num" id="LN261">261</td><td class="line">        fflush(<span class='macro'>stdout<span class='macro_popup'>stdout</span></span>);</td></tr>
<tr class="codeline" data-linenumber="262"><td class="num" id="LN262">262</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="263"><td class="num" id="LN263">263</td><td class="line">    <span class='keyword'>for</span> (<span class='keyword'>const</span> <span class='keyword'>auto</span>&amp; cb : m_print_callbacks) {</td></tr>
<tr class="codeline" data-linenumber="264"><td class="num" id="LN264">264</td><td class="line">        cb(str_prefixed);</td></tr>
<tr class="codeline" data-linenumber="265"><td class="num" id="LN265">265</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="266"><td class="num" id="LN266">266</td><td class="line">    <span class='keyword'>if</span> (m_print_to_file) {</td></tr>
<tr class="codeline" data-linenumber="267"><td class="num" id="LN267">267</td><td class="line">        <span class='macro'>assert(m_fileout != <span class='keyword'>nullptr</span>)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_fileout != nullptr) ? void (0) :<br> __assert_fail ("m_fileout != nullptr", "logging.cpp", 267, __extension__<br> __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="268"><td class="num" id="LN268">268</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="269"><td class="num" id="LN269">269</td><td class="line">        <span class='comment'>// reopen the log file, if requested</span></td></tr>
<tr class="codeline" data-linenumber="270"><td class="num" id="LN270">270</td><td class="line">        <span class='keyword'>if</span> (m_reopen_file) {</td></tr>
<tr class="codeline" data-linenumber="271"><td class="num" id="LN271">271</td><td class="line">            m_reopen_file = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="272"><td class="num" id="LN272">272</td><td class="line">            FILE* new_fileout = fsbridge::fopen(m_file_path, <span class='string_literal'>"a"</span>);</td></tr>
<tr class="codeline" data-linenumber="273"><td class="num" id="LN273">273</td><td class="line">            <span class='keyword'>if</span> (new_fileout) {</td></tr>
<tr class="codeline" data-linenumber="274"><td class="num" id="LN274">274</td><td class="line">                setbuf(new_fileout, <span class='keyword'>nullptr</span>); <span class='comment'>// unbuffered</span></td></tr>
<tr class="codeline" data-linenumber="275"><td class="num" id="LN275">275</td><td class="line">                fclose(m_fileout);</td></tr>
<tr class="codeline" data-linenumber="276"><td class="num" id="LN276">276</td><td class="line">                m_fileout = new_fileout;</td></tr>
<tr class="codeline" data-linenumber="277"><td class="num" id="LN277">277</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="278"><td class="num" id="LN278">278</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="279"><td class="num" id="LN279">279</td><td class="line">        FileWriteStr(str_prefixed, m_fileout);</td></tr>
<tr class="codeline" data-linenumber="280"><td class="num" id="LN280">280</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="281"><td class="num" id="LN281">281</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="282"><td class="num" id="LN282">282</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="283"><td class="num" id="LN283">283</td><td class="line"><span class='keyword'>void</span> BCLog::Logger::ShrinkDebugFile()</td></tr>
<tr class="codeline" data-linenumber="284"><td class="num" id="LN284">284</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="285"><td class="num" id="LN285">285</td><td class="line">    <span class='comment'>// Amount of debug.log to save at end when shrinking (must fit in memory)</span></td></tr>
<tr class="codeline" data-linenumber="286"><td class="num" id="LN286">286</td><td class="line">    <span class='keyword'>constexpr</span> size_t RECENT_DEBUG_HISTORY_SIZE = 10 * 1000000;</td></tr>
<tr class="codeline" data-linenumber="287"><td class="num" id="LN287">287</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="288"><td class="num" id="LN288">288</td><td class="line">    <span class="mrange"><span class='macro'>assert</span>(!m_file_path.empty())<span class='macro_popup'>(static_cast &lt;bool&gt; (!m_file_path.empty()) ? void (0) :<br> __assert_fail ("!m_file_path.empty()", "logging.cpp", 288, __extension__<br> __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path1" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">1</div></td><td>Assuming the condition is true</td><td><div class="PathNav"><a href="#Path2" title="Next event (2)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path2" class="msg msgControl" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">2</div></td><td><div class="PathNav"><a href="#Path1" title="Previous event (1)">&#x2190;</a></div></td><td>'?' condition is true</td><td><div class="PathNav"><a href="#Path3" title="Next event (3)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="289"><td class="num" id="LN289">289</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="290"><td class="num" id="LN290">290</td><td class="line">    <span class='comment'>// Scroll debug.log if it's getting too big</span></td></tr>
<tr class="codeline" data-linenumber="291"><td class="num" id="LN291">291</td><td class="line">    FILE* file = <span class="mrange"><span class="mrange">fsbridge::fopen(m_file_path, <span class='string_literal'>"r"</span>)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path3" class="msg msgEvent" style="margin-left:18ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">3</div></td><td><div class="PathNav"><a href="#Path2" title="Previous event (2)">&#x2190;</a></div></td><td>Calling 'fopen'</td><td><div class="PathNav"><a href="#Path4" title="Next event (4)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path5" class="msg msgEvent" style="margin-left:18ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">5</div></td><td><div class="PathNav"><a href="#Path4" title="Previous event (4)">&#x2190;</a></div></td><td>Returning from 'fopen'</td><td><div class="PathNav"><a href="#Path6" title="Next event (6)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="292"><td class="num" id="LN292">292</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="293"><td class="num" id="LN293">293</td><td class="line">    <span class='comment'>// Special files (e.g. device nodes) may not have a size.</span></td></tr>
<tr class="codeline" data-linenumber="294"><td class="num" id="LN294">294</td><td class="line">    size_t log_size = 0;</td></tr>
<tr class="codeline" data-linenumber="295"><td class="num" id="LN295">295</td><td class="line">    <span class='keyword'>try</span> {</td></tr>
<tr class="codeline" data-linenumber="296"><td class="num" id="LN296">296</td><td class="line">        log_size = fs::file_size(m_file_path);</td></tr>
<tr class="codeline" data-linenumber="297"><td class="num" id="LN297">297</td><td class="line">    } <span class='keyword'>catch</span> (<span class='keyword'>const</span> fs::filesystem_error&amp;) {}</td></tr>
<tr class="codeline" data-linenumber="298"><td class="num" id="LN298">298</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="299"><td class="num" id="LN299">299</td><td class="line">    <span class='comment'>// If debug.log file is more than 10% bigger the RECENT_DEBUG_HISTORY_SIZE</span></td></tr>
<tr class="codeline" data-linenumber="300"><td class="num" id="LN300">300</td><td class="line">    <span class='comment'>// trim it down by saving only the last RECENT_DEBUG_HISTORY_SIZE bytes</span></td></tr>
<tr class="codeline" data-linenumber="301"><td class="num" id="LN301">301</td><td class="line">    <span class='keyword'>if</span> (<span class='variable'><span class='variable'><span class='variable'><span class='variable'>file<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>5.1</div></td><td>'file' is non-null</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>5.1</div></td><td>'file' is non-null</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>5.1</div></td><td>'file' is non-null</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>5.1</div></td><td>'file' is non-null</td></tr></tbody></table></span> &amp;&amp; <span class="mrange">log_size &gt; 11 * (RECENT_DEBUG_HISTORY_SIZE / 10)</span>)</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path6" class="msg msgEvent" style="margin-left:17ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">6</div></td><td><div class="PathNav"><a href="#Path5" title="Previous event (5)">&#x2190;</a></div></td><td>Assuming the condition is true</td><td><div class="PathNav"><a href="#Path7" title="Next event (7)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path7" class="msg msgControl" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">7</div></td><td><div class="PathNav"><a href="#Path6" title="Previous event (6)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#Path8" title="Next event (8)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="302"><td class="num" id="LN302">302</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="303"><td class="num" id="LN303">303</td><td class="line">        <span class='comment'>// Restart the file with some of the end</span></td></tr>
<tr class="codeline" data-linenumber="304"><td class="num" id="LN304">304</td><td class="line">        std::vector&lt;<span class='keyword'>char</span>&gt; vch(RECENT_DEBUG_HISTORY_SIZE, 0);</td></tr>
<tr class="codeline" data-linenumber="305"><td class="num" id="LN305">305</td><td class="line">        <span class='keyword'>if</span> (fseek(file, -((<span class='keyword'>long</span>)vch.size()), <span class='macro'>SEEK_END<span class='macro_popup'>2</span></span>)) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path8" class="msg msgControl" style="margin-left:9ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">8</div></td><td><div class="PathNav"><a href="#Path7" title="Previous event (7)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#Path9" title="Next event (9)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="306"><td class="num" id="LN306">306</td><td class="line">            <span class="mrange"><span class="mrange">LogPrintf(<span class='string_literal'>"Failed to shrink debug log file: fseek(...) failed\n"</span>)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path9" class="msg msgEvent" style="margin-left:13ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">9</div></td><td><div class="PathNav"><a href="#Path8" title="Previous event (8)">&#x2190;</a></div></td><td>Calling 'LogPrintf&lt;&gt;'</td><td><div class="PathNav"><a href="#Path10" title="Next event (10)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path30" class="msg msgEvent" style="margin-left:13ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">30</div></td><td><div class="PathNav"><a href="#Path29" title="Previous event (29)">&#x2190;</a></div></td><td>Returning from 'LogPrintf&lt;&gt;'</td><td><div class="PathNav"><a href="#EndPath" title="Next event (31)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="307"><td class="num" id="LN307">307</td><td class="line">            fclose(file);</td></tr>
<tr class="codeline" data-linenumber="308"><td class="num" id="LN308">308</td><td class="line">            <span class='keyword'>return</span>;</td></tr>
<tr class="codeline" data-linenumber="309"><td class="num" id="LN309">309</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="310"><td class="num" id="LN310">310</td><td class="line">        <span class='keyword'>int</span> nBytes = fread(vch.data(), 1, vch.size(), file);</td></tr>
<tr class="codeline" data-linenumber="311"><td class="num" id="LN311">311</td><td class="line">        fclose(file);</td></tr>
<tr class="codeline" data-linenumber="312"><td class="num" id="LN312">312</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="313"><td class="num" id="LN313">313</td><td class="line">        file = fsbridge::fopen(m_file_path, <span class='string_literal'>"w"</span>);</td></tr>
<tr class="codeline" data-linenumber="314"><td class="num" id="LN314">314</td><td class="line">        <span class='keyword'>if</span> (file)</td></tr>
<tr class="codeline" data-linenumber="315"><td class="num" id="LN315">315</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="316"><td class="num" id="LN316">316</td><td class="line">            fwrite(vch.data(), 1, nBytes, file);</td></tr>
<tr class="codeline" data-linenumber="317"><td class="num" id="LN317">317</td><td class="line">            fclose(file);</td></tr>
<tr class="codeline" data-linenumber="318"><td class="num" id="LN318">318</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="319"><td class="num" id="LN319">319</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="320"><td class="num" id="LN320">320</td><td class="line">    <span class='keyword'>else</span> <span class='keyword'>if</span> (file != <span class='keyword'>nullptr</span>)</td></tr>
<tr class="codeline" data-linenumber="321"><td class="num" id="LN321">321</td><td class="line">        fclose(file);</td></tr>
<tr class="codeline" data-linenumber="322"><td class="num" id="LN322">322</td><td class="line">}</td></tr>
<tr><td class="num"></td><td class="line"><div id="EndPath" class="msg msgEvent" style="margin-left:1ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">31</div></td><td><div class="PathNav"><a href="#Path30" title="Previous event (30)">&#x2190;</a></div></td><td>Opened stream never closed. Potential resource leak</td></tr></table></div></td></tr>
</table><hr class=divider>
<div id=File111637>
<div class=FileNav><a href="#File1">&#x2190;</a></div><h4 class=FileName>/home/zhh/projects/bitcoin-0.21.1/src/fs.cpp</h4>
<div class=FileNav><a href="#File3">&#x2192;</a></div></div>
<table class="code" data-fileid="111637">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='comment'>// Copyright (c) 2017-2019 The Bitcoin Core developers</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"><span class='comment'>// Distributed under the MIT software license, see the accompanying</span></td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line"><span class='comment'>// file COPYING or http://www.opensource.org/licenses/mit-license.php.</span></td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line"><span class='directive'>#include &lt;fs.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line"><span class='directive'>#ifndef WIN32</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"><span class='directive'>#include &lt;cstring&gt;</span></td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"><span class='directive'>#include &lt;fcntl.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"><span class='directive'>#include &lt;string&gt;</span></td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"><span class='directive'>#include &lt;sys/file.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"><span class='directive'>#include &lt;sys/utsname.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"><span class='directive'>#include &lt;unistd.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line"><span class='directive'>#ifndef NOMINMAX</span></td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line"><span class='directive'>#define NOMINMAX</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line"><span class='directive'>#include &lt;codecvt&gt;</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"><span class='directive'>#include &lt;windows.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line"><span class='keyword'>namespace</span> fsbridge {</td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line">FILE *fopen(<span class='keyword'>const</span> fs::path&amp; p, <span class='keyword'>const</span> <span class='keyword'>char</span> *mode)</td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line"><span class='directive'>#ifndef WIN32</span></td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line">    <span class='keyword'>return</span> <span class="mrange">::fopen(p.string().c_str(), mode)</span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path4" class="msg msgEvent" style="margin-left:12ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">4</div></td><td><div class="PathNav"><a href="#Path3" title="Previous event (3)">&#x2190;</a></div></td><td>Stream opened here</td><td><div class="PathNav"><a href="#Path5" title="Next event (5)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line">    std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;<span class='keyword'>wchar_t</span>&gt;,<span class='keyword'>wchar_t</span>&gt; utf8_cvt;</td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line">    <span class='keyword'>return</span> ::_wfopen(p.wstring().c_str(), utf8_cvt.from_bytes(mode).c_str());</td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"><span class='directive'>#ifndef WIN32</span></td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line"><span class='keyword'>static</span> std::string GetErrorReason()</td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line">    <span class='keyword'>return</span> std::strerror(<span class='macro'>errno<span class='macro_popup'>(*__errno_location ())</span></span>);</td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line">FileLock::FileLock(<span class='keyword'>const</span> fs::path&amp; file)</td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line">    fd = open(file.string().c_str(), O_RDWR);</td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line">    <span class='keyword'>if</span> (fd == -1) {</td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line">        reason = GetErrorReason();</td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line">FileLock::~FileLock()</td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line">    <span class='keyword'>if</span> (fd != -1) {</td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line">        close(fd);</td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>bool</span> IsWSL()</td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line">    <span class='keyword'>struct</span> utsname uname_data;</td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line">    <span class='keyword'>return</span> uname(&amp;uname_data) == 0 &amp;&amp; std::string(uname_data.version).find(<span class='string_literal'>"Microsoft"</span>) != std::string::npos;</td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line"><span class='keyword'>bool</span> FileLock::TryLock()</td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line">    <span class='keyword'>if</span> (fd == -1) {</td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line">        <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line">    <span class='comment'>// Exclusive file locking is broken on WSL using fcntl (issue #18622)</span></td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line">    <span class='comment'>// This workaround can be removed once the bug on WSL is fixed</span></td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>bool</span> is_wsl = IsWSL();</td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line">    <span class='keyword'>if</span> (is_wsl) {</td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line">        <span class='keyword'>if</span> (flock(fd, LOCK_EX | LOCK_NB) == -1) {</td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line">            reason = GetErrorReason();</td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line">            <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line">        <span class='keyword'>struct</span> flock lock;</td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line">        lock.l_type = F_WRLCK;</td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line">        lock.l_whence = <span class='macro'>SEEK_SET<span class='macro_popup'>0</span></span>;</td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line">        lock.l_start = 0;</td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line">        lock.l_len = 0;</td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line">        <span class='keyword'>if</span> (fcntl(fd, F_SETLK, &amp;lock) == -1) {</td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line">            reason = GetErrorReason();</td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line">            <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line"><span class='keyword'>static</span> std::string GetErrorReason() {</td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line">    <span class='keyword'>wchar_t</span>* err;</td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line">    FormatMessageW(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,</td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line">        <span class='keyword'>nullptr</span>, GetLastError(), MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), <span class='keyword'>reinterpret_cast</span>&lt;WCHAR*&gt;(&amp;err), 0, <span class='keyword'>nullptr</span>);</td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line">    std::wstring err_str(err);</td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line">    LocalFree(err);</td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line">    <span class='keyword'>return</span> std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;<span class='keyword'>wchar_t</span>&gt;&gt;().to_bytes(err_str);</td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line">FileLock::FileLock(<span class='keyword'>const</span> fs::path&amp; file)</td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line">    hFile = CreateFileW(file.wstring().c_str(),  GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE | FILE_SHARE_DELETE,</td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line">        <span class='keyword'>nullptr</span>, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, <span class='keyword'>nullptr</span>);</td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line">    <span class='keyword'>if</span> (hFile == INVALID_HANDLE_VALUE) {</td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line">        reason = GetErrorReason();</td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line">FileLock::~FileLock()</td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line">    <span class='keyword'>if</span> (hFile != INVALID_HANDLE_VALUE) {</td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line">        CloseHandle(hFile);</td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line"><span class='keyword'>bool</span> FileLock::TryLock()</td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line">    <span class='keyword'>if</span> (hFile == INVALID_HANDLE_VALUE) {</td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line">        <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line">    _OVERLAPPED overlapped = {0};</td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line">    <span class='keyword'>if</span> (!LockFileEx(hFile, LOCKFILE_EXCLUSIVE_LOCK | LOCKFILE_FAIL_IMMEDIATELY, 0, std::numeric_limits&lt;DWORD&gt;::max(), std::numeric_limits&lt;DWORD&gt;::max(), &amp;overlapped)) {</td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line">        reason = GetErrorReason();</td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line">        <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line">std::string get_filesystem_error_message(<span class='keyword'>const</span> fs::filesystem_error&amp; e)</td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line"><span class='directive'>#ifndef WIN32</span></td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line">    <span class='keyword'>return</span> e.what();</td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line">    <span class='comment'>// Convert from Multi Byte to utf-16</span></td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line">    std::string mb_string(e.what());</td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line">    <span class='keyword'>int</span> size = MultiByteToWideChar(CP_ACP, 0, mb_string.data(), mb_string.size(), <span class='keyword'>nullptr</span>, 0);</td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line">    std::wstring utf16_string(size, L'\0');</td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line">    MultiByteToWideChar(CP_ACP, 0, mb_string.data(), mb_string.size(), &amp;*utf16_string.begin(), size);</td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line">    <span class='comment'>// Convert from utf-16 to utf-8</span></td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line">    <span class='keyword'>return</span> std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;<span class='keyword'>wchar_t</span>&gt;, <span class='keyword'>wchar_t</span>&gt;().to_bytes(utf16_string);</td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line"><span class='directive'>#ifdef WIN32</span></td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line"><span class='directive'>#ifdef <span class='macro'>__GLIBCXX__<span class='macro_popup'>20200808</span></span></span></td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line"><span class='comment'>// reference: https://github.com/gcc-mirror/gcc/blob/gcc-7_3_0-release/libstdc%2B%2B-v3/include/std/fstream#L270</span></td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line"><span class='keyword'>static</span> std::string openmodeToStr(std::ios_base::openmode mode)</td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line">    <span class='keyword'>switch</span> (mode &amp; ~std::ios_base::ate) {</td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line">    <span class='keyword'>case</span> std::ios_base::out:</td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line">    <span class='keyword'>case</span> std::ios_base::out | std::ios_base::trunc:</td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"w"</span>;</td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line">    <span class='keyword'>case</span> std::ios_base::out | std::ios_base::app:</td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line">    <span class='keyword'>case</span> std::ios_base::app:</td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"a"</span>;</td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in:</td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"r"</span>;</td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::out:</td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"r+"</span>;</td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::out | std::ios_base::trunc:</td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"w+"</span>;</td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::out | std::ios_base::app:</td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::app:</td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"a+"</span>;</td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line">    <span class='keyword'>case</span> std::ios_base::out | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line">    <span class='keyword'>case</span> std::ios_base::out | std::ios_base::trunc | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"wb"</span>;</td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line">    <span class='keyword'>case</span> std::ios_base::out | std::ios_base::app | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line">    <span class='keyword'>case</span> std::ios_base::app | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"ab"</span>;</td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"rb"</span>;</td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::out | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"r+b"</span>;</td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::out | std::ios_base::trunc | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"w+b"</span>;</td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::out | std::ios_base::app | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line">    <span class='keyword'>case</span> std::ios_base::in | std::ios_base::app | std::ios_base::binary:</td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line">        <span class='keyword'>return</span> <span class='string_literal'>"a+b"</span>;</td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line">    <span class='keyword'>default</span>:</td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line">        <span class='keyword'>return</span> std::string();</td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="190"><td class="num" id="LN190">190</td><td class="line"><span class='keyword'>void</span> ifstream::open(<span class='keyword'>const</span> fs::path&amp; p, std::ios_base::openmode mode)</td></tr>
<tr class="codeline" data-linenumber="191"><td class="num" id="LN191">191</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="192"><td class="num" id="LN192">192</td><td class="line">    close();</td></tr>
<tr class="codeline" data-linenumber="193"><td class="num" id="LN193">193</td><td class="line">    mode |= std::ios_base::in;</td></tr>
<tr class="codeline" data-linenumber="194"><td class="num" id="LN194">194</td><td class="line">    m_file = fsbridge::fopen(p, openmodeToStr(mode).c_str());</td></tr>
<tr class="codeline" data-linenumber="195"><td class="num" id="LN195">195</td><td class="line">    <span class='keyword'>if</span> (m_file == <span class='keyword'>nullptr</span>) {</td></tr>
<tr class="codeline" data-linenumber="196"><td class="num" id="LN196">196</td><td class="line">        <span class='keyword'>return</span>;</td></tr>
<tr class="codeline" data-linenumber="197"><td class="num" id="LN197">197</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="198"><td class="num" id="LN198">198</td><td class="line">    m_filebuf = __gnu_cxx::stdio_filebuf&lt;<span class='keyword'>char</span>&gt;(m_file, mode);</td></tr>
<tr class="codeline" data-linenumber="199"><td class="num" id="LN199">199</td><td class="line">    rdbuf(&amp;m_filebuf);</td></tr>
<tr class="codeline" data-linenumber="200"><td class="num" id="LN200">200</td><td class="line">    <span class='keyword'>if</span> (mode &amp; std::ios_base::ate) {</td></tr>
<tr class="codeline" data-linenumber="201"><td class="num" id="LN201">201</td><td class="line">        seekg(0, std::ios_base::end);</td></tr>
<tr class="codeline" data-linenumber="202"><td class="num" id="LN202">202</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="203"><td class="num" id="LN203">203</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="204"><td class="num" id="LN204">204</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="205"><td class="num" id="LN205">205</td><td class="line"><span class='keyword'>void</span> ifstream::close()</td></tr>
<tr class="codeline" data-linenumber="206"><td class="num" id="LN206">206</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="207"><td class="num" id="LN207">207</td><td class="line">    <span class='keyword'>if</span> (m_file != <span class='keyword'>nullptr</span>) {</td></tr>
<tr class="codeline" data-linenumber="208"><td class="num" id="LN208">208</td><td class="line">        m_filebuf.close();</td></tr>
<tr class="codeline" data-linenumber="209"><td class="num" id="LN209">209</td><td class="line">        fclose(m_file);</td></tr>
<tr class="codeline" data-linenumber="210"><td class="num" id="LN210">210</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="211"><td class="num" id="LN211">211</td><td class="line">    m_file = <span class='keyword'>nullptr</span>;</td></tr>
<tr class="codeline" data-linenumber="212"><td class="num" id="LN212">212</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="213"><td class="num" id="LN213">213</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="214"><td class="num" id="LN214">214</td><td class="line"><span class='keyword'>void</span> ofstream::open(<span class='keyword'>const</span> fs::path&amp; p, std::ios_base::openmode mode)</td></tr>
<tr class="codeline" data-linenumber="215"><td class="num" id="LN215">215</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="216"><td class="num" id="LN216">216</td><td class="line">    close();</td></tr>
<tr class="codeline" data-linenumber="217"><td class="num" id="LN217">217</td><td class="line">    mode |= std::ios_base::out;</td></tr>
<tr class="codeline" data-linenumber="218"><td class="num" id="LN218">218</td><td class="line">    m_file = fsbridge::fopen(p, openmodeToStr(mode).c_str());</td></tr>
<tr class="codeline" data-linenumber="219"><td class="num" id="LN219">219</td><td class="line">    <span class='keyword'>if</span> (m_file == <span class='keyword'>nullptr</span>) {</td></tr>
<tr class="codeline" data-linenumber="220"><td class="num" id="LN220">220</td><td class="line">        <span class='keyword'>return</span>;</td></tr>
<tr class="codeline" data-linenumber="221"><td class="num" id="LN221">221</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="222"><td class="num" id="LN222">222</td><td class="line">    m_filebuf = __gnu_cxx::stdio_filebuf&lt;<span class='keyword'>char</span>&gt;(m_file, mode);</td></tr>
<tr class="codeline" data-linenumber="223"><td class="num" id="LN223">223</td><td class="line">    rdbuf(&amp;m_filebuf);</td></tr>
<tr class="codeline" data-linenumber="224"><td class="num" id="LN224">224</td><td class="line">    <span class='keyword'>if</span> (mode &amp; std::ios_base::ate) {</td></tr>
<tr class="codeline" data-linenumber="225"><td class="num" id="LN225">225</td><td class="line">        seekp(0, std::ios_base::end);</td></tr>
<tr class="codeline" data-linenumber="226"><td class="num" id="LN226">226</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="227"><td class="num" id="LN227">227</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="228"><td class="num" id="LN228">228</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="229"><td class="num" id="LN229">229</td><td class="line"><span class='keyword'>void</span> ofstream::close()</td></tr>
<tr class="codeline" data-linenumber="230"><td class="num" id="LN230">230</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="231"><td class="num" id="LN231">231</td><td class="line">    <span class='keyword'>if</span> (m_file != <span class='keyword'>nullptr</span>) {</td></tr>
<tr class="codeline" data-linenumber="232"><td class="num" id="LN232">232</td><td class="line">        m_filebuf.close();</td></tr>
<tr class="codeline" data-linenumber="233"><td class="num" id="LN233">233</td><td class="line">        fclose(m_file);</td></tr>
<tr class="codeline" data-linenumber="234"><td class="num" id="LN234">234</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="235"><td class="num" id="LN235">235</td><td class="line">    m_file = <span class='keyword'>nullptr</span>;</td></tr>
<tr class="codeline" data-linenumber="236"><td class="num" id="LN236">236</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="237"><td class="num" id="LN237">237</td><td class="line"><span class='directive'>#else // __GLIBCXX__</span></td></tr>
<tr class="codeline" data-linenumber="238"><td class="num" id="LN238">238</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="239"><td class="num" id="LN239">239</td><td class="line"><span class='keyword'>static_assert</span>(<span class='keyword'>sizeof</span>(*fs::path().<span class='macro'>BOOST_FILESYSTEM_C_STR<span class='macro_popup'>c_str()</span></span>) == <span class='keyword'>sizeof</span>(<span class='keyword'>wchar_t</span>),</td></tr>
<tr class="codeline" data-linenumber="240"><td class="num" id="LN240">240</td><td class="line">    <span class='string_literal'>"Warning: This build is using boost::filesystem ofstream and ifstream "</span></td></tr>
<tr class="codeline" data-linenumber="241"><td class="num" id="LN241">241</td><td class="line">    <span class='string_literal'>"implementations which will fail to open paths containing multibyte "</span></td></tr>
<tr class="codeline" data-linenumber="242"><td class="num" id="LN242">242</td><td class="line">    <span class='string_literal'>"characters. You should delete this static_assert to ignore this warning, "</span></td></tr>
<tr class="codeline" data-linenumber="243"><td class="num" id="LN243">243</td><td class="line">    <span class='string_literal'>"or switch to a different C++ standard library like the Microsoft C++ "</span></td></tr>
<tr class="codeline" data-linenumber="244"><td class="num" id="LN244">244</td><td class="line">    <span class='string_literal'>"Standard Library (where boost uses non-standard extensions to construct "</span></td></tr>
<tr class="codeline" data-linenumber="245"><td class="num" id="LN245">245</td><td class="line">    <span class='string_literal'>"stream objects with wide filenames), or the GNU libstdc++ library (where "</span></td></tr>
<tr class="codeline" data-linenumber="246"><td class="num" id="LN246">246</td><td class="line">    <span class='string_literal'>"a more complicated workaround has been implemented above)."</span>);</td></tr>
<tr class="codeline" data-linenumber="247"><td class="num" id="LN247">247</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="248"><td class="num" id="LN248">248</td><td class="line"><span class='directive'>#endif // __GLIBCXX__</span></td></tr>
<tr class="codeline" data-linenumber="249"><td class="num" id="LN249">249</td><td class="line"><span class='directive'>#endif // WIN32</span></td></tr>
<tr class="codeline" data-linenumber="250"><td class="num" id="LN250">250</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="251"><td class="num" id="LN251">251</td><td class="line">} <span class='comment'>// fsbridge</span></td></tr>
</table><hr class=divider>
<div id=File3>
<div class=FileNav><a href="#File111637">&#x2190;</a></div><h4 class=FileName>./logging.h</h4>
<div class=FileNav><a href="#File111450">&#x2192;</a></div></div>
<table class="code" data-fileid="3">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='comment'>// Copyright (c) 2009-2010 Satoshi Nakamoto</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"><span class='comment'>// Copyright (c) 2009-2020 The Bitcoin Core developers</span></td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line"><span class='comment'>// Distributed under the MIT software license, see the accompanying</span></td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"><span class='comment'>// file COPYING or http://www.opensource.org/licenses/mit-license.php.</span></td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line"><span class='directive'>#ifndef BITCOIN_LOGGING_H</span></td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line"><span class='directive'>#define BITCOIN_LOGGING_H</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"><span class='directive'>#include &lt;fs.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"><span class='directive'>#include &lt;tinyformat.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"><span class='directive'>#include &lt;threadsafety.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"><span class='directive'>#include &lt;util/string.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line"><span class='directive'>#include &lt;atomic&gt;</span></td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line"><span class='directive'>#include &lt;cstdint&gt;</span></td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line"><span class='directive'>#include &lt;list&gt;</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line"><span class='directive'>#include &lt;mutex&gt;</span></td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line"><span class='directive'>#include &lt;string&gt;</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"><span class='directive'>#include &lt;vector&gt;</span></td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>bool</span> DEFAULT_LOGTIMEMICROS = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>bool</span> DEFAULT_LOGIPS        = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>bool</span> DEFAULT_LOGTIMESTAMPS = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>bool</span> DEFAULT_LOGTHREADNAMES = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> * <span class='keyword'>const</span> DEFAULT_DEBUGLOGFILE;</td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>bool</span> fLogIPs;</td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line"><span class='keyword'>struct</span> LogCategory {</td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line">    std::string category;</td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line">    <span class='keyword'>bool</span> active;</td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"><span class='keyword'>namespace</span> BCLog {</td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line">    <span class='keyword'>enum</span> LogFlags : uint32_t {</td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line">        NONE        = 0,</td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line">        NET         = (1 &lt;&lt;  0),</td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line">        TOR         = (1 &lt;&lt;  1),</td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line">        MEMPOOL     = (1 &lt;&lt;  2),</td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line">        HTTP        = (1 &lt;&lt;  3),</td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line">        BENCH       = (1 &lt;&lt;  4),</td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line">        ZMQ         = (1 &lt;&lt;  5),</td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line">        WALLETDB    = (1 &lt;&lt;  6),</td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line">        RPC         = (1 &lt;&lt;  7),</td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line">        ESTIMATEFEE = (1 &lt;&lt;  8),</td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line">        ADDRMAN     = (1 &lt;&lt;  9),</td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line">        SELECTCOINS = (1 &lt;&lt; 10),</td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line">        REINDEX     = (1 &lt;&lt; 11),</td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line">        CMPCTBLOCK  = (1 &lt;&lt; 12),</td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line">        RAND        = (1 &lt;&lt; 13),</td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line">        PRUNE       = (1 &lt;&lt; 14),</td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line">        PROXY       = (1 &lt;&lt; 15),</td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line">        MEMPOOLREJ  = (1 &lt;&lt; 16),</td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line">        LIBEVENT    = (1 &lt;&lt; 17),</td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line">        COINDB      = (1 &lt;&lt; 18),</td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line">        QT          = (1 &lt;&lt; 19),</td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line">        LEVELDB     = (1 &lt;&lt; 20),</td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line">        VALIDATION  = (1 &lt;&lt; 21),</td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line">        ALL         = ~(uint32_t)0,</td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line">    };</td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line">    <span class='keyword'>class</span> Logger</td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line">    <span class='keyword'>private</span>:</td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line">        <span class='keyword'>mutable</span> StdMutex m_cs; <span class='comment'>// Can not use Mutex from sync.h because in debug mode it would cause a deadlock when a potential deadlock was detected</span></td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line">        FILE* m_fileout <span class='macro'>GUARDED_BY(m_cs)<span class='macro_popup'>__attribute__((guarded_by(m_cs)))</span></span> = <span class='keyword'>nullptr</span>;</td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line">        std::list&lt;std::string&gt; m_msgs_before_open <span class='macro'>GUARDED_BY(m_cs)<span class='macro_popup'>__attribute__((guarded_by(m_cs)))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line">        <span class='keyword'>bool</span> m_buffering <span class='macro'>GUARDED_BY(m_cs)<span class='macro_popup'>__attribute__((guarded_by(m_cs)))</span></span> = <span class='keyword'>true</span>; <span class='comment'>//!&lt; Buffer messages before logging can be started.</span></td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line">        <span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line">         <span class='comment'>* m_started_new_line is a state variable that will suppress printing of</span></td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line">         <span class='comment'>* the timestamp when multiple calls are made that don't end in a</span></td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line">         <span class='comment'>* newline.</span></td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line">         <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line">        std::atomic_bool m_started_new_line{<span class='keyword'>true</span>};</td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line">        <span class='comment'>/** Log categories bitfield. */</span></td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line">        std::atomic&lt;uint32_t&gt; m_categories{0};</td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line">        std::string LogTimestampStr(<span class='keyword'>const</span> std::string&amp; str);</td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line">        <span class='comment'>/** Slots that connect to the print signal */</span></td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line">        std::list&lt;std::function&lt;<span class='keyword'>void</span>(<span class='keyword'>const</span> std::string&amp;)&gt;&gt; m_print_callbacks <span class='macro'>GUARDED_BY(m_cs)<span class='macro_popup'>__attribute__((guarded_by(m_cs)))</span></span> {};</td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line">    <span class='keyword'>public</span>:</td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line">        <span class='keyword'>bool</span> m_print_to_console = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line">        <span class='keyword'>bool</span> m_print_to_file = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line">        <span class='keyword'>bool</span> m_log_timestamps = DEFAULT_LOGTIMESTAMPS;</td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line">        <span class='keyword'>bool</span> m_log_time_micros = DEFAULT_LOGTIMEMICROS;</td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line">        <span class='keyword'>bool</span> m_log_threadnames = DEFAULT_LOGTHREADNAMES;</td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line">        fs::path m_file_path;</td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line">        std::atomic&lt;<span class='keyword'>bool</span>&gt; m_reopen_file{<span class='keyword'>false</span>};</td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line">        <span class='comment'>/** Send a string to the log output */</span></td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line">        <span class='keyword'>void</span> LogPrintStr(<span class='keyword'>const</span> std::string&amp; str);</td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line">        <span class='comment'>/** Returns whether logs will be written to any output */</span></td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line">        <span class='keyword'>bool</span> Enabled() <span class='keyword'>const</span></td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line">            StdLockGuard scoped_lock(m_cs);</td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line">            <span class='keyword'>return</span> m_buffering || m_print_to_console || m_print_to_file || !m_print_callbacks.empty();</td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line">        <span class='comment'>/** Connect a slot to the print signal and return the connection */</span></td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line">        std::list&lt;std::function&lt;<span class='keyword'>void</span>(<span class='keyword'>const</span> std::string&amp;)&gt;&gt;::iterator PushBackCallback(std::function&lt;<span class='keyword'>void</span>(<span class='keyword'>const</span> std::string&amp;)&gt; fun)</td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line">            StdLockGuard scoped_lock(m_cs);</td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line">            m_print_callbacks.push_back(std::move(fun));</td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line">            <span class='keyword'>return</span> --m_print_callbacks.end();</td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line">        <span class='comment'>/** Delete a connection */</span></td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line">        <span class='keyword'>void</span> DeleteCallback(std::list&lt;std::function&lt;<span class='keyword'>void</span>(<span class='keyword'>const</span> std::string&amp;)&gt;&gt;::iterator it)</td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line">            StdLockGuard scoped_lock(m_cs);</td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line">            m_print_callbacks.erase(it);</td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line">        <span class='comment'>/** Start logging (and flush all buffered messages) */</span></td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line">        <span class='keyword'>bool</span> StartLogging();</td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line">        <span class='comment'>/** Only for testing */</span></td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line">        <span class='keyword'>void</span> DisconnectTestLogger();</td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line">        <span class='keyword'>void</span> ShrinkDebugFile();</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line">        uint32_t GetCategoryMask() <span class='keyword'>const</span> { <span class='keyword'>return</span> m_categories.load(); }</td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line">        <span class='keyword'>void</span> EnableCategory(LogFlags flag);</td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line">        <span class='keyword'>bool</span> EnableCategory(<span class='keyword'>const</span> std::string&amp; str);</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line">        <span class='keyword'>void</span> DisableCategory(LogFlags flag);</td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line">        <span class='keyword'>bool</span> DisableCategory(<span class='keyword'>const</span> std::string&amp; str);</td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line">        <span class='keyword'>bool</span> WillLogCategory(LogFlags category) <span class='keyword'>const</span>;</td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line">        <span class='comment'>/** Returns a vector of the log categories */</span></td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line">        std::vector&lt;LogCategory&gt; LogCategoriesList();</td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line">        <span class='comment'>/** Returns a string with the log categories */</span></td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line">        std::string LogCategoriesString()</td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line">            <span class='keyword'>return</span> Join(LogCategoriesList(), <span class='string_literal'>", "</span>, [&amp;](<span class='keyword'>const</span> LogCategory&amp; i) { <span class='keyword'>return</span> i.category; });</td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line">        };</td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line">        <span class='keyword'>bool</span> DefaultShrinkDebugFile() <span class='keyword'>const</span>;</td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line">    };</td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line">} <span class='comment'>// namespace BCLog</span></td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line">BCLog::Logger&amp; LogInstance();</td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line"><span class='comment'>/** Return true if log accepts specified category */</span></td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>bool</span> LogAcceptCategory(BCLog::LogFlags category)</td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line">    <span class='keyword'>return</span> LogInstance().WillLogCategory(category);</td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line"><span class='comment'>/** Return true if str parses as a log category and set the flag */</span></td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line"><span class='keyword'>bool</span> GetLogCategory(BCLog::LogFlags&amp; flag, <span class='keyword'>const</span> std::string&amp; str);</td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line"><span class='comment'>// Be conservative when using LogPrintf/error or other things which</span></td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line"><span class='comment'>// unconditionally log to debug.log! It should not be the case that an inbound</span></td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line"><span class='comment'>// peer can fill up a user's disk with debug.log entries.</span></td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line"><span class='keyword'>template</span> &lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> LogPrintf(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt, <span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line">    <span class='keyword'>if</span> (LogInstance().Enabled()) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path10" class="msg msgControl" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">10</div></td><td><div class="PathNav"><a href="#Path9" title="Previous event (9)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#Path11" title="Next event (11)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line">        std::string log_msg;</td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line">        <span class='keyword'>try</span> {</td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line">            log_msg = tfm::format(fmt, args...);</td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line">        } <span class='keyword'>catch</span> (tinyformat::format_error&amp; fmterr) {</td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line">            <span class='comment'>/* Original format string will have newline so don't add one here */</span></td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line">            log_msg = <span class='string_literal'>"Error \""</span> + std::string(fmterr.what()) + <span class='string_literal'>"\" while formatting log message: "</span> + fmt;</td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line">        <span class="mrange"><span class="mrange">LogInstance().LogPrintStr(log_msg)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path11" class="msg msgEvent" style="margin-left:9ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">11</div></td><td><div class="PathNav"><a href="#Path10" title="Previous event (10)">&#x2190;</a></div></td><td>Calling 'Logger::LogPrintStr'</td><td><div class="PathNav"><a href="#Path12" title="Next event (12)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path29" class="msg msgEvent" style="margin-left:9ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">29</div></td><td><div class="PathNav"><a href="#Path28" title="Previous event (28)">&#x2190;</a></div></td><td>Returning from 'Logger::LogPrintStr'</td><td><div class="PathNav"><a href="#Path30" title="Next event (30)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line"><span class='comment'>// Use a macro instead of a function for conditional logging to prevent</span></td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line"><span class='comment'>// evaluating arguments when logging for the category is not enabled.</span></td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line"><span class='directive'>#define <span class='macro'>LogPrint(category, ...)<span class='macro_popup'>do { if (LogAcceptCategory((category))) { LogPrintf(...); } }<br> while (0)</span></span>              \</span></td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line">    <span class='directive'>do {                                     \</span></td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line">        <span class='directive'>if (LogAcceptCategory((category))) { \</span></td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line">            <span class='directive'>LogPrintf(__VA_ARGS__);          \</span></td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line">        <span class='directive'>}                                    \</span></td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line">    <span class='directive'>} while (0)</span></td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line"><span class='directive'>#endif // BITCOIN_LOGGING_H</span></td></tr>
</table><hr class=divider>
<div id=File111450>
<div class=FileNav><a href="#File3">&#x2190;</a></div><h4 class=FileName>/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h</h4>
</div>
<table class="code" data-fileid="111450">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='comment'>// tinyformat.h</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"><span class='comment'>// Copyright (C) 2011, Chris Foster [chris42f (at) gmail (d0t) com]</span></td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"><span class='comment'>// Boost Software License - Version 1.0</span></td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line"><span class='comment'>// Permission is hereby granted, free of charge, to any person or organization</span></td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line"><span class='comment'>// obtaining a copy of the software and accompanying documentation covered by</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"><span class='comment'>// this license (the "Software") to use, reproduce, display, distribute,</span></td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"><span class='comment'>// execute, and transmit the Software, and to prepare derivative works of the</span></td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"><span class='comment'>// Software, and to permit third-parties to whom the Software is furnished to</span></td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"><span class='comment'>// do so, all subject to the following:</span></td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"><span class='comment'>// The copyright notices in the Software and this entire statement, including</span></td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line"><span class='comment'>// the above license grant, this restriction and the following disclaimer,</span></td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line"><span class='comment'>// must be included in all copies of the Software, in whole or in part, and</span></td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line"><span class='comment'>// all derivative works of the Software, unless such copies or derivative</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line"><span class='comment'>// works are solely in the form of machine-executable object code generated by</span></td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line"><span class='comment'>// a source language processor.</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"><span class='comment'>// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"><span class='comment'>// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line"><span class='comment'>// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT</span></td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line"><span class='comment'>// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE</span></td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line"><span class='comment'>// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,</span></td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line"><span class='comment'>// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span></td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line"><span class='comment'>// DEALINGS IN THE SOFTWARE.</span></td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line"><span class='comment'>// Tinyformat: A minimal type safe printf replacement</span></td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line"><span class='comment'>// tinyformat.h is a type safe printf replacement library in a single C++</span></td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line"><span class='comment'>// header file.  Design goals include:</span></td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"><span class='comment'>// * Type safety and extensibility for user defined types.</span></td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line"><span class='comment'>// * C99 printf() compatibility, to the extent possible using std::ostream</span></td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line"><span class='comment'>// * POSIX extension for positional arguments</span></td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line"><span class='comment'>// * Simplicity and minimalism.  A single header file to include and distribute</span></td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line"><span class='comment'>//   with your projects.</span></td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line"><span class='comment'>// * Augment rather than replace the standard stream formatting mechanism</span></td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line"><span class='comment'>// * C++98 support, with optional C++11 niceties</span></td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line"><span class='comment'>// Main interface example usage</span></td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line"><span class='comment'>// ----------------------------</span></td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line"><span class='comment'>// To print a date to std::cout for American usage:</span></td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line"><span class='comment'>//   std::string weekday = "Wednesday";</span></td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line"><span class='comment'>//   const char* month = "July";</span></td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line"><span class='comment'>//   size_t day = 27;</span></td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line"><span class='comment'>//   long hour = 14;</span></td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line"><span class='comment'>//   int min = 44;</span></td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line"><span class='comment'>//   tfm::printf("%s, %s %d, %.2d:%.2d\n", weekday, month, day, hour, min);</span></td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line"><span class='comment'>// POSIX extension for positional arguments is available.</span></td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line"><span class='comment'>// The ability to rearrange formatting arguments is an important feature</span></td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line"><span class='comment'>// for localization because the word order may vary in different languages.</span></td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line"><span class='comment'>// Previous example for German usage. Arguments are reordered:</span></td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line"><span class='comment'>//   tfm::printf("%1$s, %3$d. %2$s, %4$d:%5$.2d\n", weekday, month, day, hour, min);</span></td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line"><span class='comment'>// The strange types here emphasize the type safety of the interface; it is</span></td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line"><span class='comment'>// possible to print a std::string using the "%s" conversion, and a</span></td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line"><span class='comment'>// size_t using the "%d" conversion.  A similar result could be achieved</span></td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line"><span class='comment'>// using either of the tfm::format() functions.  One prints on a user provided</span></td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line"><span class='comment'>// stream:</span></td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line"><span class='comment'>//   tfm::format(std::cerr, "%s, %s %d, %.2d:%.2d\n",</span></td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line"><span class='comment'>//               weekday, month, day, hour, min);</span></td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line"><span class='comment'>// The other returns a std::string:</span></td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line"><span class='comment'>//   std::string date = tfm::format("%s, %s %d, %.2d:%.2d\n",</span></td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line"><span class='comment'>//                                  weekday, month, day, hour, min);</span></td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line"><span class='comment'>//   std::cout &lt;&lt; date;</span></td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line"><span class='comment'>// These are the three primary interface functions.  There is also a</span></td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line"><span class='comment'>// convenience function printfln() which appends a newline to the usual result</span></td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line"><span class='comment'>// of printf() for super simple logging.</span></td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line"><span class='comment'>// User defined format functions</span></td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line"><span class='comment'>// -----------------------------</span></td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line"><span class='comment'>// Simulating variadic templates in C++98 is pretty painful since it requires</span></td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line"><span class='comment'>// writing out the same function for each desired number of arguments.  To make</span></td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line"><span class='comment'>// this bearable tinyformat comes with a set of macros which are used</span></td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line"><span class='comment'>// internally to generate the API, but which may also be used in user code.</span></td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line"><span class='comment'>// The three macros TINYFORMAT_ARGTYPES(n), TINYFORMAT_VARARGS(n) and</span></td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line"><span class='comment'>// TINYFORMAT_PASSARGS(n) will generate a list of n argument types,</span></td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line"><span class='comment'>// type/name pairs and argument names respectively when called with an integer</span></td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line"><span class='comment'>// n between 1 and 16.  We can use these to define a macro which generates the</span></td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line"><span class='comment'>// desired user defined function with n arguments.  To generate all 16 user</span></td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line"><span class='comment'>// defined function bodies, use the macro TINYFORMAT_FOREACH_ARGNUM.  For an</span></td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line"><span class='comment'>// example, see the implementation of printf() at the end of the source file.</span></td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line"><span class='comment'>// Sometimes it's useful to be able to pass a list of format arguments through</span></td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line"><span class='comment'>// to a non-template function.  The FormatList class is provided as a way to do</span></td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line"><span class='comment'>// this by storing the argument list in a type-opaque way.  Continuing the</span></td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line"><span class='comment'>// example from above, we construct a FormatList using makeFormatList():</span></td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line"><span class='comment'>//   FormatListRef formatList = tfm::makeFormatList(weekday, month, day, hour, min);</span></td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line"><span class='comment'>// The format list can now be passed into any non-template function and used</span></td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line"><span class='comment'>// via a call to the vformat() function:</span></td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line"><span class='comment'>//   tfm::vformat(std::cout, "%s, %s %d, %.2d:%.2d\n", formatList);</span></td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line"><span class='comment'>// Additional API information</span></td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line"><span class='comment'>// --------------------------</span></td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line"><span class='comment'>// Error handling: Define TINYFORMAT_ERROR to customize the error handling for</span></td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line"><span class='comment'>// format strings which are unsupported or have the wrong number of format</span></td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line"><span class='comment'>// specifiers (calls assert() by default).</span></td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line"><span class='comment'>// User defined types: Uses operator&lt;&lt; for user defined types by default.</span></td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line"><span class='comment'>// Overload formatValue() for more control.</span></td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line"><span class='directive'>#ifndef TINYFORMAT_H_INCLUDED</span></td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line"><span class='directive'>#define TINYFORMAT_H_INCLUDED</span></td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line"><span class='keyword'>namespace</span> tinyformat {}</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line"><span class='comment'>// Config section.  Customize to your liking!</span></td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line"><span class='comment'>// Namespace alias to encourage brevity</span></td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line"><span class='keyword'>namespace</span> tfm = tinyformat;</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line"><span class='comment'>// Error handling; calls assert() by default.</span></td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ERROR(reasonString)<span class='macro_popup'>throw tinyformat::format_error(reasonString)</span></span> throw tinyformat::format_error(reasonString)</span></td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line"><span class='comment'>// Define for C++11 variadic templates which make the code shorter &amp; more</span></td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line"><span class='comment'>// general.  If you don't define this, C++11 support is autodetected below.</span></td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line"><span class='directive'>#define TINYFORMAT_USE_VARIADIC_TEMPLATES</span></td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line"><span class='comment'>// Implementation details.</span></td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line"><span class='directive'>#include &lt;algorithm&gt;</span></td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line"><span class='directive'>#include &lt;iostream&gt;</span></td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line"><span class='directive'>#include &lt;sstream&gt;</span></td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line"><span class='directive'>#include &lt;stdexcept&gt; // Added for Bitcoin Core</span></td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line"><span class='directive'>#ifndef TINYFORMAT_ASSERT</span></td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line"><span class='directive'>#   include &lt;cassert&gt;</span></td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line"><span class='directive'>#   define <span class='macro'>TINYFORMAT_ASSERT(cond)<span class='macro_popup'>(static_cast &lt;bool&gt; (cond) ? void (0) : __assert_fail (<br>"cond", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h",<br> 151, __extension__ __PRETTY_FUNCTION__))</span></span> <span class='macro'>assert(cond)<span class='macro_popup'>(static_cast &lt;bool&gt; (cond) ? void (0) : __assert_fail (<br>"cond", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h",<br> 151, __extension__ __PRETTY_FUNCTION__))</span></span></span></td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line"><span class='directive'>#ifndef TINYFORMAT_ERROR</span></td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line"><span class='directive'>#   include &lt;cassert&gt;</span></td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line"><span class='directive'>#   define <span class='macro'>TINYFORMAT_ERROR(reason)<span class='macro_popup'>throw tinyformat::format_error(reason)</span></span> <span class='macro'>assert(0 &amp;&amp; reason)<span class='macro_popup'>(static_cast &lt;bool&gt; (0 &amp;&amp; reason) ? void (0) : __assert_fail<br> ("0 &amp;&amp; reason", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 156, __extension__ __PRETTY_FUNCTION__))</span></span></span></td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line"><span class='directive'>#if !defined(TINYFORMAT_USE_VARIADIC_TEMPLATES) &amp;&amp; !defined(TINYFORMAT_NO_VARIADIC_TEMPLATES)</span></td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line"><span class='directive'>#   ifdef <span class='macro'>__GXX_EXPERIMENTAL_CXX0X__<span class='macro_popup'>1</span></span></span></td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line"><span class='directive'>#       define TINYFORMAT_USE_VARIADIC_TEMPLATES</span></td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line"><span class='directive'>#   endif</span></td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line"><span class='directive'>#if defined(<span class='macro'>__GLIBCXX__<span class='macro_popup'>20200808</span></span>) &amp;&amp; <span class='macro'>__GLIBCXX__<span class='macro_popup'>20200808</span></span> &lt; 20080201</span></td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line"><span class='comment'>//  std::showpos is broken on old libstdc++ as provided with macOS.  See</span></td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line"><span class='comment'>//  http://gcc.gnu.org/ml/libstdc++/2007-11/msg00075.html</span></td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line"><span class='directive'>#   define TINYFORMAT_OLD_LIBSTDCPLUSPLUS_WORKAROUND</span></td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line"><span class='directive'>#ifdef __APPLE__</span></td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line"><span class='comment'>// Workaround macOS linker warning: Xcode uses different default symbol</span></td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line"><span class='comment'>// visibilities for static libs vs executables (see issue #25)</span></td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line"><span class='directive'>#   define TINYFORMAT_HIDDEN __attribute__((visibility("hidden")))</span></td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line"><span class='directive'>#   define TINYFORMAT_HIDDEN</span></td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line"><span class='keyword'>namespace</span> tinyformat {</td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line"><span class='comment'>// Added for Bitcoin Core</span></td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line"><span class='keyword'>class</span> format_error: <span class='keyword'>public</span> std::runtime_error</td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line"><span class='keyword'>public</span>:</td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line">    <span class='keyword'>explicit</span> format_error(<span class='keyword'>const</span> std::string &amp;what): std::runtime_error(what) {</td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="190"><td class="num" id="LN190">190</td><td class="line"><span class='keyword'>namespace</span> detail {</td></tr>
<tr class="codeline" data-linenumber="191"><td class="num" id="LN191">191</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="192"><td class="num" id="LN192">192</td><td class="line"><span class='comment'>// Test whether type T1 is convertible to type T2</span></td></tr>
<tr class="codeline" data-linenumber="193"><td class="num" id="LN193">193</td><td class="line"><span class='keyword'>template</span> &lt;<span class='keyword'>typename</span> T1, <span class='keyword'>typename</span> T2&gt;</td></tr>
<tr class="codeline" data-linenumber="194"><td class="num" id="LN194">194</td><td class="line"><span class='keyword'>struct</span> is_convertible</td></tr>
<tr class="codeline" data-linenumber="195"><td class="num" id="LN195">195</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="196"><td class="num" id="LN196">196</td><td class="line">    <span class='keyword'>private</span>:</td></tr>
<tr class="codeline" data-linenumber="197"><td class="num" id="LN197">197</td><td class="line">        <span class='comment'>// two types of different size</span></td></tr>
<tr class="codeline" data-linenumber="198"><td class="num" id="LN198">198</td><td class="line">        <span class='keyword'>struct</span> fail { <span class='keyword'>char</span> dummy[2]; };</td></tr>
<tr class="codeline" data-linenumber="199"><td class="num" id="LN199">199</td><td class="line">        <span class='keyword'>struct</span> succeed { <span class='keyword'>char</span> dummy; };</td></tr>
<tr class="codeline" data-linenumber="200"><td class="num" id="LN200">200</td><td class="line">        <span class='comment'>// Try to convert a T1 to a T2 by plugging into tryConvert</span></td></tr>
<tr class="codeline" data-linenumber="201"><td class="num" id="LN201">201</td><td class="line">        <span class='keyword'>static</span> fail tryConvert(...);</td></tr>
<tr class="codeline" data-linenumber="202"><td class="num" id="LN202">202</td><td class="line">        <span class='keyword'>static</span> succeed tryConvert(<span class='keyword'>const</span> T2&amp;);</td></tr>
<tr class="codeline" data-linenumber="203"><td class="num" id="LN203">203</td><td class="line">        <span class='keyword'>static</span> <span class='keyword'>const</span> T1&amp; makeT1();</td></tr>
<tr class="codeline" data-linenumber="204"><td class="num" id="LN204">204</td><td class="line">    <span class='keyword'>public</span>:</td></tr>
<tr class="codeline" data-linenumber="205"><td class="num" id="LN205">205</td><td class="line"><span class='directive'>#       ifdef _MSC_VER</span></td></tr>
<tr class="codeline" data-linenumber="206"><td class="num" id="LN206">206</td><td class="line">        <span class='comment'>// Disable spurious loss of precision warnings in tryConvert(makeT1())</span></td></tr>
<tr class="codeline" data-linenumber="207"><td class="num" id="LN207">207</td><td class="line"><span class='directive'>#       pragma warning(push)</span></td></tr>
<tr class="codeline" data-linenumber="208"><td class="num" id="LN208">208</td><td class="line"><span class='directive'>#       pragma warning(disable:4244)</span></td></tr>
<tr class="codeline" data-linenumber="209"><td class="num" id="LN209">209</td><td class="line"><span class='directive'>#       pragma warning(disable:4267)</span></td></tr>
<tr class="codeline" data-linenumber="210"><td class="num" id="LN210">210</td><td class="line"><span class='directive'>#       endif</span></td></tr>
<tr class="codeline" data-linenumber="211"><td class="num" id="LN211">211</td><td class="line">        <span class='comment'>// Standard trick: the (...) version of tryConvert will be chosen from</span></td></tr>
<tr class="codeline" data-linenumber="212"><td class="num" id="LN212">212</td><td class="line">        <span class='comment'>// the overload set only if the version taking a T2 doesn't match.</span></td></tr>
<tr class="codeline" data-linenumber="213"><td class="num" id="LN213">213</td><td class="line">        <span class='comment'>// Then we compare the sizes of the return types to check which</span></td></tr>
<tr class="codeline" data-linenumber="214"><td class="num" id="LN214">214</td><td class="line">        <span class='comment'>// function matched.  Very neat, in a disgusting kind of way :)</span></td></tr>
<tr class="codeline" data-linenumber="215"><td class="num" id="LN215">215</td><td class="line">        <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>bool</span> value =</td></tr>
<tr class="codeline" data-linenumber="216"><td class="num" id="LN216">216</td><td class="line">            <span class='keyword'>sizeof</span>(tryConvert(makeT1())) == <span class='keyword'>sizeof</span>(succeed);</td></tr>
<tr class="codeline" data-linenumber="217"><td class="num" id="LN217">217</td><td class="line"><span class='directive'>#       ifdef _MSC_VER</span></td></tr>
<tr class="codeline" data-linenumber="218"><td class="num" id="LN218">218</td><td class="line"><span class='directive'>#       pragma warning(pop)</span></td></tr>
<tr class="codeline" data-linenumber="219"><td class="num" id="LN219">219</td><td class="line"><span class='directive'>#       endif</span></td></tr>
<tr class="codeline" data-linenumber="220"><td class="num" id="LN220">220</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="221"><td class="num" id="LN221">221</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="222"><td class="num" id="LN222">222</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="223"><td class="num" id="LN223">223</td><td class="line"><span class='comment'>// Detect when a type is not a wchar_t string</span></td></tr>
<tr class="codeline" data-linenumber="224"><td class="num" id="LN224">224</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt; <span class='keyword'>struct</span> is_wchar { <span class='keyword'>typedef</span> <span class='keyword'>int</span> tinyformat_wchar_is_not_supported; };</td></tr>
<tr class="codeline" data-linenumber="225"><td class="num" id="LN225">225</td><td class="line"><span class='keyword'>template</span>&lt;&gt; <span class='keyword'>struct</span> is_wchar&lt;<span class='keyword'>wchar_t</span>*&gt; {};</td></tr>
<tr class="codeline" data-linenumber="226"><td class="num" id="LN226">226</td><td class="line"><span class='keyword'>template</span>&lt;&gt; <span class='keyword'>struct</span> is_wchar&lt;<span class='keyword'>const</span> <span class='keyword'>wchar_t</span>*&gt; {};</td></tr>
<tr class="codeline" data-linenumber="227"><td class="num" id="LN227">227</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>int</span> n&gt; <span class='keyword'>struct</span> is_wchar&lt;<span class='keyword'>const</span> <span class='keyword'>wchar_t</span>[n]&gt; {};</td></tr>
<tr class="codeline" data-linenumber="228"><td class="num" id="LN228">228</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>int</span> n&gt; <span class='keyword'>struct</span> is_wchar&lt;<span class='keyword'>wchar_t</span>[n]&gt; {};</td></tr>
<tr class="codeline" data-linenumber="229"><td class="num" id="LN229">229</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="230"><td class="num" id="LN230">230</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="231"><td class="num" id="LN231">231</td><td class="line"><span class='comment'>// Format the value by casting to type fmtT.  This default implementation</span></td></tr>
<tr class="codeline" data-linenumber="232"><td class="num" id="LN232">232</td><td class="line"><span class='comment'>// should never be called.</span></td></tr>
<tr class="codeline" data-linenumber="233"><td class="num" id="LN233">233</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T, <span class='keyword'>typename</span> fmtT, <span class='keyword'>bool</span> convertible = is_convertible&lt;T, fmtT&gt;::value&gt;</td></tr>
<tr class="codeline" data-linenumber="234"><td class="num" id="LN234">234</td><td class="line"><span class='keyword'>struct</span> formatValueAsType</td></tr>
<tr class="codeline" data-linenumber="235"><td class="num" id="LN235">235</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="236"><td class="num" id="LN236">236</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>void</span> invoke(std::ostream&amp; <span class='comment'>/*out*/</span>, <span class='keyword'>const</span> T&amp; <span class='comment'>/*value*/</span>) { <span class='macro'>TINYFORMAT_ASSERT(0)<span class='macro_popup'>(static_cast &lt;bool&gt; (0) ? void (0) : __assert_fail ("0"<br>, "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h", 236, __extension__<br> __PRETTY_FUNCTION__))</span></span>; }</td></tr>
<tr class="codeline" data-linenumber="237"><td class="num" id="LN237">237</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="238"><td class="num" id="LN238">238</td><td class="line"><span class='comment'>// Specialized version for types that can actually be converted to fmtT, as</span></td></tr>
<tr class="codeline" data-linenumber="239"><td class="num" id="LN239">239</td><td class="line"><span class='comment'>// indicated by the "convertible" template parameter.</span></td></tr>
<tr class="codeline" data-linenumber="240"><td class="num" id="LN240">240</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T, <span class='keyword'>typename</span> fmtT&gt;</td></tr>
<tr class="codeline" data-linenumber="241"><td class="num" id="LN241">241</td><td class="line"><span class='keyword'>struct</span> formatValueAsType&lt;T,fmtT,<span class='keyword'>true</span>&gt;</td></tr>
<tr class="codeline" data-linenumber="242"><td class="num" id="LN242">242</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="243"><td class="num" id="LN243">243</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>void</span> invoke(std::ostream&amp; out, <span class='keyword'>const</span> T&amp; value)</td></tr>
<tr class="codeline" data-linenumber="244"><td class="num" id="LN244">244</td><td class="line">        { out &lt;&lt; <span class='keyword'>static_cast</span>&lt;fmtT&gt;(value); }</td></tr>
<tr class="codeline" data-linenumber="245"><td class="num" id="LN245">245</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="246"><td class="num" id="LN246">246</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="247"><td class="num" id="LN247">247</td><td class="line"><span class='directive'>#ifdef TINYFORMAT_OLD_LIBSTDCPLUSPLUS_WORKAROUND</span></td></tr>
<tr class="codeline" data-linenumber="248"><td class="num" id="LN248">248</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T, <span class='keyword'>bool</span> convertible = is_convertible&lt;T, <span class='keyword'>int</span>&gt;::value&gt;</td></tr>
<tr class="codeline" data-linenumber="249"><td class="num" id="LN249">249</td><td class="line"><span class='keyword'>struct</span> formatZeroIntegerWorkaround</td></tr>
<tr class="codeline" data-linenumber="250"><td class="num" id="LN250">250</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="251"><td class="num" id="LN251">251</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>bool</span> invoke(std::ostream&amp; <span class='comment'>/**/</span>, <span class='keyword'>const</span> T&amp; <span class='comment'>/**/</span>) { <span class='keyword'>return</span> <span class='keyword'>false</span>; }</td></tr>
<tr class="codeline" data-linenumber="252"><td class="num" id="LN252">252</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="253"><td class="num" id="LN253">253</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="254"><td class="num" id="LN254">254</td><td class="line"><span class='keyword'>struct</span> formatZeroIntegerWorkaround&lt;T,<span class='keyword'>true</span>&gt;</td></tr>
<tr class="codeline" data-linenumber="255"><td class="num" id="LN255">255</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="256"><td class="num" id="LN256">256</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>bool</span> invoke(std::ostream&amp; out, <span class='keyword'>const</span> T&amp; value)</td></tr>
<tr class="codeline" data-linenumber="257"><td class="num" id="LN257">257</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="258"><td class="num" id="LN258">258</td><td class="line">        <span class='keyword'>if</span> (<span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(value) == 0 &amp;&amp; out.flags() &amp; std::ios::showpos) {</td></tr>
<tr class="codeline" data-linenumber="259"><td class="num" id="LN259">259</td><td class="line">            out &lt;&lt; <span class='string_literal'>"+0"</span>;</td></tr>
<tr class="codeline" data-linenumber="260"><td class="num" id="LN260">260</td><td class="line">            <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="261"><td class="num" id="LN261">261</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="262"><td class="num" id="LN262">262</td><td class="line">        <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="263"><td class="num" id="LN263">263</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="264"><td class="num" id="LN264">264</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="265"><td class="num" id="LN265">265</td><td class="line"><span class='directive'>#endif // TINYFORMAT_OLD_LIBSTDCPLUSPLUS_WORKAROUND</span></td></tr>
<tr class="codeline" data-linenumber="266"><td class="num" id="LN266">266</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="267"><td class="num" id="LN267">267</td><td class="line"><span class='comment'>// Convert an arbitrary type to integer.  The version with convertible=false</span></td></tr>
<tr class="codeline" data-linenumber="268"><td class="num" id="LN268">268</td><td class="line"><span class='comment'>// throws an error.</span></td></tr>
<tr class="codeline" data-linenumber="269"><td class="num" id="LN269">269</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T, <span class='keyword'>bool</span> convertible = is_convertible&lt;T,<span class='keyword'>int</span>&gt;::value&gt;</td></tr>
<tr class="codeline" data-linenumber="270"><td class="num" id="LN270">270</td><td class="line"><span class='keyword'>struct</span> convertToInt</td></tr>
<tr class="codeline" data-linenumber="271"><td class="num" id="LN271">271</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="272"><td class="num" id="LN272">272</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>int</span> invoke(<span class='keyword'>const</span> T&amp; <span class='comment'>/*value*/</span>)</td></tr>
<tr class="codeline" data-linenumber="273"><td class="num" id="LN273">273</td><td class="line">    {</td></tr>
<tr class="codeline" data-linenumber="274"><td class="num" id="LN274">274</td><td class="line">        <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Cannot convert from argument type to "<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Cannot convert from argument type to "<br> "integer for use as variable width or precision")</span></span></span></td></tr>
<tr class="codeline" data-linenumber="275"><td class="num" id="LN275">275</td><td class="line">                         <span class='string_literal'><span class='macro'>"integer for use as variable width or precision"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Cannot convert from argument type to "<br> "integer for use as variable width or precision")</span></span>;</td></tr>
<tr class="codeline" data-linenumber="276"><td class="num" id="LN276">276</td><td class="line">        <span class='keyword'>return</span> 0;</td></tr>
<tr class="codeline" data-linenumber="277"><td class="num" id="LN277">277</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="278"><td class="num" id="LN278">278</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="279"><td class="num" id="LN279">279</td><td class="line"><span class='comment'>// Specialization for convertToInt when conversion is possible</span></td></tr>
<tr class="codeline" data-linenumber="280"><td class="num" id="LN280">280</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="281"><td class="num" id="LN281">281</td><td class="line"><span class='keyword'>struct</span> convertToInt&lt;T,<span class='keyword'>true</span>&gt;</td></tr>
<tr class="codeline" data-linenumber="282"><td class="num" id="LN282">282</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="283"><td class="num" id="LN283">283</td><td class="line">    <span class='keyword'>static</span> <span class='keyword'>int</span> invoke(<span class='keyword'>const</span> T&amp; value) { <span class='keyword'>return</span> <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(value); }</td></tr>
<tr class="codeline" data-linenumber="284"><td class="num" id="LN284">284</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="285"><td class="num" id="LN285">285</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="286"><td class="num" id="LN286">286</td><td class="line"><span class='comment'>// Format at most ntrunc characters to the given stream.</span></td></tr>
<tr class="codeline" data-linenumber="287"><td class="num" id="LN287">287</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="288"><td class="num" id="LN288">288</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> formatTruncated(std::ostream&amp; out, <span class='keyword'>const</span> T&amp; value, <span class='keyword'>int</span> ntrunc)</td></tr>
<tr class="codeline" data-linenumber="289"><td class="num" id="LN289">289</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="290"><td class="num" id="LN290">290</td><td class="line">    std::ostringstream tmp;</td></tr>
<tr class="codeline" data-linenumber="291"><td class="num" id="LN291">291</td><td class="line">    tmp &lt;&lt; value;</td></tr>
<tr class="codeline" data-linenumber="292"><td class="num" id="LN292">292</td><td class="line">    std::string result = tmp.str();</td></tr>
<tr class="codeline" data-linenumber="293"><td class="num" id="LN293">293</td><td class="line">    out.write(result.c_str(), (std::min)(ntrunc, <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(result.size())));</td></tr>
<tr class="codeline" data-linenumber="294"><td class="num" id="LN294">294</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="295"><td class="num" id="LN295">295</td><td class="line"><span class='directive'>#define TINYFORMAT_DEFINE_FORMAT_TRUNCATED_CSTR(type)       \</span></td></tr>
<tr class="codeline" data-linenumber="296"><td class="num" id="LN296">296</td><td class="line"><span class='directive'>inline void formatTruncated(std::ostream&amp; out, type* value, int ntrunc) \</span></td></tr>
<tr class="codeline" data-linenumber="297"><td class="num" id="LN297">297</td><td class="line"><span class='directive'>{                                                           \</span></td></tr>
<tr class="codeline" data-linenumber="298"><td class="num" id="LN298">298</td><td class="line">    <span class='directive'>std::streamsize len = 0;                                \</span></td></tr>
<tr class="codeline" data-linenumber="299"><td class="num" id="LN299">299</td><td class="line">    <span class='directive'>while (len &lt; ntrunc &amp;&amp; value[len] != 0)                 \</span></td></tr>
<tr class="codeline" data-linenumber="300"><td class="num" id="LN300">300</td><td class="line">        <span class='directive'>++len;                                              \</span></td></tr>
<tr class="codeline" data-linenumber="301"><td class="num" id="LN301">301</td><td class="line">    <span class='directive'>out.write(value, len);                                  \</span></td></tr>
<tr class="codeline" data-linenumber="302"><td class="num" id="LN302">302</td><td class="line"><span class='directive'>}</span></td></tr>
<tr class="codeline" data-linenumber="303"><td class="num" id="LN303">303</td><td class="line"><span class='comment'>// Overload for const char* and char*.  Could overload for signed &amp; unsigned</span></td></tr>
<tr class="codeline" data-linenumber="304"><td class="num" id="LN304">304</td><td class="line"><span class='comment'>// char too, but these are technically unneeded for printf compatibility.</span></td></tr>
<tr class="codeline" data-linenumber="305"><td class="num" id="LN305">305</td><td class="line">TINYFORMAT_DEFINE_FORMAT_TRUNCATED_CSTR(<span class='keyword'>const</span> <span class='keyword'>char</span>)</td></tr>
<tr class="codeline" data-linenumber="306"><td class="num" id="LN306">306</td><td class="line">TINYFORMAT_DEFINE_FORMAT_TRUNCATED_CSTR(<span class='keyword'>char</span>)</td></tr>
<tr class="codeline" data-linenumber="307"><td class="num" id="LN307">307</td><td class="line"><span class='directive'>#undef TINYFORMAT_DEFINE_FORMAT_TRUNCATED_CSTR</span></td></tr>
<tr class="codeline" data-linenumber="308"><td class="num" id="LN308">308</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="309"><td class="num" id="LN309">309</td><td class="line">} <span class='comment'>// namespace detail</span></td></tr>
<tr class="codeline" data-linenumber="310"><td class="num" id="LN310">310</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="311"><td class="num" id="LN311">311</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="312"><td class="num" id="LN312">312</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="313"><td class="num" id="LN313">313</td><td class="line"><span class='comment'>// Variable formatting functions.  May be overridden for user-defined types if</span></td></tr>
<tr class="codeline" data-linenumber="314"><td class="num" id="LN314">314</td><td class="line"><span class='comment'>// desired.</span></td></tr>
<tr class="codeline" data-linenumber="315"><td class="num" id="LN315">315</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="316"><td class="num" id="LN316">316</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="317"><td class="num" id="LN317">317</td><td class="line"><span class='comment'>/// Format a value into a stream, delegating to operator&lt;&lt; by default.</span></td></tr>
<tr class="codeline" data-linenumber="318"><td class="num" id="LN318">318</td><td class="line"><span class='comment'>///</span></td></tr>
<tr class="codeline" data-linenumber="319"><td class="num" id="LN319">319</td><td class="line"><span class='comment'>/// Users may override this for their own types.  When this function is called,</span></td></tr>
<tr class="codeline" data-linenumber="320"><td class="num" id="LN320">320</td><td class="line"><span class='comment'>/// the stream flags will have been modified according to the format string.</span></td></tr>
<tr class="codeline" data-linenumber="321"><td class="num" id="LN321">321</td><td class="line"><span class='comment'>/// The format specification is provided in the range [fmtBegin, fmtEnd).  For</span></td></tr>
<tr class="codeline" data-linenumber="322"><td class="num" id="LN322">322</td><td class="line"><span class='comment'>/// truncating conversions, ntrunc is set to the desired maximum number of</span></td></tr>
<tr class="codeline" data-linenumber="323"><td class="num" id="LN323">323</td><td class="line"><span class='comment'>/// characters, for example "%.7s" calls formatValue with ntrunc = 7.</span></td></tr>
<tr class="codeline" data-linenumber="324"><td class="num" id="LN324">324</td><td class="line"><span class='comment'>///</span></td></tr>
<tr class="codeline" data-linenumber="325"><td class="num" id="LN325">325</td><td class="line"><span class='comment'>/// By default, formatValue() uses the usual stream insertion operator</span></td></tr>
<tr class="codeline" data-linenumber="326"><td class="num" id="LN326">326</td><td class="line"><span class='comment'>/// operator&lt;&lt; to format the type T, with special cases for the %c and %p</span></td></tr>
<tr class="codeline" data-linenumber="327"><td class="num" id="LN327">327</td><td class="line"><span class='comment'>/// conversions.</span></td></tr>
<tr class="codeline" data-linenumber="328"><td class="num" id="LN328">328</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="329"><td class="num" id="LN329">329</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> formatValue(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* <span class='comment'>/*fmtBegin*/</span>,</td></tr>
<tr class="codeline" data-linenumber="330"><td class="num" id="LN330">330</td><td class="line">                        <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtEnd, <span class='keyword'>int</span> ntrunc, <span class='keyword'>const</span> T&amp; value)</td></tr>
<tr class="codeline" data-linenumber="331"><td class="num" id="LN331">331</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="332"><td class="num" id="LN332">332</td><td class="line"><span class='directive'>#ifndef TINYFORMAT_ALLOW_WCHAR_STRINGS</span></td></tr>
<tr class="codeline" data-linenumber="333"><td class="num" id="LN333">333</td><td class="line">    <span class='comment'>// Since we don't support printing of wchar_t using "%ls", make it fail at</span></td></tr>
<tr class="codeline" data-linenumber="334"><td class="num" id="LN334">334</td><td class="line">    <span class='comment'>// compile time in preference to printing as a void* at runtime.</span></td></tr>
<tr class="codeline" data-linenumber="335"><td class="num" id="LN335">335</td><td class="line">    <span class='keyword'>typedef</span> <span class='keyword'>typename</span> detail::is_wchar&lt;T&gt;::tinyformat_wchar_is_not_supported DummyType;</td></tr>
<tr class="codeline" data-linenumber="336"><td class="num" id="LN336">336</td><td class="line">    (<span class='keyword'>void</span>) DummyType(); <span class='comment'>// avoid unused type warning with gcc-4.8</span></td></tr>
<tr class="codeline" data-linenumber="337"><td class="num" id="LN337">337</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="338"><td class="num" id="LN338">338</td><td class="line">    <span class='comment'>// The mess here is to support the %c and %p conversions: if these</span></td></tr>
<tr class="codeline" data-linenumber="339"><td class="num" id="LN339">339</td><td class="line">    <span class='comment'>// conversions are active we try to convert the type to a char or const</span></td></tr>
<tr class="codeline" data-linenumber="340"><td class="num" id="LN340">340</td><td class="line">    <span class='comment'>// void* respectively and format that instead of the value itself.  For the</span></td></tr>
<tr class="codeline" data-linenumber="341"><td class="num" id="LN341">341</td><td class="line">    <span class='comment'>// %p conversion it's important to avoid dereferencing the pointer, which</span></td></tr>
<tr class="codeline" data-linenumber="342"><td class="num" id="LN342">342</td><td class="line">    <span class='comment'>// could otherwise lead to a crash when printing a dangling (const char*).</span></td></tr>
<tr class="codeline" data-linenumber="343"><td class="num" id="LN343">343</td><td class="line">    <span class='keyword'>const</span> <span class='keyword'>bool</span> canConvertToChar = detail::is_convertible&lt;T,<span class='keyword'>char</span>&gt;::value;</td></tr>
<tr class="codeline" data-linenumber="344"><td class="num" id="LN344">344</td><td class="line">    <span class='keyword'>const</span> <span class='keyword'>bool</span> canConvertToVoidPtr = detail::is_convertible&lt;T, <span class='keyword'>const</span> <span class='keyword'>void</span>*&gt;::value;</td></tr>
<tr class="codeline" data-linenumber="345"><td class="num" id="LN345">345</td><td class="line">    <span class='keyword'>if</span> (canConvertToChar &amp;&amp; *(fmtEnd-1) == 'c')</td></tr>
<tr class="codeline" data-linenumber="346"><td class="num" id="LN346">346</td><td class="line">        detail::formatValueAsType&lt;T, <span class='keyword'>char</span>&gt;::invoke(out, value);</td></tr>
<tr class="codeline" data-linenumber="347"><td class="num" id="LN347">347</td><td class="line">    <span class='keyword'>else</span> <span class='keyword'>if</span> (canConvertToVoidPtr &amp;&amp; *(fmtEnd-1) == 'p')</td></tr>
<tr class="codeline" data-linenumber="348"><td class="num" id="LN348">348</td><td class="line">        detail::formatValueAsType&lt;T, <span class='keyword'>const</span> <span class='keyword'>void</span>*&gt;::invoke(out, value);</td></tr>
<tr class="codeline" data-linenumber="349"><td class="num" id="LN349">349</td><td class="line"><span class='directive'>#ifdef TINYFORMAT_OLD_LIBSTDCPLUSPLUS_WORKAROUND</span></td></tr>
<tr class="codeline" data-linenumber="350"><td class="num" id="LN350">350</td><td class="line">    <span class='keyword'>else</span> <span class='keyword'>if</span> (detail::formatZeroIntegerWorkaround&lt;T&gt;::invoke(out, value)) <span class='comment'>/**/</span>;</td></tr>
<tr class="codeline" data-linenumber="351"><td class="num" id="LN351">351</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="352"><td class="num" id="LN352">352</td><td class="line">    <span class='keyword'>else</span> <span class='keyword'>if</span> (ntrunc &gt;= 0) {</td></tr>
<tr class="codeline" data-linenumber="353"><td class="num" id="LN353">353</td><td class="line">        <span class='comment'>// Take care not to overread C strings in truncating conversions like</span></td></tr>
<tr class="codeline" data-linenumber="354"><td class="num" id="LN354">354</td><td class="line">        <span class='comment'>// "%.4s" where at most 4 characters may be read.</span></td></tr>
<tr class="codeline" data-linenumber="355"><td class="num" id="LN355">355</td><td class="line">        detail::formatTruncated(out, value, ntrunc);</td></tr>
<tr class="codeline" data-linenumber="356"><td class="num" id="LN356">356</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="357"><td class="num" id="LN357">357</td><td class="line">    <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="358"><td class="num" id="LN358">358</td><td class="line">        out &lt;&lt; value;</td></tr>
<tr class="codeline" data-linenumber="359"><td class="num" id="LN359">359</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="360"><td class="num" id="LN360">360</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="361"><td class="num" id="LN361">361</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="362"><td class="num" id="LN362">362</td><td class="line"><span class='comment'>// Overloaded version for char types to support printing as an integer</span></td></tr>
<tr class="codeline" data-linenumber="363"><td class="num" id="LN363">363</td><td class="line"><span class='directive'>#define TINYFORMAT_DEFINE_FORMATVALUE_CHAR(charType)                  \</span></td></tr>
<tr class="codeline" data-linenumber="364"><td class="num" id="LN364">364</td><td class="line"><span class='directive'>inline void formatValue(std::ostream&amp; out, const char* /*fmtBegin*/,  \</span></td></tr>
<tr class="codeline" data-linenumber="365"><td class="num" id="LN365">365</td><td class="line">                        <span class='directive'>const char* fmtEnd, int /**/, charType value) \</span></td></tr>
<tr class="codeline" data-linenumber="366"><td class="num" id="LN366">366</td><td class="line"><span class='directive'>{                                                                     \</span></td></tr>
<tr class="codeline" data-linenumber="367"><td class="num" id="LN367">367</td><td class="line">    <span class='directive'>switch (*(fmtEnd-1)) {                                            \</span></td></tr>
<tr class="codeline" data-linenumber="368"><td class="num" id="LN368">368</td><td class="line">        <span class='directive'>case 'u': case 'd': case 'i': case 'o': case 'X': case 'x':   \</span></td></tr>
<tr class="codeline" data-linenumber="369"><td class="num" id="LN369">369</td><td class="line">            <span class='directive'>out &lt;&lt; static_cast&lt;int&gt;(value); break;                    \</span></td></tr>
<tr class="codeline" data-linenumber="370"><td class="num" id="LN370">370</td><td class="line">        <span class='directive'>default:                                                      \</span></td></tr>
<tr class="codeline" data-linenumber="371"><td class="num" id="LN371">371</td><td class="line">            <span class='directive'>out &lt;&lt; value;                   break;                    \</span></td></tr>
<tr class="codeline" data-linenumber="372"><td class="num" id="LN372">372</td><td class="line">    <span class='directive'>}                                                                 \</span></td></tr>
<tr class="codeline" data-linenumber="373"><td class="num" id="LN373">373</td><td class="line"><span class='directive'>}</span></td></tr>
<tr class="codeline" data-linenumber="374"><td class="num" id="LN374">374</td><td class="line"><span class='comment'>// per 3.9.1: char, signed char and unsigned char are all distinct types</span></td></tr>
<tr class="codeline" data-linenumber="375"><td class="num" id="LN375">375</td><td class="line">TINYFORMAT_DEFINE_FORMATVALUE_CHAR(<span class='keyword'>char</span>)</td></tr>
<tr class="codeline" data-linenumber="376"><td class="num" id="LN376">376</td><td class="line">TINYFORMAT_DEFINE_FORMATVALUE_CHAR(<span class='keyword'>signed</span> <span class='keyword'>char</span>)</td></tr>
<tr class="codeline" data-linenumber="377"><td class="num" id="LN377">377</td><td class="line">TINYFORMAT_DEFINE_FORMATVALUE_CHAR(<span class='keyword'>unsigned</span> <span class='keyword'>char</span>)</td></tr>
<tr class="codeline" data-linenumber="378"><td class="num" id="LN378">378</td><td class="line"><span class='directive'>#undef TINYFORMAT_DEFINE_FORMATVALUE_CHAR</span></td></tr>
<tr class="codeline" data-linenumber="379"><td class="num" id="LN379">379</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="380"><td class="num" id="LN380">380</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="381"><td class="num" id="LN381">381</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="382"><td class="num" id="LN382">382</td><td class="line"><span class='comment'>// Tools for emulating variadic templates in C++98.  The basic idea here is</span></td></tr>
<tr class="codeline" data-linenumber="383"><td class="num" id="LN383">383</td><td class="line"><span class='comment'>// stolen from the boost preprocessor metaprogramming library and cut down to</span></td></tr>
<tr class="codeline" data-linenumber="384"><td class="num" id="LN384">384</td><td class="line"><span class='comment'>// be just general enough for what we need.</span></td></tr>
<tr class="codeline" data-linenumber="385"><td class="num" id="LN385">385</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="386"><td class="num" id="LN386">386</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span> TINYFORMAT_ARGTYPES_ ## n</span></td></tr>
<tr class="codeline" data-linenumber="387"><td class="num" id="LN387">387</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span> TINYFORMAT_VARARGS_ ## n</span></td></tr>
<tr class="codeline" data-linenumber="388"><td class="num" id="LN388">388</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span> TINYFORMAT_PASSARGS_ ## n</span></td></tr>
<tr class="codeline" data-linenumber="389"><td class="num" id="LN389">389</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_TAIL_n</span></span> TINYFORMAT_PASSARGS_TAIL_ ## n</span></td></tr>
<tr class="codeline" data-linenumber="390"><td class="num" id="LN390">390</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="391"><td class="num" id="LN391">391</td><td class="line"><span class='comment'>// To keep it as transparent as possible, the macros below have been generated</span></td></tr>
<tr class="codeline" data-linenumber="392"><td class="num" id="LN392">392</td><td class="line"><span class='comment'>// using python via the excellent cog.py code generation script.  This avoids</span></td></tr>
<tr class="codeline" data-linenumber="393"><td class="num" id="LN393">393</td><td class="line"><span class='comment'>// the need for a bunch of complex (but more general) preprocessor tricks as</span></td></tr>
<tr class="codeline" data-linenumber="394"><td class="num" id="LN394">394</td><td class="line"><span class='comment'>// used in boost.preprocessor.</span></td></tr>
<tr class="codeline" data-linenumber="395"><td class="num" id="LN395">395</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="396"><td class="num" id="LN396">396</td><td class="line"><span class='comment'>// To rerun the code generation in place, use `cog.py -r tinyformat.h`</span></td></tr>
<tr class="codeline" data-linenumber="397"><td class="num" id="LN397">397</td><td class="line"><span class='comment'>// (see http://nedbatchelder.com/code/cog).  Alternatively you can just create</span></td></tr>
<tr class="codeline" data-linenumber="398"><td class="num" id="LN398">398</td><td class="line"><span class='comment'>// extra versions by hand.</span></td></tr>
<tr class="codeline" data-linenumber="399"><td class="num" id="LN399">399</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="400"><td class="num" id="LN400">400</td><td class="line"><span class='comment'>/*[[[cog</span></td></tr>
<tr class="codeline" data-linenumber="401"><td class="num" id="LN401">401</td><td class="line"><span class='comment'>maxParams = 16</span></td></tr>
<tr class="codeline" data-linenumber="402"><td class="num" id="LN402">402</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="403"><td class="num" id="LN403">403</td><td class="line"><span class='comment'>def makeCommaSepLists(lineTemplate, elemTemplate, startInd=1):</span></td></tr>
<tr class="codeline" data-linenumber="404"><td class="num" id="LN404">404</td><td class="line">    <span class='comment'>for j in range(startInd,maxParams+1):</span></td></tr>
<tr class="codeline" data-linenumber="405"><td class="num" id="LN405">405</td><td class="line">        <span class='comment'>list = ', '.join([elemTemplate % {'i':i} for i in range(startInd,j+1)])</span></td></tr>
<tr class="codeline" data-linenumber="406"><td class="num" id="LN406">406</td><td class="line">        <span class='comment'>cog.outl(lineTemplate % {'j':j, 'list':list})</span></td></tr>
<tr class="codeline" data-linenumber="407"><td class="num" id="LN407">407</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="408"><td class="num" id="LN408">408</td><td class="line"><span class='comment'>makeCommaSepLists('#define TINYFORMAT_ARGTYPES_%(j)d %(list)s',</span></td></tr>
<tr class="codeline" data-linenumber="409"><td class="num" id="LN409">409</td><td class="line">                  <span class='comment'>'class T%(i)d')</span></td></tr>
<tr class="codeline" data-linenumber="410"><td class="num" id="LN410">410</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="411"><td class="num" id="LN411">411</td><td class="line"><span class='comment'>cog.outl()</span></td></tr>
<tr class="codeline" data-linenumber="412"><td class="num" id="LN412">412</td><td class="line"><span class='comment'>makeCommaSepLists('#define TINYFORMAT_VARARGS_%(j)d %(list)s',</span></td></tr>
<tr class="codeline" data-linenumber="413"><td class="num" id="LN413">413</td><td class="line">                  <span class='comment'>'const T%(i)d&amp; v%(i)d')</span></td></tr>
<tr class="codeline" data-linenumber="414"><td class="num" id="LN414">414</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="415"><td class="num" id="LN415">415</td><td class="line"><span class='comment'>cog.outl()</span></td></tr>
<tr class="codeline" data-linenumber="416"><td class="num" id="LN416">416</td><td class="line"><span class='comment'>makeCommaSepLists('#define TINYFORMAT_PASSARGS_%(j)d %(list)s', 'v%(i)d')</span></td></tr>
<tr class="codeline" data-linenumber="417"><td class="num" id="LN417">417</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="418"><td class="num" id="LN418">418</td><td class="line"><span class='comment'>cog.outl()</span></td></tr>
<tr class="codeline" data-linenumber="419"><td class="num" id="LN419">419</td><td class="line"><span class='comment'>cog.outl('#define TINYFORMAT_PASSARGS_TAIL_1')</span></td></tr>
<tr class="codeline" data-linenumber="420"><td class="num" id="LN420">420</td><td class="line"><span class='comment'>makeCommaSepLists('#define TINYFORMAT_PASSARGS_TAIL_%(j)d , %(list)s',</span></td></tr>
<tr class="codeline" data-linenumber="421"><td class="num" id="LN421">421</td><td class="line">                  <span class='comment'>'v%(i)d', startInd = 2)</span></td></tr>
<tr class="codeline" data-linenumber="422"><td class="num" id="LN422">422</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="423"><td class="num" id="LN423">423</td><td class="line"><span class='comment'>cog.outl()</span></td></tr>
<tr class="codeline" data-linenumber="424"><td class="num" id="LN424">424</td><td class="line"><span class='comment'>cog.outl('#define TINYFORMAT_FOREACH_ARGNUM(m) \\\n    ' +</span></td></tr>
<tr class="codeline" data-linenumber="425"><td class="num" id="LN425">425</td><td class="line">         <span class='comment'>' '.join(['m(%d)' % (j,) for j in range(1,maxParams+1)]))</span></td></tr>
<tr class="codeline" data-linenumber="426"><td class="num" id="LN426">426</td><td class="line"><span class='comment'>]]]*/</span></td></tr>
<tr class="codeline" data-linenumber="427"><td class="num" id="LN427">427</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_1<span class='macro_popup'>class T1</span></span> class T1</span></td></tr>
<tr class="codeline" data-linenumber="428"><td class="num" id="LN428">428</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_2<span class='macro_popup'>class T1, class T2</span></span> class T1, class T2</span></td></tr>
<tr class="codeline" data-linenumber="429"><td class="num" id="LN429">429</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_3<span class='macro_popup'>class T1, class T2, class T3</span></span> class T1, class T2, class T3</span></td></tr>
<tr class="codeline" data-linenumber="430"><td class="num" id="LN430">430</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_4<span class='macro_popup'>class T1, class T2, class T3, class T4</span></span> class T1, class T2, class T3, class T4</span></td></tr>
<tr class="codeline" data-linenumber="431"><td class="num" id="LN431">431</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_5<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5</span></span> class T1, class T2, class T3, class T4, class T5</span></td></tr>
<tr class="codeline" data-linenumber="432"><td class="num" id="LN432">432</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_6<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6</span></span> class T1, class T2, class T3, class T4, class T5, class T6</span></td></tr>
<tr class="codeline" data-linenumber="433"><td class="num" id="LN433">433</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_7<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7</span></td></tr>
<tr class="codeline" data-linenumber="434"><td class="num" id="LN434">434</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_8<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8</span></td></tr>
<tr class="codeline" data-linenumber="435"><td class="num" id="LN435">435</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_9<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9</span></td></tr>
<tr class="codeline" data-linenumber="436"><td class="num" id="LN436">436</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_10<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10</span></td></tr>
<tr class="codeline" data-linenumber="437"><td class="num" id="LN437">437</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_11<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10, class T11</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10, class T11</span></td></tr>
<tr class="codeline" data-linenumber="438"><td class="num" id="LN438">438</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_12<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10, class T11, class T12</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10, class T11, class T12</span></td></tr>
<tr class="codeline" data-linenumber="439"><td class="num" id="LN439">439</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_13<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10, class T11, class T12, class<br> T13</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10, class T11, class T12, class T13</span></td></tr>
<tr class="codeline" data-linenumber="440"><td class="num" id="LN440">440</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_14<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10, class T11, class T12, class<br> T13, class T14</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10, class T11, class T12, class T13, class T14</span></td></tr>
<tr class="codeline" data-linenumber="441"><td class="num" id="LN441">441</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_15<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10, class T11, class T12, class<br> T13, class T14, class T15</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10, class T11, class T12, class T13, class T14, class T15</span></td></tr>
<tr class="codeline" data-linenumber="442"><td class="num" id="LN442">442</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_ARGTYPES_16<span class='macro_popup'>class T1, class T2, class T3, class T4, class T5, class T6, class<br> T7, class T8, class T9, class T10, class T11, class T12, class<br> T13, class T14, class T15, class T16</span></span> class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8, class T9, class T10, class T11, class T12, class T13, class T14, class T15, class T16</span></td></tr>
<tr class="codeline" data-linenumber="443"><td class="num" id="LN443">443</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="444"><td class="num" id="LN444">444</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_1<span class='macro_popup'>const T1&amp; v1</span></span> const T1&amp; v1</span></td></tr>
<tr class="codeline" data-linenumber="445"><td class="num" id="LN445">445</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_2<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2</span></span> const T1&amp; v1, const T2&amp; v2</span></td></tr>
<tr class="codeline" data-linenumber="446"><td class="num" id="LN446">446</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_3<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3</span></td></tr>
<tr class="codeline" data-linenumber="447"><td class="num" id="LN447">447</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_4<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4</span></td></tr>
<tr class="codeline" data-linenumber="448"><td class="num" id="LN448">448</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_5<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5</span></td></tr>
<tr class="codeline" data-linenumber="449"><td class="num" id="LN449">449</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_6<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6</span></td></tr>
<tr class="codeline" data-linenumber="450"><td class="num" id="LN450">450</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_7<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7</span></td></tr>
<tr class="codeline" data-linenumber="451"><td class="num" id="LN451">451</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_8<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8</span></td></tr>
<tr class="codeline" data-linenumber="452"><td class="num" id="LN452">452</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_9<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9</span></td></tr>
<tr class="codeline" data-linenumber="453"><td class="num" id="LN453">453</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_10<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10</span></td></tr>
<tr class="codeline" data-linenumber="454"><td class="num" id="LN454">454</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_11<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const<br> T11&amp; v11</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const T11&amp; v11</span></td></tr>
<tr class="codeline" data-linenumber="455"><td class="num" id="LN455">455</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_12<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const<br> T11&amp; v11, const T12&amp; v12</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const T11&amp; v11, const T12&amp; v12</span></td></tr>
<tr class="codeline" data-linenumber="456"><td class="num" id="LN456">456</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_13<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const<br> T11&amp; v11, const T12&amp; v12, const T13&amp; v13</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const T11&amp; v11, const T12&amp; v12, const T13&amp; v13</span></td></tr>
<tr class="codeline" data-linenumber="457"><td class="num" id="LN457">457</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_14<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const<br> T11&amp; v11, const T12&amp; v12, const T13&amp; v13, const T14<br>&amp; v14</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const T11&amp; v11, const T12&amp; v12, const T13&amp; v13, const T14&amp; v14</span></td></tr>
<tr class="codeline" data-linenumber="458"><td class="num" id="LN458">458</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_15<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const<br> T11&amp; v11, const T12&amp; v12, const T13&amp; v13, const T14<br>&amp; v14, const T15&amp; v15</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const T11&amp; v11, const T12&amp; v12, const T13&amp; v13, const T14&amp; v14, const T15&amp; v15</span></td></tr>
<tr class="codeline" data-linenumber="459"><td class="num" id="LN459">459</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_VARARGS_16<span class='macro_popup'>const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4<br>&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7<br>, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const<br> T11&amp; v11, const T12&amp; v12, const T13&amp; v13, const T14<br>&amp; v14, const T15&amp; v15, const T16&amp; v16</span></span> const T1&amp; v1, const T2&amp; v2, const T3&amp; v3, const T4&amp; v4, const T5&amp; v5, const T6&amp; v6, const T7&amp; v7, const T8&amp; v8, const T9&amp; v9, const T10&amp; v10, const T11&amp; v11, const T12&amp; v12, const T13&amp; v13, const T14&amp; v14, const T15&amp; v15, const T16&amp; v16</span></td></tr>
<tr class="codeline" data-linenumber="460"><td class="num" id="LN460">460</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="461"><td class="num" id="LN461">461</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_1<span class='macro_popup'>v1</span></span> v1</span></td></tr>
<tr class="codeline" data-linenumber="462"><td class="num" id="LN462">462</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_2<span class='macro_popup'>v1, v2</span></span> v1, v2</span></td></tr>
<tr class="codeline" data-linenumber="463"><td class="num" id="LN463">463</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_3<span class='macro_popup'>v1, v2, v3</span></span> v1, v2, v3</span></td></tr>
<tr class="codeline" data-linenumber="464"><td class="num" id="LN464">464</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_4<span class='macro_popup'>v1, v2, v3, v4</span></span> v1, v2, v3, v4</span></td></tr>
<tr class="codeline" data-linenumber="465"><td class="num" id="LN465">465</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_5<span class='macro_popup'>v1, v2, v3, v4, v5</span></span> v1, v2, v3, v4, v5</span></td></tr>
<tr class="codeline" data-linenumber="466"><td class="num" id="LN466">466</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_6<span class='macro_popup'>v1, v2, v3, v4, v5, v6</span></span> v1, v2, v3, v4, v5, v6</span></td></tr>
<tr class="codeline" data-linenumber="467"><td class="num" id="LN467">467</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_7<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7</span></span> v1, v2, v3, v4, v5, v6, v7</span></td></tr>
<tr class="codeline" data-linenumber="468"><td class="num" id="LN468">468</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_8<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8</span></span> v1, v2, v3, v4, v5, v6, v7, v8</span></td></tr>
<tr class="codeline" data-linenumber="469"><td class="num" id="LN469">469</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_9<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9</span></td></tr>
<tr class="codeline" data-linenumber="470"><td class="num" id="LN470">470</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_10<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10</span></td></tr>
<tr class="codeline" data-linenumber="471"><td class="num" id="LN471">471</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_11<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11</span></td></tr>
<tr class="codeline" data-linenumber="472"><td class="num" id="LN472">472</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_12<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12</span></td></tr>
<tr class="codeline" data-linenumber="473"><td class="num" id="LN473">473</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_13<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13</span></td></tr>
<tr class="codeline" data-linenumber="474"><td class="num" id="LN474">474</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_14<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14</span></td></tr>
<tr class="codeline" data-linenumber="475"><td class="num" id="LN475">475</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_15<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15</span></td></tr>
<tr class="codeline" data-linenumber="476"><td class="num" id="LN476">476</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_16<span class='macro_popup'>v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15<br>, v16</span></span> v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, v16</span></td></tr>
<tr class="codeline" data-linenumber="477"><td class="num" id="LN477">477</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="478"><td class="num" id="LN478">478</td><td class="line"><span class='directive'>#define TINYFORMAT_PASSARGS_TAIL_1</span></td></tr>
<tr class="codeline" data-linenumber="479"><td class="num" id="LN479">479</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_2<span class='macro_popup'>, v2</span></span> , v2</span></td></tr>
<tr class="codeline" data-linenumber="480"><td class="num" id="LN480">480</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_3<span class='macro_popup'>, v2, v3</span></span> , v2, v3</span></td></tr>
<tr class="codeline" data-linenumber="481"><td class="num" id="LN481">481</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_4<span class='macro_popup'>, v2, v3, v4</span></span> , v2, v3, v4</span></td></tr>
<tr class="codeline" data-linenumber="482"><td class="num" id="LN482">482</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_5<span class='macro_popup'>, v2, v3, v4, v5</span></span> , v2, v3, v4, v5</span></td></tr>
<tr class="codeline" data-linenumber="483"><td class="num" id="LN483">483</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_6<span class='macro_popup'>, v2, v3, v4, v5, v6</span></span> , v2, v3, v4, v5, v6</span></td></tr>
<tr class="codeline" data-linenumber="484"><td class="num" id="LN484">484</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_7<span class='macro_popup'>, v2, v3, v4, v5, v6, v7</span></span> , v2, v3, v4, v5, v6, v7</span></td></tr>
<tr class="codeline" data-linenumber="485"><td class="num" id="LN485">485</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_8<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8</span></span> , v2, v3, v4, v5, v6, v7, v8</span></td></tr>
<tr class="codeline" data-linenumber="486"><td class="num" id="LN486">486</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_9<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9</span></span> , v2, v3, v4, v5, v6, v7, v8, v9</span></td></tr>
<tr class="codeline" data-linenumber="487"><td class="num" id="LN487">487</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_10<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10</span></td></tr>
<tr class="codeline" data-linenumber="488"><td class="num" id="LN488">488</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_11<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10, v11</span></td></tr>
<tr class="codeline" data-linenumber="489"><td class="num" id="LN489">489</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_12<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12</span></td></tr>
<tr class="codeline" data-linenumber="490"><td class="num" id="LN490">490</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_13<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13</span></td></tr>
<tr class="codeline" data-linenumber="491"><td class="num" id="LN491">491</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_14<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14</span></td></tr>
<tr class="codeline" data-linenumber="492"><td class="num" id="LN492">492</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_15<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15</span></td></tr>
<tr class="codeline" data-linenumber="493"><td class="num" id="LN493">493</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_PASSARGS_TAIL_16<span class='macro_popup'>, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15<br>, v16</span></span> , v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, v16</span></td></tr>
<tr class="codeline" data-linenumber="494"><td class="num" id="LN494">494</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="495"><td class="num" id="LN495">495</td><td class="line"><span class='directive'>#define <span class='macro'>TINYFORMAT_FOREACH_ARGNUM(m)<span class='macro_popup'>m(1) m(2) m(3) m(4) m(5) m(6) m(7) m(8) m(9) m(10) m(11) m(12<br>) m(13) m(14) m(15) m(16)</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="496"><td class="num" id="LN496">496</td><td class="line">    <span class='directive'>m(1) m(2) m(3) m(4) m(5) m(6) m(7) m(8) m(9) m(10) m(11) m(12) m(13) m(14) m(15) m(16)</span></td></tr>
<tr class="codeline" data-linenumber="497"><td class="num" id="LN497">497</td><td class="line"><span class='comment'>//[[[end]]]</span></td></tr>
<tr class="codeline" data-linenumber="498"><td class="num" id="LN498">498</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="499"><td class="num" id="LN499">499</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="500"><td class="num" id="LN500">500</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="501"><td class="num" id="LN501">501</td><td class="line"><span class='keyword'>namespace</span> detail {</td></tr>
<tr class="codeline" data-linenumber="502"><td class="num" id="LN502">502</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="503"><td class="num" id="LN503">503</td><td class="line"><span class='comment'>// Type-opaque holder for an argument to format(), with associated actions on</span></td></tr>
<tr class="codeline" data-linenumber="504"><td class="num" id="LN504">504</td><td class="line"><span class='comment'>// the type held as explicit function pointers.  This allows FormatArg's for</span></td></tr>
<tr class="codeline" data-linenumber="505"><td class="num" id="LN505">505</td><td class="line"><span class='comment'>// each argument to be allocated as a homogeneous array inside FormatList</span></td></tr>
<tr class="codeline" data-linenumber="506"><td class="num" id="LN506">506</td><td class="line"><span class='comment'>// whereas a naive implementation based on inheritance does not.</span></td></tr>
<tr class="codeline" data-linenumber="507"><td class="num" id="LN507">507</td><td class="line"><span class='keyword'>class</span> FormatArg</td></tr>
<tr class="codeline" data-linenumber="508"><td class="num" id="LN508">508</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="509"><td class="num" id="LN509">509</td><td class="line">    <span class='keyword'>public</span>:</td></tr>
<tr class="codeline" data-linenumber="510"><td class="num" id="LN510">510</td><td class="line">        FormatArg()</td></tr>
<tr class="codeline" data-linenumber="511"><td class="num" id="LN511">511</td><td class="line">            : m_value(<span class='macro'>NULL<span class='macro_popup'>__null</span></span>),</td></tr>
<tr class="codeline" data-linenumber="512"><td class="num" id="LN512">512</td><td class="line">            m_formatImpl(<span class='macro'>NULL<span class='macro_popup'>__null</span></span>),</td></tr>
<tr class="codeline" data-linenumber="513"><td class="num" id="LN513">513</td><td class="line">            m_toIntImpl(<span class='macro'>NULL<span class='macro_popup'>__null</span></span>)</td></tr>
<tr class="codeline" data-linenumber="514"><td class="num" id="LN514">514</td><td class="line">        { }</td></tr>
<tr class="codeline" data-linenumber="515"><td class="num" id="LN515">515</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="516"><td class="num" id="LN516">516</td><td class="line">        <span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="517"><td class="num" id="LN517">517</td><td class="line">        FormatArg(<span class='keyword'>const</span> T&amp; value)</td></tr>
<tr class="codeline" data-linenumber="518"><td class="num" id="LN518">518</td><td class="line">            : m_value(<span class='keyword'>static_cast</span>&lt;<span class='keyword'>const</span> <span class='keyword'>void</span>*&gt;(&amp;value)),</td></tr>
<tr class="codeline" data-linenumber="519"><td class="num" id="LN519">519</td><td class="line">            m_formatImpl(&amp;formatImpl&lt;T&gt;),</td></tr>
<tr class="codeline" data-linenumber="520"><td class="num" id="LN520">520</td><td class="line">            m_toIntImpl(&amp;toIntImpl&lt;T&gt;)</td></tr>
<tr class="codeline" data-linenumber="521"><td class="num" id="LN521">521</td><td class="line">        { }</td></tr>
<tr class="codeline" data-linenumber="522"><td class="num" id="LN522">522</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="523"><td class="num" id="LN523">523</td><td class="line">        <span class='keyword'>void</span> format(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtBegin,</td></tr>
<tr class="codeline" data-linenumber="524"><td class="num" id="LN524">524</td><td class="line">                    <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtEnd, <span class='keyword'>int</span> ntrunc) <span class='keyword'>const</span></td></tr>
<tr class="codeline" data-linenumber="525"><td class="num" id="LN525">525</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="526"><td class="num" id="LN526">526</td><td class="line">            <span class='macro'>TINYFORMAT_ASSERT(m_value)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_value) ? void (0) : __assert_fail<br> ("m_value", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 526, __extension__ __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="527"><td class="num" id="LN527">527</td><td class="line">            <span class='macro'>TINYFORMAT_ASSERT(m_formatImpl)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_formatImpl) ? void (0) : __assert_fail<br> ("m_formatImpl", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 527, __extension__ __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="528"><td class="num" id="LN528">528</td><td class="line">            m_formatImpl(out, fmtBegin, fmtEnd, ntrunc, m_value);</td></tr>
<tr class="codeline" data-linenumber="529"><td class="num" id="LN529">529</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="530"><td class="num" id="LN530">530</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="531"><td class="num" id="LN531">531</td><td class="line">        <span class='keyword'>int</span> toInt() <span class='keyword'>const</span></td></tr>
<tr class="codeline" data-linenumber="532"><td class="num" id="LN532">532</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="533"><td class="num" id="LN533">533</td><td class="line">            <span class='macro'>TINYFORMAT_ASSERT(m_value)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_value) ? void (0) : __assert_fail<br> ("m_value", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 533, __extension__ __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="534"><td class="num" id="LN534">534</td><td class="line">            <span class='macro'>TINYFORMAT_ASSERT(m_toIntImpl)<span class='macro_popup'>(static_cast &lt;bool&gt; (m_toIntImpl) ? void (0) : __assert_fail<br> ("m_toIntImpl", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 534, __extension__ __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="535"><td class="num" id="LN535">535</td><td class="line">            <span class='keyword'>return</span> m_toIntImpl(m_value);</td></tr>
<tr class="codeline" data-linenumber="536"><td class="num" id="LN536">536</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="537"><td class="num" id="LN537">537</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="538"><td class="num" id="LN538">538</td><td class="line">    <span class='keyword'>private</span>:</td></tr>
<tr class="codeline" data-linenumber="539"><td class="num" id="LN539">539</td><td class="line">        <span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="540"><td class="num" id="LN540">540</td><td class="line">        TINYFORMAT_HIDDEN <span class='keyword'>static</span> <span class='keyword'>void</span> formatImpl(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtBegin,</td></tr>
<tr class="codeline" data-linenumber="541"><td class="num" id="LN541">541</td><td class="line">                        <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtEnd, <span class='keyword'>int</span> ntrunc, <span class='keyword'>const</span> <span class='keyword'>void</span>* value)</td></tr>
<tr class="codeline" data-linenumber="542"><td class="num" id="LN542">542</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="543"><td class="num" id="LN543">543</td><td class="line">            formatValue(out, fmtBegin, fmtEnd, ntrunc, *<span class='keyword'>static_cast</span>&lt;<span class='keyword'>const</span> T*&gt;(value));</td></tr>
<tr class="codeline" data-linenumber="544"><td class="num" id="LN544">544</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="545"><td class="num" id="LN545">545</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="546"><td class="num" id="LN546">546</td><td class="line">        <span class='keyword'>template</span>&lt;<span class='keyword'>typename</span> T&gt;</td></tr>
<tr class="codeline" data-linenumber="547"><td class="num" id="LN547">547</td><td class="line">        TINYFORMAT_HIDDEN <span class='keyword'>static</span> <span class='keyword'>int</span> toIntImpl(<span class='keyword'>const</span> <span class='keyword'>void</span>* value)</td></tr>
<tr class="codeline" data-linenumber="548"><td class="num" id="LN548">548</td><td class="line">        {</td></tr>
<tr class="codeline" data-linenumber="549"><td class="num" id="LN549">549</td><td class="line">            <span class='keyword'>return</span> convertToInt&lt;T&gt;::invoke(*<span class='keyword'>static_cast</span>&lt;<span class='keyword'>const</span> T*&gt;(value));</td></tr>
<tr class="codeline" data-linenumber="550"><td class="num" id="LN550">550</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="551"><td class="num" id="LN551">551</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="552"><td class="num" id="LN552">552</td><td class="line">        <span class='keyword'>const</span> <span class='keyword'>void</span>* m_value;</td></tr>
<tr class="codeline" data-linenumber="553"><td class="num" id="LN553">553</td><td class="line">        <span class='keyword'>void</span> (*m_formatImpl)(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtBegin,</td></tr>
<tr class="codeline" data-linenumber="554"><td class="num" id="LN554">554</td><td class="line">                             <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtEnd, <span class='keyword'>int</span> ntrunc, <span class='keyword'>const</span> <span class='keyword'>void</span>* value);</td></tr>
<tr class="codeline" data-linenumber="555"><td class="num" id="LN555">555</td><td class="line">        <span class='keyword'>int</span> (*m_toIntImpl)(<span class='keyword'>const</span> <span class='keyword'>void</span>* value);</td></tr>
<tr class="codeline" data-linenumber="556"><td class="num" id="LN556">556</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="557"><td class="num" id="LN557">557</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="558"><td class="num" id="LN558">558</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="559"><td class="num" id="LN559">559</td><td class="line"><span class='comment'>// Parse and return an integer from the string c, as atoi()</span></td></tr>
<tr class="codeline" data-linenumber="560"><td class="num" id="LN560">560</td><td class="line"><span class='comment'>// On return, c is set to one past the end of the integer.</span></td></tr>
<tr class="codeline" data-linenumber="561"><td class="num" id="LN561">561</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>int</span> parseIntAndAdvance(<span class='keyword'>const</span> <span class='keyword'>char</span>*&amp; c)</td></tr>
<tr class="codeline" data-linenumber="562"><td class="num" id="LN562">562</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="563"><td class="num" id="LN563">563</td><td class="line">    <span class='keyword'>int</span> i = 0;</td></tr>
<tr class="codeline" data-linenumber="564"><td class="num" id="LN564">564</td><td class="line">    <span class='keyword'>for</span> (;*c &gt;= '0' &amp;&amp; *c &lt;= '9'; ++c)</td></tr>
<tr class="codeline" data-linenumber="565"><td class="num" id="LN565">565</td><td class="line">        i = 10*i + (*c - '0');</td></tr>
<tr class="codeline" data-linenumber="566"><td class="num" id="LN566">566</td><td class="line">    <span class='keyword'>return</span> i;</td></tr>
<tr class="codeline" data-linenumber="567"><td class="num" id="LN567">567</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="568"><td class="num" id="LN568">568</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="569"><td class="num" id="LN569">569</td><td class="line"><span class='comment'>// Parse width or precision `n` from format string pointer `c`, and advance it</span></td></tr>
<tr class="codeline" data-linenumber="570"><td class="num" id="LN570">570</td><td class="line"><span class='comment'>// to the next character. If an indirection is requested with `*`, the argument</span></td></tr>
<tr class="codeline" data-linenumber="571"><td class="num" id="LN571">571</td><td class="line"><span class='comment'>// is read from `args[argIndex]` and `argIndex` is incremented (or read</span></td></tr>
<tr class="codeline" data-linenumber="572"><td class="num" id="LN572">572</td><td class="line"><span class='comment'>// from `args[n]` in positional mode). Returns true if one or more</span></td></tr>
<tr class="codeline" data-linenumber="573"><td class="num" id="LN573">573</td><td class="line"><span class='comment'>// characters were read.</span></td></tr>
<tr class="codeline" data-linenumber="574"><td class="num" id="LN574">574</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>bool</span> parseWidthOrPrecision(<span class='keyword'>int</span>&amp; n, <span class='keyword'>const</span> <span class='keyword'>char</span>*&amp; c, <span class='keyword'>bool</span> positionalMode,</td></tr>
<tr class="codeline" data-linenumber="575"><td class="num" id="LN575">575</td><td class="line">                                  <span class='keyword'>const</span> detail::FormatArg* args,</td></tr>
<tr class="codeline" data-linenumber="576"><td class="num" id="LN576">576</td><td class="line">                                  <span class='keyword'>int</span>&amp; argIndex, <span class='keyword'>int</span> numArgs)</td></tr>
<tr class="codeline" data-linenumber="577"><td class="num" id="LN577">577</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="578"><td class="num" id="LN578">578</td><td class="line">    <span class='keyword'>if</span> (*c &gt;= '0' &amp;&amp; *c &lt;= '9') {</td></tr>
<tr class="codeline" data-linenumber="579"><td class="num" id="LN579">579</td><td class="line">        n = parseIntAndAdvance(c);</td></tr>
<tr class="codeline" data-linenumber="580"><td class="num" id="LN580">580</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="581"><td class="num" id="LN581">581</td><td class="line">    <span class='keyword'>else</span> <span class='keyword'>if</span> (*c == '*') {</td></tr>
<tr class="codeline" data-linenumber="582"><td class="num" id="LN582">582</td><td class="line">        ++c;</td></tr>
<tr class="codeline" data-linenumber="583"><td class="num" id="LN583">583</td><td class="line">        n = 0;</td></tr>
<tr class="codeline" data-linenumber="584"><td class="num" id="LN584">584</td><td class="line">        <span class='keyword'>if</span> (positionalMode) {</td></tr>
<tr class="codeline" data-linenumber="585"><td class="num" id="LN585">585</td><td class="line">            <span class='keyword'>int</span> pos = parseIntAndAdvance(c) - 1;</td></tr>
<tr class="codeline" data-linenumber="586"><td class="num" id="LN586">586</td><td class="line">            <span class='keyword'>if</span> (*c != '$')</td></tr>
<tr class="codeline" data-linenumber="587"><td class="num" id="LN587">587</td><td class="line">                <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Non-positional argument used after a positional one"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Non-positional argument used after a positional one"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="588"><td class="num" id="LN588">588</td><td class="line">            <span class='keyword'>if</span> (pos &gt;= 0 &amp;&amp; pos &lt; numArgs)</td></tr>
<tr class="codeline" data-linenumber="589"><td class="num" id="LN589">589</td><td class="line">                n = args[pos].toInt();</td></tr>
<tr class="codeline" data-linenumber="590"><td class="num" id="LN590">590</td><td class="line">            <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="591"><td class="num" id="LN591">591</td><td class="line">                <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Positional argument out of range"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Positional argument out of range"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="592"><td class="num" id="LN592">592</td><td class="line">            ++c;</td></tr>
<tr class="codeline" data-linenumber="593"><td class="num" id="LN593">593</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="594"><td class="num" id="LN594">594</td><td class="line">        <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="595"><td class="num" id="LN595">595</td><td class="line">            <span class='keyword'>if</span> (argIndex &lt; numArgs)</td></tr>
<tr class="codeline" data-linenumber="596"><td class="num" id="LN596">596</td><td class="line">                n = args[argIndex++].toInt();</td></tr>
<tr class="codeline" data-linenumber="597"><td class="num" id="LN597">597</td><td class="line">            <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="598"><td class="num" id="LN598">598</td><td class="line">                <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Not enough arguments to read variable width or precision"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Not enough arguments to read variable width or precision"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="599"><td class="num" id="LN599">599</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="600"><td class="num" id="LN600">600</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="601"><td class="num" id="LN601">601</td><td class="line">    <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="602"><td class="num" id="LN602">602</td><td class="line">        <span class='keyword'>return</span> <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="603"><td class="num" id="LN603">603</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="604"><td class="num" id="LN604">604</td><td class="line">    <span class='keyword'>return</span> <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="605"><td class="num" id="LN605">605</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="606"><td class="num" id="LN606">606</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="607"><td class="num" id="LN607">607</td><td class="line"><span class='comment'>// Print literal part of format string and return next format spec position.</span></td></tr>
<tr class="codeline" data-linenumber="608"><td class="num" id="LN608">608</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="609"><td class="num" id="LN609">609</td><td class="line"><span class='comment'>// Skips over any occurrences of '%%', printing a literal '%' to the output.</span></td></tr>
<tr class="codeline" data-linenumber="610"><td class="num" id="LN610">610</td><td class="line"><span class='comment'>// The position of the first % character of the next nontrivial format spec is</span></td></tr>
<tr class="codeline" data-linenumber="611"><td class="num" id="LN611">611</td><td class="line"><span class='comment'>// returned, or the end of string.</span></td></tr>
<tr class="codeline" data-linenumber="612"><td class="num" id="LN612">612</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>const</span> <span class='keyword'>char</span>* printFormatStringLiteral(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmt)</td></tr>
<tr class="codeline" data-linenumber="613"><td class="num" id="LN613">613</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="614"><td class="num" id="LN614">614</td><td class="line">    <span class='keyword'>const</span> <span class='keyword'>char</span>* c = fmt;</td></tr>
<tr class="codeline" data-linenumber="615"><td class="num" id="LN615">615</td><td class="line">    <span class='keyword'>for</span> (;; ++c) {</td></tr>
<tr class="codeline" data-linenumber="616"><td class="num" id="LN616">616</td><td class="line">        <span class='keyword'>if</span> (*c == '\0') {</td></tr>
<tr class="codeline" data-linenumber="617"><td class="num" id="LN617">617</td><td class="line">            out.write(fmt, c - fmt);</td></tr>
<tr class="codeline" data-linenumber="618"><td class="num" id="LN618">618</td><td class="line">            <span class='keyword'>return</span> c;</td></tr>
<tr class="codeline" data-linenumber="619"><td class="num" id="LN619">619</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="620"><td class="num" id="LN620">620</td><td class="line">        <span class='keyword'>else</span> <span class='keyword'>if</span> (*c == '%') {</td></tr>
<tr class="codeline" data-linenumber="621"><td class="num" id="LN621">621</td><td class="line">            out.write(fmt, c - fmt);</td></tr>
<tr class="codeline" data-linenumber="622"><td class="num" id="LN622">622</td><td class="line">            <span class='keyword'>if</span> (*(c+1) != '%')</td></tr>
<tr class="codeline" data-linenumber="623"><td class="num" id="LN623">623</td><td class="line">                <span class='keyword'>return</span> c;</td></tr>
<tr class="codeline" data-linenumber="624"><td class="num" id="LN624">624</td><td class="line">            <span class='comment'>// for "%%", tack trailing % onto next literal section.</span></td></tr>
<tr class="codeline" data-linenumber="625"><td class="num" id="LN625">625</td><td class="line">            fmt = ++c;</td></tr>
<tr class="codeline" data-linenumber="626"><td class="num" id="LN626">626</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="627"><td class="num" id="LN627">627</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="628"><td class="num" id="LN628">628</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="629"><td class="num" id="LN629">629</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="630"><td class="num" id="LN630">630</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="631"><td class="num" id="LN631">631</td><td class="line"><span class='comment'>// Parse a format string and set the stream state accordingly.</span></td></tr>
<tr class="codeline" data-linenumber="632"><td class="num" id="LN632">632</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="633"><td class="num" id="LN633">633</td><td class="line"><span class='comment'>// The format mini-language recognized here is meant to be the one from C99,</span></td></tr>
<tr class="codeline" data-linenumber="634"><td class="num" id="LN634">634</td><td class="line"><span class='comment'>// with the form "%[flags][width][.precision][length]type" with POSIX</span></td></tr>
<tr class="codeline" data-linenumber="635"><td class="num" id="LN635">635</td><td class="line"><span class='comment'>// positional arguments extension.</span></td></tr>
<tr class="codeline" data-linenumber="636"><td class="num" id="LN636">636</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="637"><td class="num" id="LN637">637</td><td class="line"><span class='comment'>// POSIX positional arguments extension:</span></td></tr>
<tr class="codeline" data-linenumber="638"><td class="num" id="LN638">638</td><td class="line"><span class='comment'>// Conversions can be applied to the nth argument after the format in</span></td></tr>
<tr class="codeline" data-linenumber="639"><td class="num" id="LN639">639</td><td class="line"><span class='comment'>// the argument list, rather than to the next unused argument. In this case,</span></td></tr>
<tr class="codeline" data-linenumber="640"><td class="num" id="LN640">640</td><td class="line"><span class='comment'>// the conversion specifier character % (see below) is replaced by the sequence</span></td></tr>
<tr class="codeline" data-linenumber="641"><td class="num" id="LN641">641</td><td class="line"><span class='comment'>// "%n$", where n is a decimal integer in the range [1,{NL_ARGMAX}],</span></td></tr>
<tr class="codeline" data-linenumber="642"><td class="num" id="LN642">642</td><td class="line"><span class='comment'>// giving the position of the argument in the argument list. This feature</span></td></tr>
<tr class="codeline" data-linenumber="643"><td class="num" id="LN643">643</td><td class="line"><span class='comment'>// provides for the definition of format strings that select arguments</span></td></tr>
<tr class="codeline" data-linenumber="644"><td class="num" id="LN644">644</td><td class="line"><span class='comment'>// in an order appropriate to specific languages.</span></td></tr>
<tr class="codeline" data-linenumber="645"><td class="num" id="LN645">645</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="646"><td class="num" id="LN646">646</td><td class="line"><span class='comment'>// The format can contain either numbered argument conversion specifications</span></td></tr>
<tr class="codeline" data-linenumber="647"><td class="num" id="LN647">647</td><td class="line"><span class='comment'>// (that is, "%n$" and "*m$"), or unnumbered argument conversion specifications</span></td></tr>
<tr class="codeline" data-linenumber="648"><td class="num" id="LN648">648</td><td class="line"><span class='comment'>// (that is, % and * ), but not both. The only exception to this is that %%</span></td></tr>
<tr class="codeline" data-linenumber="649"><td class="num" id="LN649">649</td><td class="line"><span class='comment'>// can be mixed with the "%n$" form. The results of mixing numbered and</span></td></tr>
<tr class="codeline" data-linenumber="650"><td class="num" id="LN650">650</td><td class="line"><span class='comment'>// unnumbered argument specifications in a format string are undefined.</span></td></tr>
<tr class="codeline" data-linenumber="651"><td class="num" id="LN651">651</td><td class="line"><span class='comment'>// When numbered argument specifications are used, specifying the Nth argument</span></td></tr>
<tr class="codeline" data-linenumber="652"><td class="num" id="LN652">652</td><td class="line"><span class='comment'>// requires that all the leading arguments, from the first to the (N-1)th,</span></td></tr>
<tr class="codeline" data-linenumber="653"><td class="num" id="LN653">653</td><td class="line"><span class='comment'>// are specified in the format string.</span></td></tr>
<tr class="codeline" data-linenumber="654"><td class="num" id="LN654">654</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="655"><td class="num" id="LN655">655</td><td class="line"><span class='comment'>// In format strings containing the "%n$" form of conversion specification,</span></td></tr>
<tr class="codeline" data-linenumber="656"><td class="num" id="LN656">656</td><td class="line"><span class='comment'>// numbered arguments in the argument list can be referenced from the format</span></td></tr>
<tr class="codeline" data-linenumber="657"><td class="num" id="LN657">657</td><td class="line"><span class='comment'>// string as many times as required.</span></td></tr>
<tr class="codeline" data-linenumber="658"><td class="num" id="LN658">658</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="659"><td class="num" id="LN659">659</td><td class="line"><span class='comment'>// Formatting options which can't be natively represented using the ostream</span></td></tr>
<tr class="codeline" data-linenumber="660"><td class="num" id="LN660">660</td><td class="line"><span class='comment'>// state are returned in spacePadPositive (for space padded positive numbers)</span></td></tr>
<tr class="codeline" data-linenumber="661"><td class="num" id="LN661">661</td><td class="line"><span class='comment'>// and ntrunc (for truncating conversions).  argIndex is incremented if</span></td></tr>
<tr class="codeline" data-linenumber="662"><td class="num" id="LN662">662</td><td class="line"><span class='comment'>// necessary to pull out variable width and precision.  The function returns a</span></td></tr>
<tr class="codeline" data-linenumber="663"><td class="num" id="LN663">663</td><td class="line"><span class='comment'>// pointer to the character after the end of the current format spec.</span></td></tr>
<tr class="codeline" data-linenumber="664"><td class="num" id="LN664">664</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>const</span> <span class='keyword'>char</span>* streamStateFromFormat(std::ostream&amp; out, <span class='keyword'>bool</span>&amp; positionalMode,</td></tr>
<tr class="codeline" data-linenumber="665"><td class="num" id="LN665">665</td><td class="line">                                         <span class='keyword'>bool</span>&amp; spacePadPositive,</td></tr>
<tr class="codeline" data-linenumber="666"><td class="num" id="LN666">666</td><td class="line">                                         <span class='keyword'>int</span>&amp; ntrunc, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtStart,</td></tr>
<tr class="codeline" data-linenumber="667"><td class="num" id="LN667">667</td><td class="line">                                         <span class='keyword'>const</span> detail::FormatArg* args,</td></tr>
<tr class="codeline" data-linenumber="668"><td class="num" id="LN668">668</td><td class="line">                                         <span class='keyword'>int</span>&amp; argIndex, <span class='keyword'>int</span> numArgs)</td></tr>
<tr class="codeline" data-linenumber="669"><td class="num" id="LN669">669</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="670"><td class="num" id="LN670">670</td><td class="line">    <span class='macro'>TINYFORMAT_ASSERT(*fmtStart == '%')<span class='macro_popup'>(static_cast &lt;bool&gt; (*fmtStart == '%') ? void (0) : __assert_fail<br> ("*fmtStart == '%'", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 670, __extension__ __PRETTY_FUNCTION__))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="671"><td class="num" id="LN671">671</td><td class="line">    <span class='comment'>// Reset stream state to defaults.</span></td></tr>
<tr class="codeline" data-linenumber="672"><td class="num" id="LN672">672</td><td class="line">    out.width(0);</td></tr>
<tr class="codeline" data-linenumber="673"><td class="num" id="LN673">673</td><td class="line">    out.precision(6);</td></tr>
<tr class="codeline" data-linenumber="674"><td class="num" id="LN674">674</td><td class="line">    out.fill(' ');</td></tr>
<tr class="codeline" data-linenumber="675"><td class="num" id="LN675">675</td><td class="line">    <span class='comment'>// Reset most flags; ignore irrelevant unitbuf &amp; skipws.</span></td></tr>
<tr class="codeline" data-linenumber="676"><td class="num" id="LN676">676</td><td class="line">    out.unsetf(std::ios::adjustfield | std::ios::basefield |</td></tr>
<tr class="codeline" data-linenumber="677"><td class="num" id="LN677">677</td><td class="line">               std::ios::floatfield | std::ios::showbase | std::ios::boolalpha |</td></tr>
<tr class="codeline" data-linenumber="678"><td class="num" id="LN678">678</td><td class="line">               std::ios::showpoint | std::ios::showpos | std::ios::uppercase);</td></tr>
<tr class="codeline" data-linenumber="679"><td class="num" id="LN679">679</td><td class="line">    <span class='keyword'>bool</span> precisionSet = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="680"><td class="num" id="LN680">680</td><td class="line">    <span class='keyword'>bool</span> widthSet = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="681"><td class="num" id="LN681">681</td><td class="line">    <span class='keyword'>int</span> widthExtra = 0;</td></tr>
<tr class="codeline" data-linenumber="682"><td class="num" id="LN682">682</td><td class="line">    <span class='keyword'>const</span> <span class='keyword'>char</span>* c = fmtStart + 1;</td></tr>
<tr class="codeline" data-linenumber="683"><td class="num" id="LN683">683</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="684"><td class="num" id="LN684">684</td><td class="line">    <span class='comment'>// 1) Parse an argument index (if followed by '$') or a width possibly</span></td></tr>
<tr class="codeline" data-linenumber="685"><td class="num" id="LN685">685</td><td class="line">    <span class='comment'>// preceded with '0' flag.</span></td></tr>
<tr class="codeline" data-linenumber="686"><td class="num" id="LN686">686</td><td class="line">    <span class='keyword'>if</span> (*c &gt;= '0' &amp;&amp; *c &lt;= '9') {</td></tr>
<tr class="codeline" data-linenumber="687"><td class="num" id="LN687">687</td><td class="line">        <span class='keyword'>const</span> <span class='keyword'>char</span> tmpc = *c;</td></tr>
<tr class="codeline" data-linenumber="688"><td class="num" id="LN688">688</td><td class="line">        <span class='keyword'>int</span> value = parseIntAndAdvance(c);</td></tr>
<tr class="codeline" data-linenumber="689"><td class="num" id="LN689">689</td><td class="line">        <span class='keyword'>if</span> (*c == '$') {</td></tr>
<tr class="codeline" data-linenumber="690"><td class="num" id="LN690">690</td><td class="line">            <span class='comment'>// value is an argument index</span></td></tr>
<tr class="codeline" data-linenumber="691"><td class="num" id="LN691">691</td><td class="line">            <span class='keyword'>if</span> (value &gt; 0 &amp;&amp; value &lt;= numArgs)</td></tr>
<tr class="codeline" data-linenumber="692"><td class="num" id="LN692">692</td><td class="line">                argIndex = value - 1;</td></tr>
<tr class="codeline" data-linenumber="693"><td class="num" id="LN693">693</td><td class="line">            <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="694"><td class="num" id="LN694">694</td><td class="line">                <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Positional argument out of range"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Positional argument out of range"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="695"><td class="num" id="LN695">695</td><td class="line">            ++c;</td></tr>
<tr class="codeline" data-linenumber="696"><td class="num" id="LN696">696</td><td class="line">            positionalMode = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="697"><td class="num" id="LN697">697</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="698"><td class="num" id="LN698">698</td><td class="line">        <span class='keyword'>else</span> <span class='keyword'>if</span> (positionalMode) {</td></tr>
<tr class="codeline" data-linenumber="699"><td class="num" id="LN699">699</td><td class="line">            <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Non-positional argument used after a positional one"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Non-positional argument used after a positional one"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="700"><td class="num" id="LN700">700</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="701"><td class="num" id="LN701">701</td><td class="line">        <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="702"><td class="num" id="LN702">702</td><td class="line">            <span class='keyword'>if</span> (tmpc == '0') {</td></tr>
<tr class="codeline" data-linenumber="703"><td class="num" id="LN703">703</td><td class="line">                <span class='comment'>// Use internal padding so that numeric values are</span></td></tr>
<tr class="codeline" data-linenumber="704"><td class="num" id="LN704">704</td><td class="line">                <span class='comment'>// formatted correctly, eg -00010 rather than 000-10</span></td></tr>
<tr class="codeline" data-linenumber="705"><td class="num" id="LN705">705</td><td class="line">                out.fill('0');</td></tr>
<tr class="codeline" data-linenumber="706"><td class="num" id="LN706">706</td><td class="line">                out.setf(std::ios::internal, std::ios::adjustfield);</td></tr>
<tr class="codeline" data-linenumber="707"><td class="num" id="LN707">707</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="708"><td class="num" id="LN708">708</td><td class="line">            <span class='keyword'>if</span> (value != 0) {</td></tr>
<tr class="codeline" data-linenumber="709"><td class="num" id="LN709">709</td><td class="line">                <span class='comment'>// Nonzero value means that we parsed width.</span></td></tr>
<tr class="codeline" data-linenumber="710"><td class="num" id="LN710">710</td><td class="line">                widthSet = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="711"><td class="num" id="LN711">711</td><td class="line">                out.width(value);</td></tr>
<tr class="codeline" data-linenumber="712"><td class="num" id="LN712">712</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="713"><td class="num" id="LN713">713</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="714"><td class="num" id="LN714">714</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="715"><td class="num" id="LN715">715</td><td class="line">    <span class='keyword'>else</span> <span class='keyword'>if</span> (positionalMode) {</td></tr>
<tr class="codeline" data-linenumber="716"><td class="num" id="LN716">716</td><td class="line">        <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Non-positional argument used after a positional one"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Non-positional argument used after a positional one"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="717"><td class="num" id="LN717">717</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="718"><td class="num" id="LN718">718</td><td class="line">    <span class='comment'>// 2) Parse flags and width if we did not do it in previous step.</span></td></tr>
<tr class="codeline" data-linenumber="719"><td class="num" id="LN719">719</td><td class="line">    <span class='keyword'>if</span> (!widthSet) {</td></tr>
<tr class="codeline" data-linenumber="720"><td class="num" id="LN720">720</td><td class="line">        <span class='comment'>// Parse flags</span></td></tr>
<tr class="codeline" data-linenumber="721"><td class="num" id="LN721">721</td><td class="line">        <span class='keyword'>for</span> (;; ++c) {</td></tr>
<tr class="codeline" data-linenumber="722"><td class="num" id="LN722">722</td><td class="line">            <span class='keyword'>switch</span> (*c) {</td></tr>
<tr class="codeline" data-linenumber="723"><td class="num" id="LN723">723</td><td class="line">                <span class='keyword'>case</span> '#':</td></tr>
<tr class="codeline" data-linenumber="724"><td class="num" id="LN724">724</td><td class="line">                    out.setf(std::ios::showpoint | std::ios::showbase);</td></tr>
<tr class="codeline" data-linenumber="725"><td class="num" id="LN725">725</td><td class="line">                    <span class='keyword'>continue</span>;</td></tr>
<tr class="codeline" data-linenumber="726"><td class="num" id="LN726">726</td><td class="line">                <span class='keyword'>case</span> '0':</td></tr>
<tr class="codeline" data-linenumber="727"><td class="num" id="LN727">727</td><td class="line">                    <span class='comment'>// overridden by left alignment ('-' flag)</span></td></tr>
<tr class="codeline" data-linenumber="728"><td class="num" id="LN728">728</td><td class="line">                    <span class='keyword'>if</span> (!(out.flags() &amp; std::ios::left)) {</td></tr>
<tr class="codeline" data-linenumber="729"><td class="num" id="LN729">729</td><td class="line">                        <span class='comment'>// Use internal padding so that numeric values are</span></td></tr>
<tr class="codeline" data-linenumber="730"><td class="num" id="LN730">730</td><td class="line">                        <span class='comment'>// formatted correctly, eg -00010 rather than 000-10</span></td></tr>
<tr class="codeline" data-linenumber="731"><td class="num" id="LN731">731</td><td class="line">                        out.fill('0');</td></tr>
<tr class="codeline" data-linenumber="732"><td class="num" id="LN732">732</td><td class="line">                        out.setf(std::ios::internal, std::ios::adjustfield);</td></tr>
<tr class="codeline" data-linenumber="733"><td class="num" id="LN733">733</td><td class="line">                    }</td></tr>
<tr class="codeline" data-linenumber="734"><td class="num" id="LN734">734</td><td class="line">                    <span class='keyword'>continue</span>;</td></tr>
<tr class="codeline" data-linenumber="735"><td class="num" id="LN735">735</td><td class="line">                <span class='keyword'>case</span> '-':</td></tr>
<tr class="codeline" data-linenumber="736"><td class="num" id="LN736">736</td><td class="line">                    out.fill(' ');</td></tr>
<tr class="codeline" data-linenumber="737"><td class="num" id="LN737">737</td><td class="line">                    out.setf(std::ios::left, std::ios::adjustfield);</td></tr>
<tr class="codeline" data-linenumber="738"><td class="num" id="LN738">738</td><td class="line">                    <span class='keyword'>continue</span>;</td></tr>
<tr class="codeline" data-linenumber="739"><td class="num" id="LN739">739</td><td class="line">                <span class='keyword'>case</span> ' ':</td></tr>
<tr class="codeline" data-linenumber="740"><td class="num" id="LN740">740</td><td class="line">                    <span class='comment'>// overridden by show positive sign, '+' flag.</span></td></tr>
<tr class="codeline" data-linenumber="741"><td class="num" id="LN741">741</td><td class="line">                    <span class='keyword'>if</span> (!(out.flags() &amp; std::ios::showpos))</td></tr>
<tr class="codeline" data-linenumber="742"><td class="num" id="LN742">742</td><td class="line">                        spacePadPositive = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="743"><td class="num" id="LN743">743</td><td class="line">                    <span class='keyword'>continue</span>;</td></tr>
<tr class="codeline" data-linenumber="744"><td class="num" id="LN744">744</td><td class="line">                <span class='keyword'>case</span> '+':</td></tr>
<tr class="codeline" data-linenumber="745"><td class="num" id="LN745">745</td><td class="line">                    out.setf(std::ios::showpos);</td></tr>
<tr class="codeline" data-linenumber="746"><td class="num" id="LN746">746</td><td class="line">                    spacePadPositive = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="747"><td class="num" id="LN747">747</td><td class="line">                    widthExtra = 1;</td></tr>
<tr class="codeline" data-linenumber="748"><td class="num" id="LN748">748</td><td class="line">                    <span class='keyword'>continue</span>;</td></tr>
<tr class="codeline" data-linenumber="749"><td class="num" id="LN749">749</td><td class="line">                <span class='keyword'>default</span>:</td></tr>
<tr class="codeline" data-linenumber="750"><td class="num" id="LN750">750</td><td class="line">                    <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="751"><td class="num" id="LN751">751</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="752"><td class="num" id="LN752">752</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="753"><td class="num" id="LN753">753</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="754"><td class="num" id="LN754">754</td><td class="line">        <span class='comment'>// Parse width</span></td></tr>
<tr class="codeline" data-linenumber="755"><td class="num" id="LN755">755</td><td class="line">        <span class='keyword'>int</span> width = 0;</td></tr>
<tr class="codeline" data-linenumber="756"><td class="num" id="LN756">756</td><td class="line">        widthSet = parseWidthOrPrecision(width, c, positionalMode,</td></tr>
<tr class="codeline" data-linenumber="757"><td class="num" id="LN757">757</td><td class="line">                                         args, argIndex, numArgs);</td></tr>
<tr class="codeline" data-linenumber="758"><td class="num" id="LN758">758</td><td class="line">        <span class='keyword'>if</span> (widthSet) {</td></tr>
<tr class="codeline" data-linenumber="759"><td class="num" id="LN759">759</td><td class="line">            <span class='keyword'>if</span> (width &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="760"><td class="num" id="LN760">760</td><td class="line">                <span class='comment'>// negative widths correspond to '-' flag set</span></td></tr>
<tr class="codeline" data-linenumber="761"><td class="num" id="LN761">761</td><td class="line">                out.fill(' ');</td></tr>
<tr class="codeline" data-linenumber="762"><td class="num" id="LN762">762</td><td class="line">                out.setf(std::ios::left, std::ios::adjustfield);</td></tr>
<tr class="codeline" data-linenumber="763"><td class="num" id="LN763">763</td><td class="line">                width = -width;</td></tr>
<tr class="codeline" data-linenumber="764"><td class="num" id="LN764">764</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="765"><td class="num" id="LN765">765</td><td class="line">            out.width(width);</td></tr>
<tr class="codeline" data-linenumber="766"><td class="num" id="LN766">766</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="767"><td class="num" id="LN767">767</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="768"><td class="num" id="LN768">768</td><td class="line">    <span class='comment'>// 3) Parse precision</span></td></tr>
<tr class="codeline" data-linenumber="769"><td class="num" id="LN769">769</td><td class="line">    <span class='keyword'>if</span> (*c == '.') {</td></tr>
<tr class="codeline" data-linenumber="770"><td class="num" id="LN770">770</td><td class="line">        ++c;</td></tr>
<tr class="codeline" data-linenumber="771"><td class="num" id="LN771">771</td><td class="line">        <span class='keyword'>int</span> precision = 0;</td></tr>
<tr class="codeline" data-linenumber="772"><td class="num" id="LN772">772</td><td class="line">        parseWidthOrPrecision(precision, c, positionalMode,</td></tr>
<tr class="codeline" data-linenumber="773"><td class="num" id="LN773">773</td><td class="line">                              args, argIndex, numArgs);</td></tr>
<tr class="codeline" data-linenumber="774"><td class="num" id="LN774">774</td><td class="line">        <span class='comment'>// Presence of `.` indicates precision set, unless the inferred value</span></td></tr>
<tr class="codeline" data-linenumber="775"><td class="num" id="LN775">775</td><td class="line">        <span class='comment'>// was negative in which case the default is used.</span></td></tr>
<tr class="codeline" data-linenumber="776"><td class="num" id="LN776">776</td><td class="line">        precisionSet = precision &gt;= 0;</td></tr>
<tr class="codeline" data-linenumber="777"><td class="num" id="LN777">777</td><td class="line">        <span class='keyword'>if</span> (precisionSet)</td></tr>
<tr class="codeline" data-linenumber="778"><td class="num" id="LN778">778</td><td class="line">            out.precision(precision);</td></tr>
<tr class="codeline" data-linenumber="779"><td class="num" id="LN779">779</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="780"><td class="num" id="LN780">780</td><td class="line">    <span class='comment'>// 4) Ignore any C99 length modifier</span></td></tr>
<tr class="codeline" data-linenumber="781"><td class="num" id="LN781">781</td><td class="line">    <span class='keyword'>while</span> (*c == 'l' || *c == 'h' || *c == 'L' ||</td></tr>
<tr class="codeline" data-linenumber="782"><td class="num" id="LN782">782</td><td class="line">           *c == 'j' || *c == 'z' || *c == 't') {</td></tr>
<tr class="codeline" data-linenumber="783"><td class="num" id="LN783">783</td><td class="line">        ++c;</td></tr>
<tr class="codeline" data-linenumber="784"><td class="num" id="LN784">784</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="785"><td class="num" id="LN785">785</td><td class="line">    <span class='comment'>// 5) We're up to the conversion specifier character.</span></td></tr>
<tr class="codeline" data-linenumber="786"><td class="num" id="LN786">786</td><td class="line">    <span class='comment'>// Set stream flags based on conversion specifier (thanks to the</span></td></tr>
<tr class="codeline" data-linenumber="787"><td class="num" id="LN787">787</td><td class="line">    <span class='comment'>// boost::format class for forging the way here).</span></td></tr>
<tr class="codeline" data-linenumber="788"><td class="num" id="LN788">788</td><td class="line">    <span class='keyword'>bool</span> intConversion = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="789"><td class="num" id="LN789">789</td><td class="line">    <span class='keyword'>switch</span> (*c) {</td></tr>
<tr class="codeline" data-linenumber="790"><td class="num" id="LN790">790</td><td class="line">        <span class='keyword'>case</span> 'u': <span class='keyword'>case</span> 'd': <span class='keyword'>case</span> 'i':</td></tr>
<tr class="codeline" data-linenumber="791"><td class="num" id="LN791">791</td><td class="line">            out.setf(std::ios::dec, std::ios::basefield);</td></tr>
<tr class="codeline" data-linenumber="792"><td class="num" id="LN792">792</td><td class="line">            intConversion = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="793"><td class="num" id="LN793">793</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="794"><td class="num" id="LN794">794</td><td class="line">        <span class='keyword'>case</span> 'o':</td></tr>
<tr class="codeline" data-linenumber="795"><td class="num" id="LN795">795</td><td class="line">            out.setf(std::ios::oct, std::ios::basefield);</td></tr>
<tr class="codeline" data-linenumber="796"><td class="num" id="LN796">796</td><td class="line">            intConversion = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="797"><td class="num" id="LN797">797</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="798"><td class="num" id="LN798">798</td><td class="line">        <span class='keyword'>case</span> 'X':</td></tr>
<tr class="codeline" data-linenumber="799"><td class="num" id="LN799">799</td><td class="line">            out.setf(std::ios::uppercase);</td></tr>
<tr class="codeline" data-linenumber="800"><td class="num" id="LN800">800</td><td class="line">            <span class='comment'>// Falls through</span></td></tr>
<tr class="codeline" data-linenumber="801"><td class="num" id="LN801">801</td><td class="line">        <span class='keyword'>case</span> 'x': <span class='keyword'>case</span> 'p':</td></tr>
<tr class="codeline" data-linenumber="802"><td class="num" id="LN802">802</td><td class="line">            out.setf(std::ios::hex, std::ios::basefield);</td></tr>
<tr class="codeline" data-linenumber="803"><td class="num" id="LN803">803</td><td class="line">            intConversion = <span class='keyword'>true</span>;</td></tr>
<tr class="codeline" data-linenumber="804"><td class="num" id="LN804">804</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="805"><td class="num" id="LN805">805</td><td class="line">        <span class='keyword'>case</span> 'E':</td></tr>
<tr class="codeline" data-linenumber="806"><td class="num" id="LN806">806</td><td class="line">            out.setf(std::ios::uppercase);</td></tr>
<tr class="codeline" data-linenumber="807"><td class="num" id="LN807">807</td><td class="line">            <span class='comment'>// Falls through</span></td></tr>
<tr class="codeline" data-linenumber="808"><td class="num" id="LN808">808</td><td class="line">        <span class='keyword'>case</span> 'e':</td></tr>
<tr class="codeline" data-linenumber="809"><td class="num" id="LN809">809</td><td class="line">            out.setf(std::ios::scientific, std::ios::floatfield);</td></tr>
<tr class="codeline" data-linenumber="810"><td class="num" id="LN810">810</td><td class="line">            out.setf(std::ios::dec, std::ios::basefield);</td></tr>
<tr class="codeline" data-linenumber="811"><td class="num" id="LN811">811</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="812"><td class="num" id="LN812">812</td><td class="line">        <span class='keyword'>case</span> 'F':</td></tr>
<tr class="codeline" data-linenumber="813"><td class="num" id="LN813">813</td><td class="line">            out.setf(std::ios::uppercase);</td></tr>
<tr class="codeline" data-linenumber="814"><td class="num" id="LN814">814</td><td class="line">            <span class='comment'>// Falls through</span></td></tr>
<tr class="codeline" data-linenumber="815"><td class="num" id="LN815">815</td><td class="line">        <span class='keyword'>case</span> 'f':</td></tr>
<tr class="codeline" data-linenumber="816"><td class="num" id="LN816">816</td><td class="line">            out.setf(std::ios::fixed, std::ios::floatfield);</td></tr>
<tr class="codeline" data-linenumber="817"><td class="num" id="LN817">817</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="818"><td class="num" id="LN818">818</td><td class="line">        <span class='keyword'>case</span> 'A':</td></tr>
<tr class="codeline" data-linenumber="819"><td class="num" id="LN819">819</td><td class="line">            out.setf(std::ios::uppercase);</td></tr>
<tr class="codeline" data-linenumber="820"><td class="num" id="LN820">820</td><td class="line">            <span class='comment'>// Falls through</span></td></tr>
<tr class="codeline" data-linenumber="821"><td class="num" id="LN821">821</td><td class="line">        <span class='keyword'>case</span> 'a':</td></tr>
<tr class="codeline" data-linenumber="822"><td class="num" id="LN822">822</td><td class="line"><span class='directive'>#           ifdef _MSC_VER</span></td></tr>
<tr class="codeline" data-linenumber="823"><td class="num" id="LN823">823</td><td class="line">            <span class='comment'>// Workaround https://developercommunity.visualstudio.com/content/problem/520472/hexfloat-stream-output-does-not-ignore-precision-a.html</span></td></tr>
<tr class="codeline" data-linenumber="824"><td class="num" id="LN824">824</td><td class="line">            <span class='comment'>// by always setting maximum precision on MSVC to avoid precision</span></td></tr>
<tr class="codeline" data-linenumber="825"><td class="num" id="LN825">825</td><td class="line">            <span class='comment'>// loss for doubles.</span></td></tr>
<tr class="codeline" data-linenumber="826"><td class="num" id="LN826">826</td><td class="line">            out.precision(13);</td></tr>
<tr class="codeline" data-linenumber="827"><td class="num" id="LN827">827</td><td class="line"><span class='directive'>#           endif</span></td></tr>
<tr class="codeline" data-linenumber="828"><td class="num" id="LN828">828</td><td class="line">            out.setf(std::ios::fixed | std::ios::scientific, std::ios::floatfield);</td></tr>
<tr class="codeline" data-linenumber="829"><td class="num" id="LN829">829</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="830"><td class="num" id="LN830">830</td><td class="line">        <span class='keyword'>case</span> 'G':</td></tr>
<tr class="codeline" data-linenumber="831"><td class="num" id="LN831">831</td><td class="line">            out.setf(std::ios::uppercase);</td></tr>
<tr class="codeline" data-linenumber="832"><td class="num" id="LN832">832</td><td class="line">            <span class='comment'>// Falls through</span></td></tr>
<tr class="codeline" data-linenumber="833"><td class="num" id="LN833">833</td><td class="line">        <span class='keyword'>case</span> 'g':</td></tr>
<tr class="codeline" data-linenumber="834"><td class="num" id="LN834">834</td><td class="line">            out.setf(std::ios::dec, std::ios::basefield);</td></tr>
<tr class="codeline" data-linenumber="835"><td class="num" id="LN835">835</td><td class="line">            <span class='comment'>// As in boost::format, let stream decide float format.</span></td></tr>
<tr class="codeline" data-linenumber="836"><td class="num" id="LN836">836</td><td class="line">            out.flags(out.flags() &amp; ~std::ios::floatfield);</td></tr>
<tr class="codeline" data-linenumber="837"><td class="num" id="LN837">837</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="838"><td class="num" id="LN838">838</td><td class="line">        <span class='keyword'>case</span> 'c':</td></tr>
<tr class="codeline" data-linenumber="839"><td class="num" id="LN839">839</td><td class="line">            <span class='comment'>// Handled as special case inside formatValue()</span></td></tr>
<tr class="codeline" data-linenumber="840"><td class="num" id="LN840">840</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="841"><td class="num" id="LN841">841</td><td class="line">        <span class='keyword'>case</span> 's':</td></tr>
<tr class="codeline" data-linenumber="842"><td class="num" id="LN842">842</td><td class="line">            <span class='keyword'>if</span> (precisionSet)</td></tr>
<tr class="codeline" data-linenumber="843"><td class="num" id="LN843">843</td><td class="line">                ntrunc = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(out.precision());</td></tr>
<tr class="codeline" data-linenumber="844"><td class="num" id="LN844">844</td><td class="line">            <span class='comment'>// Make %s print Booleans as "true" and "false"</span></td></tr>
<tr class="codeline" data-linenumber="845"><td class="num" id="LN845">845</td><td class="line">            out.setf(std::ios::boolalpha);</td></tr>
<tr class="codeline" data-linenumber="846"><td class="num" id="LN846">846</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="847"><td class="num" id="LN847">847</td><td class="line">        <span class='keyword'>case</span> 'n':</td></tr>
<tr class="codeline" data-linenumber="848"><td class="num" id="LN848">848</td><td class="line">            <span class='comment'>// Not supported - will cause problems!</span></td></tr>
<tr class="codeline" data-linenumber="849"><td class="num" id="LN849">849</td><td class="line">            <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: %n conversion spec not supported"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: %n conversion spec not supported"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="850"><td class="num" id="LN850">850</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="851"><td class="num" id="LN851">851</td><td class="line">        <span class='keyword'>case</span> '\0':</td></tr>
<tr class="codeline" data-linenumber="852"><td class="num" id="LN852">852</td><td class="line">            <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Conversion spec incorrectly "<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Conversion spec incorrectly "<br> "terminated by end of string")</span></span></span></td></tr>
<tr class="codeline" data-linenumber="853"><td class="num" id="LN853">853</td><td class="line">                             <span class='string_literal'><span class='macro'>"terminated by end of string"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Conversion spec incorrectly "<br> "terminated by end of string")</span></span>;</td></tr>
<tr class="codeline" data-linenumber="854"><td class="num" id="LN854">854</td><td class="line">            <span class='keyword'>return</span> c;</td></tr>
<tr class="codeline" data-linenumber="855"><td class="num" id="LN855">855</td><td class="line">        <span class='keyword'>default</span>:</td></tr>
<tr class="codeline" data-linenumber="856"><td class="num" id="LN856">856</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="857"><td class="num" id="LN857">857</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="858"><td class="num" id="LN858">858</td><td class="line">    <span class='keyword'>if</span> (intConversion &amp;&amp; precisionSet &amp;&amp; !widthSet) {</td></tr>
<tr class="codeline" data-linenumber="859"><td class="num" id="LN859">859</td><td class="line">        <span class='comment'>// "precision" for integers gives the minimum number of digits (to be</span></td></tr>
<tr class="codeline" data-linenumber="860"><td class="num" id="LN860">860</td><td class="line">        <span class='comment'>// padded with zeros on the left).  This isn't really supported by the</span></td></tr>
<tr class="codeline" data-linenumber="861"><td class="num" id="LN861">861</td><td class="line">        <span class='comment'>// iostreams, but we can approximately simulate it with the width if</span></td></tr>
<tr class="codeline" data-linenumber="862"><td class="num" id="LN862">862</td><td class="line">        <span class='comment'>// the width isn't otherwise used.</span></td></tr>
<tr class="codeline" data-linenumber="863"><td class="num" id="LN863">863</td><td class="line">        out.width(out.precision() + widthExtra);</td></tr>
<tr class="codeline" data-linenumber="864"><td class="num" id="LN864">864</td><td class="line">        out.setf(std::ios::internal, std::ios::adjustfield);</td></tr>
<tr class="codeline" data-linenumber="865"><td class="num" id="LN865">865</td><td class="line">        out.fill('0');</td></tr>
<tr class="codeline" data-linenumber="866"><td class="num" id="LN866">866</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="867"><td class="num" id="LN867">867</td><td class="line">    <span class='keyword'>return</span> c+1;</td></tr>
<tr class="codeline" data-linenumber="868"><td class="num" id="LN868">868</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="869"><td class="num" id="LN869">869</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="870"><td class="num" id="LN870">870</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="871"><td class="num" id="LN871">871</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="872"><td class="num" id="LN872">872</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> formatImpl(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmt,</td></tr>
<tr class="codeline" data-linenumber="873"><td class="num" id="LN873">873</td><td class="line">                       <span class='keyword'>const</span> detail::FormatArg* args,</td></tr>
<tr class="codeline" data-linenumber="874"><td class="num" id="LN874">874</td><td class="line">                       <span class='keyword'>int</span> numArgs)</td></tr>
<tr class="codeline" data-linenumber="875"><td class="num" id="LN875">875</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="876"><td class="num" id="LN876">876</td><td class="line">    <span class='comment'>// Saved stream state</span></td></tr>
<tr class="codeline" data-linenumber="877"><td class="num" id="LN877">877</td><td class="line">    std::streamsize origWidth = out.width();</td></tr>
<tr class="codeline" data-linenumber="878"><td class="num" id="LN878">878</td><td class="line">    std::streamsize origPrecision = out.precision();</td></tr>
<tr class="codeline" data-linenumber="879"><td class="num" id="LN879">879</td><td class="line">    std::ios::fmtflags origFlags = out.flags();</td></tr>
<tr class="codeline" data-linenumber="880"><td class="num" id="LN880">880</td><td class="line">    <span class='keyword'>char</span> origFill = out.fill();</td></tr>
<tr class="codeline" data-linenumber="881"><td class="num" id="LN881">881</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="882"><td class="num" id="LN882">882</td><td class="line">    <span class='comment'>// "Positional mode" means all format specs should be of the form "%n$..."</span></td></tr>
<tr class="codeline" data-linenumber="883"><td class="num" id="LN883">883</td><td class="line">    <span class='comment'>// with `n` an integer. We detect this in `streamStateFromFormat`.</span></td></tr>
<tr class="codeline" data-linenumber="884"><td class="num" id="LN884">884</td><td class="line">    <span class='keyword'>bool</span> positionalMode = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="885"><td class="num" id="LN885">885</td><td class="line">    <span class='keyword'>int</span> argIndex = 0;</td></tr>
<tr class="codeline" data-linenumber="886"><td class="num" id="LN886">886</td><td class="line">    <span class='keyword'>while</span> (<span class='keyword'>true</span>) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path19" class="msg msgControl" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">19</div></td><td><div class="PathNav"><a href="#Path18" title="Previous event (18)">&#x2190;</a></div></td><td>Loop condition is true.  Entering loop body</td><td><div class="PathNav"><a href="#Path20" title="Next event (20)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="887"><td class="num" id="LN887">887</td><td class="line">        fmt = printFormatStringLiteral(out, fmt);</td></tr>
<tr class="codeline" data-linenumber="888"><td class="num" id="LN888">888</td><td class="line">        <span class='keyword'>if</span> (<span class="mrange">*fmt == '\0') {</td></tr></span>
<tr><td class="num"></td><td class="line"><div id="Path20" class="msg msgEvent" style="margin-left:13ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">20</div></td><td><div class="PathNav"><a href="#Path19" title="Previous event (19)">&#x2190;</a></div></td><td>Assuming the condition is true</td><td><div class="PathNav"><a href="#Path21" title="Next event (21)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path21" class="msg msgControl" style="margin-left:9ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">21</div></td><td><div class="PathNav"><a href="#Path20" title="Previous event (20)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#Path22" title="Next event (22)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="889"><td class="num" id="LN889">889</td><td class="line">            <span class='keyword'>if</span> (!<span class='variable'><span class='variable'><span class='variable'><span class='variable'>positionalMode<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.1</div></td><td>'positionalMode' is false</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.1</div></td><td>'positionalMode' is false</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.1</div></td><td>'positionalMode' is false</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.1</div></td><td>'positionalMode' is false</td></tr></tbody></table></span> &amp;&amp; <span class='variable'><span class='variable'><span class='variable'><span class='variable'>argIndex<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.2</div></td><td>'argIndex' is < 'numArgs'</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.2</div></td><td>'argIndex' is < 'numArgs'</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.2</div></td><td>'argIndex' is < 'numArgs'</td></tr></tbody></table></span><table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.2</div></td><td>'argIndex' is < 'numArgs'</td></tr></tbody></table></span> &lt; numArgs) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path22" class="msg msgControl" style="margin-left:13ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">22</div></td><td><div class="PathNav"><a href="#Path21" title="Previous event (21)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#Path23" title="Next event (23)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="890"><td class="num" id="LN890">890</td><td class="line">                <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Not enough conversion specifiers in format string"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Not enough conversion specifiers in format string"<br>)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path23" class="msg msgEvent" style="margin-left:17ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">23</div></td><td><div class="PathNav"><a href="#Path22" title="Previous event (22)">&#x2190;</a></div></td><td>Throwing exception</td><td><div class="PathNav"><a href="#Path24" title="Next event (24)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="891"><td class="num" id="LN891">891</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="892"><td class="num" id="LN892">892</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="893"><td class="num" id="LN893">893</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="894"><td class="num" id="LN894">894</td><td class="line">        <span class='keyword'>bool</span> spacePadPositive = <span class='keyword'>false</span>;</td></tr>
<tr class="codeline" data-linenumber="895"><td class="num" id="LN895">895</td><td class="line">        <span class='keyword'>int</span> ntrunc = -1;</td></tr>
<tr class="codeline" data-linenumber="896"><td class="num" id="LN896">896</td><td class="line">        <span class='keyword'>const</span> <span class='keyword'>char</span>* fmtEnd = streamStateFromFormat(out, positionalMode, spacePadPositive, ntrunc, fmt,</td></tr>
<tr class="codeline" data-linenumber="897"><td class="num" id="LN897">897</td><td class="line">                                                   args, argIndex, numArgs);</td></tr>
<tr class="codeline" data-linenumber="898"><td class="num" id="LN898">898</td><td class="line">        <span class='comment'>// NB: argIndex may be incremented by reading variable width/precision</span></td></tr>
<tr class="codeline" data-linenumber="899"><td class="num" id="LN899">899</td><td class="line">        <span class='comment'>// in `streamStateFromFormat`, so do the bounds check here.</span></td></tr>
<tr class="codeline" data-linenumber="900"><td class="num" id="LN900">900</td><td class="line">        <span class='keyword'>if</span> (argIndex &gt;= numArgs) {</td></tr>
<tr class="codeline" data-linenumber="901"><td class="num" id="LN901">901</td><td class="line">            <span class='macro'>TINYFORMAT_ERROR(<span class='string_literal'>"tinyformat: Too many conversion specifiers in format string"</span>)<span class='macro_popup'>throw tinyformat::format_error("tinyformat: Too many conversion specifiers in format string"<br>)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="902"><td class="num" id="LN902">902</td><td class="line">            <span class='keyword'>return</span>;</td></tr>
<tr class="codeline" data-linenumber="903"><td class="num" id="LN903">903</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="904"><td class="num" id="LN904">904</td><td class="line">        <span class='keyword'>const</span> FormatArg&amp; arg = args[argIndex];</td></tr>
<tr class="codeline" data-linenumber="905"><td class="num" id="LN905">905</td><td class="line">        <span class='comment'>// Format the arg into the stream.</span></td></tr>
<tr class="codeline" data-linenumber="906"><td class="num" id="LN906">906</td><td class="line">        <span class='keyword'>if</span> (!spacePadPositive) {</td></tr>
<tr class="codeline" data-linenumber="907"><td class="num" id="LN907">907</td><td class="line">            arg.format(out, fmt, fmtEnd, ntrunc);</td></tr>
<tr class="codeline" data-linenumber="908"><td class="num" id="LN908">908</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="909"><td class="num" id="LN909">909</td><td class="line">        <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="910"><td class="num" id="LN910">910</td><td class="line">            <span class='comment'>// The following is a special case with no direct correspondence</span></td></tr>
<tr class="codeline" data-linenumber="911"><td class="num" id="LN911">911</td><td class="line">            <span class='comment'>// between stream formatting and the printf() behaviour.  Simulate</span></td></tr>
<tr class="codeline" data-linenumber="912"><td class="num" id="LN912">912</td><td class="line">            <span class='comment'>// it crudely by formatting into a temporary string stream and</span></td></tr>
<tr class="codeline" data-linenumber="913"><td class="num" id="LN913">913</td><td class="line">            <span class='comment'>// munging the resulting string.</span></td></tr>
<tr class="codeline" data-linenumber="914"><td class="num" id="LN914">914</td><td class="line">            std::ostringstream tmpStream;</td></tr>
<tr class="codeline" data-linenumber="915"><td class="num" id="LN915">915</td><td class="line">            tmpStream.copyfmt(out);</td></tr>
<tr class="codeline" data-linenumber="916"><td class="num" id="LN916">916</td><td class="line">            tmpStream.setf(std::ios::showpos);</td></tr>
<tr class="codeline" data-linenumber="917"><td class="num" id="LN917">917</td><td class="line">            arg.format(tmpStream, fmt, fmtEnd, ntrunc);</td></tr>
<tr class="codeline" data-linenumber="918"><td class="num" id="LN918">918</td><td class="line">            std::string result = tmpStream.str(); <span class='comment'>// allocates... yuck.</span></td></tr>
<tr class="codeline" data-linenumber="919"><td class="num" id="LN919">919</td><td class="line">            <span class='keyword'>for</span> (size_t i = 0, iend = result.size(); i &lt; iend; ++i) {</td></tr>
<tr class="codeline" data-linenumber="920"><td class="num" id="LN920">920</td><td class="line">                <span class='keyword'>if</span> (result[i] == '+')</td></tr>
<tr class="codeline" data-linenumber="921"><td class="num" id="LN921">921</td><td class="line">                    result[i] = ' ';</td></tr>
<tr class="codeline" data-linenumber="922"><td class="num" id="LN922">922</td><td class="line">            }</td></tr>
<tr class="codeline" data-linenumber="923"><td class="num" id="LN923">923</td><td class="line">            out &lt;&lt; result;</td></tr>
<tr class="codeline" data-linenumber="924"><td class="num" id="LN924">924</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="925"><td class="num" id="LN925">925</td><td class="line">        <span class='keyword'>if</span> (!positionalMode)</td></tr>
<tr class="codeline" data-linenumber="926"><td class="num" id="LN926">926</td><td class="line">            ++argIndex;</td></tr>
<tr class="codeline" data-linenumber="927"><td class="num" id="LN927">927</td><td class="line">        fmt = fmtEnd;</td></tr>
<tr class="codeline" data-linenumber="928"><td class="num" id="LN928">928</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="929"><td class="num" id="LN929">929</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="930"><td class="num" id="LN930">930</td><td class="line">    <span class='comment'>// Restore stream state</span></td></tr>
<tr class="codeline" data-linenumber="931"><td class="num" id="LN931">931</td><td class="line">    out.width(origWidth);</td></tr>
<tr class="codeline" data-linenumber="932"><td class="num" id="LN932">932</td><td class="line">    out.precision(origPrecision);</td></tr>
<tr class="codeline" data-linenumber="933"><td class="num" id="LN933">933</td><td class="line">    out.flags(origFlags);</td></tr>
<tr class="codeline" data-linenumber="934"><td class="num" id="LN934">934</td><td class="line">    out.fill(origFill);</td></tr>
<tr class="codeline" data-linenumber="935"><td class="num" id="LN935">935</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="936"><td class="num" id="LN936">936</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="937"><td class="num" id="LN937">937</td><td class="line">} <span class='comment'>// namespace detail</span></td></tr>
<tr class="codeline" data-linenumber="938"><td class="num" id="LN938">938</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="939"><td class="num" id="LN939">939</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="940"><td class="num" id="LN940">940</td><td class="line"><span class='comment'>/// List of template arguments format(), held in a type-opaque way.</span></td></tr>
<tr class="codeline" data-linenumber="941"><td class="num" id="LN941">941</td><td class="line"><span class='comment'>///</span></td></tr>
<tr class="codeline" data-linenumber="942"><td class="num" id="LN942">942</td><td class="line"><span class='comment'>/// A const reference to FormatList (typedef'd as FormatListRef) may be</span></td></tr>
<tr class="codeline" data-linenumber="943"><td class="num" id="LN943">943</td><td class="line"><span class='comment'>/// conveniently used to pass arguments to non-template functions: All type</span></td></tr>
<tr class="codeline" data-linenumber="944"><td class="num" id="LN944">944</td><td class="line"><span class='comment'>/// information has been stripped from the arguments, leaving just enough of a</span></td></tr>
<tr class="codeline" data-linenumber="945"><td class="num" id="LN945">945</td><td class="line"><span class='comment'>/// common interface to perform formatting as required.</span></td></tr>
<tr class="codeline" data-linenumber="946"><td class="num" id="LN946">946</td><td class="line"><span class='keyword'>class</span> FormatList</td></tr>
<tr class="codeline" data-linenumber="947"><td class="num" id="LN947">947</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="948"><td class="num" id="LN948">948</td><td class="line">    <span class='keyword'>public</span>:</td></tr>
<tr class="codeline" data-linenumber="949"><td class="num" id="LN949">949</td><td class="line">        FormatList(detail::FormatArg* args, <span class='keyword'>int</span> N)</td></tr>
<tr class="codeline" data-linenumber="950"><td class="num" id="LN950">950</td><td class="line">            : m_args(args), m_N(N) { }</td></tr>
<tr class="codeline" data-linenumber="951"><td class="num" id="LN951">951</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="952"><td class="num" id="LN952">952</td><td class="line">        <span class='keyword'>friend</span> <span class='keyword'>void</span> vformat(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmt,</td></tr>
<tr class="codeline" data-linenumber="953"><td class="num" id="LN953">953</td><td class="line">                            <span class='keyword'>const</span> FormatList&amp; list);</td></tr>
<tr class="codeline" data-linenumber="954"><td class="num" id="LN954">954</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="955"><td class="num" id="LN955">955</td><td class="line">    <span class='keyword'>private</span>:</td></tr>
<tr class="codeline" data-linenumber="956"><td class="num" id="LN956">956</td><td class="line">        <span class='keyword'>const</span> detail::FormatArg* m_args;</td></tr>
<tr class="codeline" data-linenumber="957"><td class="num" id="LN957">957</td><td class="line">        <span class='keyword'>int</span> m_N;</td></tr>
<tr class="codeline" data-linenumber="958"><td class="num" id="LN958">958</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="959"><td class="num" id="LN959">959</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="960"><td class="num" id="LN960">960</td><td class="line"><span class='comment'>/// Reference to type-opaque format list for passing to vformat()</span></td></tr>
<tr class="codeline" data-linenumber="961"><td class="num" id="LN961">961</td><td class="line"><span class='keyword'>typedef</span> <span class='keyword'>const</span> FormatList&amp; FormatListRef;</td></tr>
<tr class="codeline" data-linenumber="962"><td class="num" id="LN962">962</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="963"><td class="num" id="LN963">963</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="964"><td class="num" id="LN964">964</td><td class="line"><span class='keyword'>namespace</span> detail {</td></tr>
<tr class="codeline" data-linenumber="965"><td class="num" id="LN965">965</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="966"><td class="num" id="LN966">966</td><td class="line"><span class='comment'>// Format list subclass with fixed storage to avoid dynamic allocation</span></td></tr>
<tr class="codeline" data-linenumber="967"><td class="num" id="LN967">967</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>int</span> N&gt;</td></tr>
<tr class="codeline" data-linenumber="968"><td class="num" id="LN968">968</td><td class="line"><span class='keyword'>class</span> FormatListN : <span class='keyword'>public</span> FormatList</td></tr>
<tr class="codeline" data-linenumber="969"><td class="num" id="LN969">969</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="970"><td class="num" id="LN970">970</td><td class="line">    <span class='keyword'>public</span>:</td></tr>
<tr class="codeline" data-linenumber="971"><td class="num" id="LN971">971</td><td class="line"><span class='directive'>#ifdef TINYFORMAT_USE_VARIADIC_TEMPLATES</span></td></tr>
<tr class="codeline" data-linenumber="972"><td class="num" id="LN972">972</td><td class="line">        <span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="973"><td class="num" id="LN973">973</td><td class="line">        FormatListN(<span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="974"><td class="num" id="LN974">974</td><td class="line">            : FormatList(&amp;m_formatterStore[0], N),</td></tr>
<tr class="codeline" data-linenumber="975"><td class="num" id="LN975">975</td><td class="line">            m_formatterStore { FormatArg(args)... }</td></tr>
<tr class="codeline" data-linenumber="976"><td class="num" id="LN976">976</td><td class="line">        { <span class='keyword'>static_assert</span>(<span class='keyword'>sizeof</span>...(args) == N, <span class='string_literal'>"Number of args must be N"</span>); }</td></tr>
<tr class="codeline" data-linenumber="977"><td class="num" id="LN977">977</td><td class="line"><span class='directive'>#else // C++98 version</span></td></tr>
<tr class="codeline" data-linenumber="978"><td class="num" id="LN978">978</td><td class="line">        <span class='keyword'>void</span> init(<span class='keyword'>int</span>) {}</td></tr>
<tr class="codeline" data-linenumber="979"><td class="num" id="LN979">979</td><td class="line"><span class='directive'>#       define TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(n)                \</span></td></tr>
<tr class="codeline" data-linenumber="980"><td class="num" id="LN980">980</td><td class="line">                                                                        <span class='directive'>\</span></td></tr>
<tr class="codeline" data-linenumber="981"><td class="num" id="LN981">981</td><td class="line">        <span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                                \</span></td></tr>
<tr class="codeline" data-linenumber="982"><td class="num" id="LN982">982</td><td class="line">        <span class='directive'>FormatListN(<span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)                              \</span></td></tr>
<tr class="codeline" data-linenumber="983"><td class="num" id="LN983">983</td><td class="line">            <span class='directive'>: FormatList(&amp;m_formatterStore[0], n)                       \</span></td></tr>
<tr class="codeline" data-linenumber="984"><td class="num" id="LN984">984</td><td class="line">        <span class='directive'>{ <span class='macro'>TINYFORMAT_ASSERT(n == N)<span class='macro_popup'>(static_cast &lt;bool&gt; (n == N) ? void (0) : __assert_fail<br> ("n == N", "/home/zhh/projects/bitcoin-0.21.1/src/tinyformat.h"<br>, 984, __extension__ __PRETTY_FUNCTION__))</span></span>; init(0, <span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span>); } \</span></td></tr>
<tr class="codeline" data-linenumber="985"><td class="num" id="LN985">985</td><td class="line">                                                                        <span class='directive'>\</span></td></tr>
<tr class="codeline" data-linenumber="986"><td class="num" id="LN986">986</td><td class="line">        <span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                                \</span></td></tr>
<tr class="codeline" data-linenumber="987"><td class="num" id="LN987">987</td><td class="line">        <span class='directive'>void init(int i, <span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)                         \</span></td></tr>
<tr class="codeline" data-linenumber="988"><td class="num" id="LN988">988</td><td class="line">        <span class='directive'>{                                                               \</span></td></tr>
<tr class="codeline" data-linenumber="989"><td class="num" id="LN989">989</td><td class="line">            <span class='directive'>m_formatterStore[i] = FormatArg(v1);                        \</span></td></tr>
<tr class="codeline" data-linenumber="990"><td class="num" id="LN990">990</td><td class="line">            <span class='directive'>init(i+1 <span class='macro'>TINYFORMAT_PASSARGS_TAIL(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_TAIL_n</span></span>);                      \</span></td></tr>
<tr class="codeline" data-linenumber="991"><td class="num" id="LN991">991</td><td class="line">        <span class='directive'>}</span></td></tr>
<tr class="codeline" data-linenumber="992"><td class="num" id="LN992">992</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="993"><td class="num" id="LN993">993</td><td class="line">        <span class='macro'>TINYFORMAT_FOREACH_ARGNUM(TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR)<span class='macro_popup'>TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(1) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(2) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(3) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(4) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(5) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(6) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(7) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(8) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(9) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(10) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(11) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(12) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(13) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(14) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR(15) TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR<br>(16)</span></span></td></tr>
<tr class="codeline" data-linenumber="994"><td class="num" id="LN994">994</td><td class="line"><span class='directive'>#       undef TINYFORMAT_MAKE_FORMATLIST_CONSTRUCTOR</span></td></tr>
<tr class="codeline" data-linenumber="995"><td class="num" id="LN995">995</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="996"><td class="num" id="LN996">996</td><td class="line">        FormatListN(<span class='keyword'>const</span> FormatListN&amp; other)</td></tr>
<tr class="codeline" data-linenumber="997"><td class="num" id="LN997">997</td><td class="line">            : FormatList(&amp;m_formatterStore[0], N)</td></tr>
<tr class="codeline" data-linenumber="998"><td class="num" id="LN998">998</td><td class="line">        { std::copy(&amp;other.m_formatterStore[0], &amp;other.m_formatterStore[N],</td></tr>
<tr class="codeline" data-linenumber="999"><td class="num" id="LN999">999</td><td class="line">                    &amp;m_formatterStore[0]); }</td></tr>
<tr class="codeline" data-linenumber="1000"><td class="num" id="LN1000">1000</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1001"><td class="num" id="LN1001">1001</td><td class="line">    <span class='keyword'>private</span>:</td></tr>
<tr class="codeline" data-linenumber="1002"><td class="num" id="LN1002">1002</td><td class="line">        FormatArg m_formatterStore[N];</td></tr>
<tr class="codeline" data-linenumber="1003"><td class="num" id="LN1003">1003</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1004"><td class="num" id="LN1004">1004</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1005"><td class="num" id="LN1005">1005</td><td class="line"><span class='comment'>// Special 0-arg version - MSVC says zero-sized C array in struct is nonstandard</span></td></tr>
<tr class="codeline" data-linenumber="1006"><td class="num" id="LN1006">1006</td><td class="line"><span class='keyword'>template</span>&lt;&gt; <span class='keyword'>class</span> FormatListN&lt;0&gt; : <span class='keyword'>public</span> FormatList</td></tr>
<tr class="codeline" data-linenumber="1007"><td class="num" id="LN1007">1007</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1008"><td class="num" id="LN1008">1008</td><td class="line">    <span class='keyword'>public</span>: FormatListN() : FormatList(0, 0) {}</td></tr>
<tr class="codeline" data-linenumber="1009"><td class="num" id="LN1009">1009</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1010"><td class="num" id="LN1010">1010</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1011"><td class="num" id="LN1011">1011</td><td class="line">} <span class='comment'>// namespace detail</span></td></tr>
<tr class="codeline" data-linenumber="1012"><td class="num" id="LN1012">1012</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1013"><td class="num" id="LN1013">1013</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1014"><td class="num" id="LN1014">1014</td><td class="line"><span class='comment'>//------------------------------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="1015"><td class="num" id="LN1015">1015</td><td class="line"><span class='comment'>// Primary API functions</span></td></tr>
<tr class="codeline" data-linenumber="1016"><td class="num" id="LN1016">1016</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1017"><td class="num" id="LN1017">1017</td><td class="line"><span class='directive'>#ifdef TINYFORMAT_USE_VARIADIC_TEMPLATES</span></td></tr>
<tr class="codeline" data-linenumber="1018"><td class="num" id="LN1018">1018</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1019"><td class="num" id="LN1019">1019</td><td class="line"><span class='comment'>/// Make type-agnostic format list from list of template arguments.</span></td></tr>
<tr class="codeline" data-linenumber="1020"><td class="num" id="LN1020">1020</td><td class="line"><span class='comment'>///</span></td></tr>
<tr class="codeline" data-linenumber="1021"><td class="num" id="LN1021">1021</td><td class="line"><span class='comment'>/// The exact return type of this function is an implementation detail and</span></td></tr>
<tr class="codeline" data-linenumber="1022"><td class="num" id="LN1022">1022</td><td class="line"><span class='comment'>/// shouldn't be relied upon.  Instead it should be stored as a FormatListRef:</span></td></tr>
<tr class="codeline" data-linenumber="1023"><td class="num" id="LN1023">1023</td><td class="line"><span class='comment'>///</span></td></tr>
<tr class="codeline" data-linenumber="1024"><td class="num" id="LN1024">1024</td><td class="line"><span class='comment'>///   FormatListRef formatList = makeFormatList( /*...*/ );</span></td></tr>
<tr class="codeline" data-linenumber="1025"><td class="num" id="LN1025">1025</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="1026"><td class="num" id="LN1026">1026</td><td class="line">detail::FormatListN&lt;<span class='keyword'>sizeof</span>...(Args)&gt; makeFormatList(<span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="1027"><td class="num" id="LN1027">1027</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1028"><td class="num" id="LN1028">1028</td><td class="line">    <span class='keyword'>return</span> detail::FormatListN&lt;<span class='keyword'>sizeof</span>...(args)&gt;(args...);</td></tr>
<tr class="codeline" data-linenumber="1029"><td class="num" id="LN1029">1029</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1030"><td class="num" id="LN1030">1030</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1031"><td class="num" id="LN1031">1031</td><td class="line"><span class='directive'>#else // C++98 version</span></td></tr>
<tr class="codeline" data-linenumber="1032"><td class="num" id="LN1032">1032</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1033"><td class="num" id="LN1033">1033</td><td class="line"><span class='keyword'>inline</span> detail::FormatListN&lt;0&gt; makeFormatList()</td></tr>
<tr class="codeline" data-linenumber="1034"><td class="num" id="LN1034">1034</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1035"><td class="num" id="LN1035">1035</td><td class="line">    <span class='keyword'>return</span> detail::FormatListN&lt;0&gt;();</td></tr>
<tr class="codeline" data-linenumber="1036"><td class="num" id="LN1036">1036</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1037"><td class="num" id="LN1037">1037</td><td class="line"><span class='directive'>#define TINYFORMAT_MAKE_MAKEFORMATLIST(n)                     \</span></td></tr>
<tr class="codeline" data-linenumber="1038"><td class="num" id="LN1038">1038</td><td class="line"><span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                              \</span></td></tr>
<tr class="codeline" data-linenumber="1039"><td class="num" id="LN1039">1039</td><td class="line"><span class='directive'>detail::FormatListN&lt;n&gt; makeFormatList(<span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)  \</span></td></tr>
<tr class="codeline" data-linenumber="1040"><td class="num" id="LN1040">1040</td><td class="line"><span class='directive'>{                                                             \</span></td></tr>
<tr class="codeline" data-linenumber="1041"><td class="num" id="LN1041">1041</td><td class="line">    <span class='directive'>return detail::FormatListN&lt;n&gt;(<span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span>);    \</span></td></tr>
<tr class="codeline" data-linenumber="1042"><td class="num" id="LN1042">1042</td><td class="line"><span class='directive'>}</span></td></tr>
<tr class="codeline" data-linenumber="1043"><td class="num" id="LN1043">1043</td><td class="line"><span class='macro'>TINYFORMAT_FOREACH_ARGNUM(TINYFORMAT_MAKE_MAKEFORMATLIST)<span class='macro_popup'>TINYFORMAT_MAKE_MAKEFORMATLIST(1) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(2) TINYFORMAT_MAKE_MAKEFORMATLIST(3) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(4) TINYFORMAT_MAKE_MAKEFORMATLIST(5) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(6) TINYFORMAT_MAKE_MAKEFORMATLIST(7) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(8) TINYFORMAT_MAKE_MAKEFORMATLIST(9) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(10) TINYFORMAT_MAKE_MAKEFORMATLIST(11) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(12) TINYFORMAT_MAKE_MAKEFORMATLIST(13) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(14) TINYFORMAT_MAKE_MAKEFORMATLIST(15) TINYFORMAT_MAKE_MAKEFORMATLIST<br>(16)</span></span></td></tr>
<tr class="codeline" data-linenumber="1044"><td class="num" id="LN1044">1044</td><td class="line"><span class='directive'>#undef TINYFORMAT_MAKE_MAKEFORMATLIST</span></td></tr>
<tr class="codeline" data-linenumber="1045"><td class="num" id="LN1045">1045</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1046"><td class="num" id="LN1046">1046</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="1047"><td class="num" id="LN1047">1047</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1048"><td class="num" id="LN1048">1048</td><td class="line"><span class='comment'>/// Format list of arguments to the stream according to the given format string.</span></td></tr>
<tr class="codeline" data-linenumber="1049"><td class="num" id="LN1049">1049</td><td class="line"><span class='comment'>///</span></td></tr>
<tr class="codeline" data-linenumber="1050"><td class="num" id="LN1050">1050</td><td class="line"><span class='comment'>/// The name vformat() is chosen for the semantic similarity to vprintf(): the</span></td></tr>
<tr class="codeline" data-linenumber="1051"><td class="num" id="LN1051">1051</td><td class="line"><span class='comment'>/// list of format arguments is held in a single function argument.</span></td></tr>
<tr class="codeline" data-linenumber="1052"><td class="num" id="LN1052">1052</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> vformat(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmt, FormatListRef list)</td></tr>
<tr class="codeline" data-linenumber="1053"><td class="num" id="LN1053">1053</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1054"><td class="num" id="LN1054">1054</td><td class="line">    <span class="mrange"><span class="mrange">detail::formatImpl(out, fmt, list.m_args, list.m_N)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path18" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">18</div></td><td><div class="PathNav"><a href="#Path17" title="Previous event (17)">&#x2190;</a></div></td><td>Calling 'formatImpl'</td><td><div class="PathNav"><a href="#Path19" title="Next event (19)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path24" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">24</div></td><td><div class="PathNav"><a href="#Path23" title="Previous event (23)">&#x2190;</a></div></td><td>Returning from 'formatImpl'</td><td><div class="PathNav"><a href="#Path25" title="Next event (25)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="1055"><td class="num" id="LN1055">1055</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1056"><td class="num" id="LN1056">1056</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1057"><td class="num" id="LN1057">1057</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1058"><td class="num" id="LN1058">1058</td><td class="line"><span class='directive'>#ifdef TINYFORMAT_USE_VARIADIC_TEMPLATES</span></td></tr>
<tr class="codeline" data-linenumber="1059"><td class="num" id="LN1059">1059</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1060"><td class="num" id="LN1060">1060</td><td class="line"><span class='comment'>/// Format list of arguments to the stream according to given format string.</span></td></tr>
<tr class="codeline" data-linenumber="1061"><td class="num" id="LN1061">1061</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="1062"><td class="num" id="LN1062">1062</td><td class="line"><span class='keyword'>void</span> format(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmt, <span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="1063"><td class="num" id="LN1063">1063</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1064"><td class="num" id="LN1064">1064</td><td class="line">    <span class="mrange"><span class="mrange">vformat(out, fmt, makeFormatList(args...))</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path17" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">17</div></td><td><div class="PathNav"><a href="#Path16" title="Previous event (16)">&#x2190;</a></div></td><td>Calling 'vformat'</td><td><div class="PathNav"><a href="#Path18" title="Next event (18)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path25" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">25</div></td><td><div class="PathNav"><a href="#Path24" title="Previous event (24)">&#x2190;</a></div></td><td>Returning from 'vformat'</td><td><div class="PathNav"><a href="#Path26" title="Next event (26)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="1065"><td class="num" id="LN1065">1065</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1066"><td class="num" id="LN1066">1066</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1067"><td class="num" id="LN1067">1067</td><td class="line"><span class='comment'>/// Format list of arguments according to the given format string and return</span></td></tr>
<tr class="codeline" data-linenumber="1068"><td class="num" id="LN1068">1068</td><td class="line"><span class='comment'>/// the result as a string.</span></td></tr>
<tr class="codeline" data-linenumber="1069"><td class="num" id="LN1069">1069</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="1070"><td class="num" id="LN1070">1070</td><td class="line">std::string format(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt, <span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="1071"><td class="num" id="LN1071">1071</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1072"><td class="num" id="LN1072">1072</td><td class="line">    std::ostringstream oss;</td></tr>
<tr class="codeline" data-linenumber="1073"><td class="num" id="LN1073">1073</td><td class="line">    <span class="mrange"><span class="mrange">format(oss, fmt, args...)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path16" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">16</div></td><td><div class="PathNav"><a href="#Path15" title="Previous event (15)">&#x2190;</a></div></td><td>Calling 'format&lt;unsigned char&gt;'</td><td><div class="PathNav"><a href="#Path17" title="Next event (17)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path26" class="msg msgEvent" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">26</div></td><td><div class="PathNav"><a href="#Path25" title="Previous event (25)">&#x2190;</a></div></td><td>Returning from 'format&lt;unsigned char&gt;'</td><td><div class="PathNav"><a href="#Path27" title="Next event (27)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="1074"><td class="num" id="LN1074">1074</td><td class="line">    <span class='keyword'>return</span> oss.str();</td></tr>
<tr class="codeline" data-linenumber="1075"><td class="num" id="LN1075">1075</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1076"><td class="num" id="LN1076">1076</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1077"><td class="num" id="LN1077">1077</td><td class="line"><span class='comment'>/// Format list of arguments to std::cout, according to the given format string</span></td></tr>
<tr class="codeline" data-linenumber="1078"><td class="num" id="LN1078">1078</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="1079"><td class="num" id="LN1079">1079</td><td class="line"><span class='keyword'>void</span> printf(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt, <span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="1080"><td class="num" id="LN1080">1080</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1081"><td class="num" id="LN1081">1081</td><td class="line">    format(std::cout, fmt, args...);</td></tr>
<tr class="codeline" data-linenumber="1082"><td class="num" id="LN1082">1082</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1083"><td class="num" id="LN1083">1083</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1084"><td class="num" id="LN1084">1084</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="1085"><td class="num" id="LN1085">1085</td><td class="line"><span class='keyword'>void</span> printfln(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt, <span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="1086"><td class="num" id="LN1086">1086</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1087"><td class="num" id="LN1087">1087</td><td class="line">    format(std::cout, fmt, args...);</td></tr>
<tr class="codeline" data-linenumber="1088"><td class="num" id="LN1088">1088</td><td class="line">    std::cout &lt;&lt; '\n';</td></tr>
<tr class="codeline" data-linenumber="1089"><td class="num" id="LN1089">1089</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1090"><td class="num" id="LN1090">1090</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1091"><td class="num" id="LN1091">1091</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1092"><td class="num" id="LN1092">1092</td><td class="line"><span class='directive'>#else // C++98 version</span></td></tr>
<tr class="codeline" data-linenumber="1093"><td class="num" id="LN1093">1093</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1094"><td class="num" id="LN1094">1094</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> format(std::ostream&amp; out, <span class='keyword'>const</span> <span class='keyword'>char</span>* fmt)</td></tr>
<tr class="codeline" data-linenumber="1095"><td class="num" id="LN1095">1095</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1096"><td class="num" id="LN1096">1096</td><td class="line">    vformat(out, fmt, makeFormatList());</td></tr>
<tr class="codeline" data-linenumber="1097"><td class="num" id="LN1097">1097</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1098"><td class="num" id="LN1098">1098</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1099"><td class="num" id="LN1099">1099</td><td class="line"><span class='keyword'>inline</span> std::string format(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt)</td></tr>
<tr class="codeline" data-linenumber="1100"><td class="num" id="LN1100">1100</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1101"><td class="num" id="LN1101">1101</td><td class="line">    std::ostringstream oss;</td></tr>
<tr class="codeline" data-linenumber="1102"><td class="num" id="LN1102">1102</td><td class="line">    format(oss, fmt);</td></tr>
<tr class="codeline" data-linenumber="1103"><td class="num" id="LN1103">1103</td><td class="line">    <span class='keyword'>return</span> oss.str();</td></tr>
<tr class="codeline" data-linenumber="1104"><td class="num" id="LN1104">1104</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1105"><td class="num" id="LN1105">1105</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1106"><td class="num" id="LN1106">1106</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> printf(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt)</td></tr>
<tr class="codeline" data-linenumber="1107"><td class="num" id="LN1107">1107</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1108"><td class="num" id="LN1108">1108</td><td class="line">    format(std::cout, fmt);</td></tr>
<tr class="codeline" data-linenumber="1109"><td class="num" id="LN1109">1109</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1110"><td class="num" id="LN1110">1110</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1111"><td class="num" id="LN1111">1111</td><td class="line"><span class='keyword'>inline</span> <span class='keyword'>void</span> printfln(<span class='keyword'>const</span> <span class='keyword'>char</span>* fmt)</td></tr>
<tr class="codeline" data-linenumber="1112"><td class="num" id="LN1112">1112</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1113"><td class="num" id="LN1113">1113</td><td class="line">    format(std::cout, fmt);</td></tr>
<tr class="codeline" data-linenumber="1114"><td class="num" id="LN1114">1114</td><td class="line">    std::cout &lt;&lt; '\n';</td></tr>
<tr class="codeline" data-linenumber="1115"><td class="num" id="LN1115">1115</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1116"><td class="num" id="LN1116">1116</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1117"><td class="num" id="LN1117">1117</td><td class="line"><span class='directive'>#define TINYFORMAT_MAKE_FORMAT_FUNCS(n)                                   \</span></td></tr>
<tr class="codeline" data-linenumber="1118"><td class="num" id="LN1118">1118</td><td class="line">                                                                          <span class='directive'>\</span></td></tr>
<tr class="codeline" data-linenumber="1119"><td class="num" id="LN1119">1119</td><td class="line"><span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                                          \</span></td></tr>
<tr class="codeline" data-linenumber="1120"><td class="num" id="LN1120">1120</td><td class="line"><span class='directive'>void format(std::ostream&amp; out, const char* fmt, <span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)    \</span></td></tr>
<tr class="codeline" data-linenumber="1121"><td class="num" id="LN1121">1121</td><td class="line"><span class='directive'>{                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1122"><td class="num" id="LN1122">1122</td><td class="line">    <span class='directive'>vformat(out, fmt, makeFormatList(<span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span>));            \</span></td></tr>
<tr class="codeline" data-linenumber="1123"><td class="num" id="LN1123">1123</td><td class="line"><span class='directive'>}                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1124"><td class="num" id="LN1124">1124</td><td class="line">                                                                          <span class='directive'>\</span></td></tr>
<tr class="codeline" data-linenumber="1125"><td class="num" id="LN1125">1125</td><td class="line"><span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                                          \</span></td></tr>
<tr class="codeline" data-linenumber="1126"><td class="num" id="LN1126">1126</td><td class="line"><span class='directive'>std::string format(const char* fmt, <span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)                \</span></td></tr>
<tr class="codeline" data-linenumber="1127"><td class="num" id="LN1127">1127</td><td class="line"><span class='directive'>{                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1128"><td class="num" id="LN1128">1128</td><td class="line">    <span class='directive'>std::ostringstream oss;                                               \</span></td></tr>
<tr class="codeline" data-linenumber="1129"><td class="num" id="LN1129">1129</td><td class="line">    <span class='directive'>format(oss, fmt, <span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span>);                             \</span></td></tr>
<tr class="codeline" data-linenumber="1130"><td class="num" id="LN1130">1130</td><td class="line">    <span class='directive'>return oss.str();                                                     \</span></td></tr>
<tr class="codeline" data-linenumber="1131"><td class="num" id="LN1131">1131</td><td class="line"><span class='directive'>}                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1132"><td class="num" id="LN1132">1132</td><td class="line">                                                                          <span class='directive'>\</span></td></tr>
<tr class="codeline" data-linenumber="1133"><td class="num" id="LN1133">1133</td><td class="line"><span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                                          \</span></td></tr>
<tr class="codeline" data-linenumber="1134"><td class="num" id="LN1134">1134</td><td class="line"><span class='directive'>void printf(const char* fmt, <span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)                       \</span></td></tr>
<tr class="codeline" data-linenumber="1135"><td class="num" id="LN1135">1135</td><td class="line"><span class='directive'>{                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1136"><td class="num" id="LN1136">1136</td><td class="line">    <span class='directive'>format(std::cout, fmt, <span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span>);                       \</span></td></tr>
<tr class="codeline" data-linenumber="1137"><td class="num" id="LN1137">1137</td><td class="line"><span class='directive'>}                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1138"><td class="num" id="LN1138">1138</td><td class="line">                                                                          <span class='directive'>\</span></td></tr>
<tr class="codeline" data-linenumber="1139"><td class="num" id="LN1139">1139</td><td class="line"><span class='directive'>template&lt;<span class='macro'>TINYFORMAT_ARGTYPES(n)<span class='macro_popup'>TINYFORMAT_ARGTYPES_n</span></span>&gt;                                          \</span></td></tr>
<tr class="codeline" data-linenumber="1140"><td class="num" id="LN1140">1140</td><td class="line"><span class='directive'>void printfln(const char* fmt, <span class='macro'>TINYFORMAT_VARARGS(n)<span class='macro_popup'>TINYFORMAT_VARARGS_n</span></span>)                     \</span></td></tr>
<tr class="codeline" data-linenumber="1141"><td class="num" id="LN1141">1141</td><td class="line"><span class='directive'>{                                                                         \</span></td></tr>
<tr class="codeline" data-linenumber="1142"><td class="num" id="LN1142">1142</td><td class="line">    <span class='directive'>format(std::cout, fmt, <span class='macro'>TINYFORMAT_PASSARGS(n)<span class='macro_popup'>TINYFORMAT_PASSARGS_n</span></span>);                       \</span></td></tr>
<tr class="codeline" data-linenumber="1143"><td class="num" id="LN1143">1143</td><td class="line">    <span class='directive'>std::cout &lt;&lt; '\n';                                                    \</span></td></tr>
<tr class="codeline" data-linenumber="1144"><td class="num" id="LN1144">1144</td><td class="line"><span class='directive'>}</span></td></tr>
<tr class="codeline" data-linenumber="1145"><td class="num" id="LN1145">1145</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1146"><td class="num" id="LN1146">1146</td><td class="line"><span class='macro'>TINYFORMAT_FOREACH_ARGNUM(TINYFORMAT_MAKE_FORMAT_FUNCS)<span class='macro_popup'>TINYFORMAT_MAKE_FORMAT_FUNCS(1) TINYFORMAT_MAKE_FORMAT_FUNCS(<br>2) TINYFORMAT_MAKE_FORMAT_FUNCS(3) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(4) TINYFORMAT_MAKE_FORMAT_FUNCS(5) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(6) TINYFORMAT_MAKE_FORMAT_FUNCS(7) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(8) TINYFORMAT_MAKE_FORMAT_FUNCS(9) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(10) TINYFORMAT_MAKE_FORMAT_FUNCS(11) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(12) TINYFORMAT_MAKE_FORMAT_FUNCS(13) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(14) TINYFORMAT_MAKE_FORMAT_FUNCS(15) TINYFORMAT_MAKE_FORMAT_FUNCS<br>(16)</span></span></td></tr>
<tr class="codeline" data-linenumber="1147"><td class="num" id="LN1147">1147</td><td class="line"><span class='directive'>#undef TINYFORMAT_MAKE_FORMAT_FUNCS</span></td></tr>
<tr class="codeline" data-linenumber="1148"><td class="num" id="LN1148">1148</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1149"><td class="num" id="LN1149">1149</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="1150"><td class="num" id="LN1150">1150</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1151"><td class="num" id="LN1151">1151</td><td class="line"><span class='comment'>// Added for Bitcoin Core</span></td></tr>
<tr class="codeline" data-linenumber="1152"><td class="num" id="LN1152">1152</td><td class="line"><span class='keyword'>template</span>&lt;<span class='keyword'>typename</span>... Args&gt;</td></tr>
<tr class="codeline" data-linenumber="1153"><td class="num" id="LN1153">1153</td><td class="line">std::string format(<span class='keyword'>const</span> std::string &amp;fmt, <span class='keyword'>const</span> Args&amp;... args)</td></tr>
<tr class="codeline" data-linenumber="1154"><td class="num" id="LN1154">1154</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1155"><td class="num" id="LN1155">1155</td><td class="line">    std::ostringstream oss;</td></tr>
<tr class="codeline" data-linenumber="1156"><td class="num" id="LN1156">1156</td><td class="line">    format(oss, fmt.c_str(), args...);</td></tr>
<tr class="codeline" data-linenumber="1157"><td class="num" id="LN1157">1157</td><td class="line">    <span class='keyword'>return</span> oss.str();</td></tr>
<tr class="codeline" data-linenumber="1158"><td class="num" id="LN1158">1158</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1159"><td class="num" id="LN1159">1159</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1160"><td class="num" id="LN1160">1160</td><td class="line">} <span class='comment'>// namespace tinyformat</span></td></tr>
<tr class="codeline" data-linenumber="1161"><td class="num" id="LN1161">1161</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1162"><td class="num" id="LN1162">1162</td><td class="line"><span class='comment'>// Added for Bitcoin Core:</span></td></tr>
<tr class="codeline" data-linenumber="1163"><td class="num" id="LN1163">1163</td><td class="line"><span class='comment'>/** Format arguments and return the string or write to given std::ostream (see tinyformat::format doc for details) */</span></td></tr>
<tr class="codeline" data-linenumber="1164"><td class="num" id="LN1164">1164</td><td class="line"><span class='directive'>#define <span class='macro'>strprintf<span class='macro_popup'>tfm::format</span></span> tfm::format</span></td></tr>
<tr class="codeline" data-linenumber="1165"><td class="num" id="LN1165">1165</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1166"><td class="num" id="LN1166">1166</td><td class="line"><span class='directive'>#endif // TINYFORMAT_H_INCLUDED</span></td></tr>
</table></body></html>
